!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){"use strict";function n(e,t,r){const n=e.createShader(r);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error("Shader compile failed: "+e.getShaderInfoLog(n));return n}Object.defineProperty(t,"__esModule",{value:!0}),t.Shader=t.decodeRenderId=t.encodeRenderId=t.extractAttributesFromShader=t.createArrayBuffer=t.createProgram=t.compileShader=void 0,t.compileShader=n,t.createProgram=function(e,t,r,i){const o=n(e,t,e.VERTEX_SHADER),a=n(e,r,e.FRAGMENT_SHADER),s=e.createProgram();if(i.forEach(t=>{e.bindAttribLocation(s,t.location,t.name)}),e.attachShader(s,o),e.attachShader(s,a),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw new Error("Could not link shaders: "+e.getProgramInfoLog(s));return s},t.createArrayBuffer=function(e,t){const r=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,t,e.DYNAMIC_DRAW),r},t.extractAttributesFromShader=function(e){const t=e.inputs,r=new Map;return Object.entries(t).forEach(([e,t],n)=>{let i=1;"vec"===t.slice(0,3)&&(i=Number(t.slice(-1)));let o=!1;"inVertexPos"===e&&(o=!0),r.set(e,{name:e,size:i,location:n,isBuildIn:o,extractAttributeValueFrom:()=>[]})}),r},t.encodeRenderId=function(e){return{r:(255&e)/255,g:(e>>8&255)/255,b:(e>>16&255)/255,a:(e>>24&255)/255}},t.decodeRenderId=function(e){return e[0]|e[1]<<8|e[2]<<16|e[3]<<24};class i{constructor(){this.inputs={},this.outputs={},this.uniforms={},this.methods=[[]],this.main=[],this.header="#version 300 es\nprecision highp float;\n"}copy(){const e=new i;return e.inputs={...this.inputs},e.outputs={...this.outputs},e.uniforms={...this.uniforms},e.main=this.main.map(e=>e),e.methods=this.methods.map(e=>e.map(e=>e)),e}connect(){const e=[{prefix:"in",variables:this.inputs},{prefix:"out",variables:this.outputs},{prefix:"uniform",variables:this.uniforms}].map(e=>Object.entries(e.variables).map(([t,r])=>`${e.prefix} ${r} ${t};\n`).join("")).join("");return this.header+e+this.methods.map(e=>e.join("\n")).join("\n")+"\n"+this.main.join("\n")}}t.Shader=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),i=r(3);t.default=class{constructor(e,t,r){this.$_style={},this.$_mousedownCallbackSet=new Set,this.$_mouseupCallbackSet=new Set,this.$_mouseoverCallbackSet=new Set,this.$_mouseoutCallbackSet=new Set,this.$_mousemoveCallbackSet=new Set,this.$_clickCallbackSet=new Set,this.$_attributes={},this.$_core=e,this.type=r;const n=this.$_core.$_configs;this.$_style=JSON.parse(JSON.stringify(n[this.type.toLowerCase()].style)),"style"in t&&Object.entries(t.style).forEach(([e,t])=>{const r=t,n=e;r!==Object(r)?this.$_style[n]=r:this.$_style[n]={...this.$_style[n],...r}});const i=this.$_core.$_renderer[this.type.toLowerCase()+"Manager"];this.$_changeRenderAttribute=i.changeAttribute.bind(i),Object.keys(this.$_style).forEach(e=>{this[e]=this.generateElementStyleGetterSetter(e)})}on(e,t){var r;if("drag"!==e.slice(0,4)||"drag"===e.slice(0,4)&&"Node"===this.type){const n=`$_${e}CallbackSet`;null===(r=this[n])||void 0===r||r.add(t||i.EMPTY_FUNCTION),this[n]&&this.$_core.$_interactionManager.increaseMouseEventCallbackCountBy(1)}}off(e,t){var r;if("drag"!==e.slice(0,4)||"drag"===e.slice(0,4)&&"Node"===this.type){const n=`$_${e}CallbackSet`;null===(r=this[n])||void 0===r||r.delete(t||i.EMPTY_FUNCTION),this[n]&&this.$_core.$_interactionManager.decreaseMouseEventCallbackCountBy(1)}}attr(e,t){if(2===arguments.length)this.$_attributes[e]=t;else{if(1===arguments.length)return this.$_attributes[e];if(0===arguments.length)return JSON.parse(JSON.stringify(this.$_attributes))}}generateElementStyleGetterSetter(e){return t=>(void 0!==t&&(t===Object(t)?this.$_style[e]=n.override(this.$_style[e],t):this.$_style[e]=t,this.$_changeRenderAttribute(this,e)),this.$_style[e])}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.override=t.transformGraphPosition=void 0,t.transformGraphPosition=function(e,t,r,n){const i=JSON.parse(JSON.stringify(e)),o=i.nodes.map(e=>e.x),a=i.nodes.map(e=>e.y),s=Math.min(...o),u=Math.max(...o),l=Math.min(...a),c=Math.max(...a),p=(s+u)/2,h=(l+c)/2;return i.nodes.forEach(e=>{e.x=(e.x-p)/(u-s)*t+r,e.y=(e.y-h)/(c-l)*t+n}),i},t.override=function e(t,r){if(t!==Object(t))return r!==Object(r)?r:JSON.parse(JSON.stringify(r));const n=JSON.parse(JSON.stringify(t));for(const t in r)t in n&&r[t]===Object(r[t])?n[t]=e(n[t],r[t]):n[t]=r[t];return n}},function(e,t,r){"use strict";r.r(t),r.d(t,"EMPTY_FUNCTION",(function(){return n}));const n=()=>{}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderElementManager=void 0;const n=r(0);t.RenderElementManager=class{constructor(e,t,r,i){this.count=0,this.elementToRenderId=new Map;const{limit:o,width:a,height:s,instanceVerteces:u}=t;this.gl=e,this.capacity=o,this.width=a,this.height=s,this.pixelRatio=window.devicePixelRatio||1,this.attributes=n.extractAttributesFromShader(r.vertex),this.program=n.createProgram(this.gl,r.vertex.connect(),r.fragment.connect(),this.attributes),this.idAttributes=n.extractAttributesFromShader(r.idVertex),this.idProgram=n.createProgram(this.gl,r.idVertex.connect(),r.idFragment.connect(),this.idAttributes),this.idTexture=i,this.attributes.forEach(e=>{e.isBuildIn?e.array=new Float32Array(u):e.array=new Float32Array(e.size*this.capacity),e.buffer=n.createArrayBuffer(this.gl,e.array)}),this.idAttributes.forEach((e,t)=>{"in_id"===t?(e.isBuildIn||(e.array=new Float32Array(e.size*this.capacity)),e.buffer=n.createArrayBuffer(this.gl,e.array)):this.idAttributes.set(t,this.attributes.get(t))}),this.gl.useProgram(this.program);const l=this.gl.getUniformLocation(this.program,"projection"),c=this.gl.getUniformLocation(this.program,"scale"),p=this.gl.getUniformLocation(this.program,"translate"),h=this.gl.getUniformLocation(this.program,"viewport"),d=this.gl.getUniformLocation(this.program,"pixelRatio"),m=new Float32Array([2/this.width,0,0,0,-2/this.height,0,-1,1,1]);null!==l&&this.gl.uniformMatrix3fv(l,!1,m);const f=new Float32Array([1,1]);null!==c&&this.gl.uniform2fv(c,f);const g=new Float32Array([0,0]);null!==p&&this.gl.uniform2fv(p,g);const v=new Float32Array([this.width,this.height]);null!==h&&this.gl.uniform2fv(h,v),null!==d&&this.gl.uniform1f(d,this.pixelRatio),this.gl.useProgram(this.idProgram);const y=this.gl.getUniformLocation(this.idProgram,"projection"),_=this.gl.getUniformLocation(this.idProgram,"scale"),x=this.gl.getUniformLocation(this.idProgram,"translate"),b=this.gl.getUniformLocation(this.idProgram,"viewport"),C=this.gl.getUniformLocation(this.idProgram,"pixelRatio");null!==y&&this.gl.uniformMatrix3fv(y,!1,m),null!==_&&this.gl.uniform2fv(_,f),null!==x&&this.gl.uniform2fv(x,g),null!==b&&this.gl.uniform2fv(b,v),null!==C&&this.gl.uniform1f(C,this.pixelRatio)}setRenderIdOf(e,t){this.renderIdToElement[t]=e,this.elementToRenderId.set(e,t)}getRenderIdOf(e){return this.elementToRenderId.get(e)}getElementByRenderId(e){return this.renderIdToElement[e]}setTransform(e){this.gl.useProgram(this.program);const t=this.gl.getUniformLocation(this.program,"scale"),r=this.gl.getUniformLocation(this.program,"translate"),n=new Float32Array([e.k,e.k]);this.gl.uniform2fv(t,n);const i=new Float32Array([e.x,e.y]);this.gl.uniform2fv(r,i),this.gl.useProgram(this.idProgram);const o=this.gl.getUniformLocation(this.idProgram,"scale"),a=this.gl.getUniformLocation(this.idProgram,"translate");this.gl.uniform2fv(o,n),this.gl.uniform2fv(a,i)}draw(){if(this.count>0){this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.useProgram(this.program),this.attributes.forEach(e=>{this.gl.enableVertexAttribArray(e.location)}),this.attributes.forEach((e,t)=>{this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.buffer),this.gl.vertexAttribPointer(e.location,e.size,this.gl.FLOAT,!1,e.size*e.array.BYTES_PER_ELEMENT,0),e.isBuildIn||this.gl.vertexAttribDivisor(e.location,1)}),this.gl.drawArraysInstanced(this.gl.TRIANGLE_STRIP,0,4,this.count),this.gl.blendFunc(this.gl.ONE,this.gl.ZERO),this.gl.useProgram(this.idProgram),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.idTexture),this.idAttributes.forEach(e=>{this.gl.enableVertexAttribArray(e.location)});const e=this.idAttributes.get("in_id");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.buffer),this.gl.vertexAttribPointer(e.location,e.size,this.gl.FLOAT,!1,e.size*e.array.BYTES_PER_ELEMENT,0),this.gl.vertexAttribDivisor(e.location,1),this.gl.drawArraysInstanced(this.gl.TRIANGLE_STRIP,0,4,this.count),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}}addData(e){e.forEach((e,t)=>{const r=this.count+t;this.attributes.forEach(t=>{if(!t.isBuildIn){const n=function(e,t){return"Link"===e.type?i[t](e):o[t](e)}(e,t.name);t.array.set(n,t.size*r)}});const a="Node"===e.type?0:1,s=2*r+a,u=n.encodeRenderId(s);this.idAttributes.get("in_id").array.set([u.r,u.g,u.b,u.a],4*r),this.setRenderIdOf(e,s)}),this.attributes.forEach(t=>{t.isBuildIn||(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.buffer),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,t.size*this.count*t.array.BYTES_PER_ELEMENT,t.array,t.size*this.count,t.size*e.length))});const t=this.idAttributes.get("in_id");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.buffer),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,t.size*this.count*t.array.BYTES_PER_ELEMENT,t.array,t.size*this.count,t.size*e.length),this.count+=e.length}changeAttribute(e,t){const r=this.getRenderIdOf(e),n=Math.floor(r/2),i=this.getAttributeByElement(e,t),o=i.name,a=i.value,s=this.attributes.get(o);void 0===s&&console.error(`Attribute: ${t} is not supported in a ${e.type} instance.`),s.array.set(a,s.size*n),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.buffer),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,s.size*n*s.array.BYTES_PER_ELEMENT,s.array,s.size*n,s.size)}clearData(){this.count=0}getAttributeByElement(e,t){let r;if("Link"===e.type){const t=e,n=t.$_style;r={source:{name:"in_source",value:[t.$_source.$_position.x,t.$_source.$_position.y]},target:{name:"in_target",value:[t.$_target.$_position.x,t.$_target.$_position.y]},shape:{name:"in_shape",value:["dash-line"===n.shape?2:"curve"===n.shape?1:0]},strokeWidth:{name:"in_strokeWidth",value:[n.strokeWidth]},strokeColor:{name:"in_strokeColor",value:[n.strokeColor.r,n.strokeColor.g,n.strokeColor.b,n.strokeColor.a]},curveness:{name:"in_curveness",value:[n.curveness]},dashInterval:{name:"in_dashInterval",value:[n.dashInterval]}}}else{const t=e,n=t.$_style;r={position:{name:"in_position",value:[t.$_position.x,t.$_position.y]},shape:{name:"in_shape",value:["rect"===n.shape?1:"triangle"===n.shape?2:"cross"===n.shape?3:0]},offset:{name:"in_offset",value:[n.offset.x,n.offset.y]},fill:{name:"in_fill",value:[n.fill.r,n.fill.g,n.fill.b,n.fill.a]},strokeWidth:{name:"in_strokeWidth",value:[n.strokeWidth]},strokeColor:{name:"in_strokeColor",value:[n.strokeColor.r,n.strokeColor.g,n.strokeColor.b,n.strokeColor.a]},rotate:{name:"in_rotate",value:[n.rotate]},r:{name:"in_r",value:[n.r]},width:{name:"in_size",value:[n.width,n.height]},height:{name:"in_size",value:[n.width,n.height]},vertexAlpha:{name:"in_vertexAlpha",value:[n.vertexAlpha.x,n.vertexAlpha.y]},vertexBeta:{name:"in_vertexBeta",value:[n.vertexBeta.x,n.vertexBeta.y]},vertexGamma:{name:"in_vertexGamma",value:[n.vertexGamma.x,n.vertexGamma.y]},innerWidth:{name:"in_innerSize",value:[n.innerWidth,n.innerHeight]},innerHeight:{name:"in_innerSize",value:[n.innerWidth,n.innerHeight]}}}if(t in r)return r[t];const n={};return Object.entries(r).forEach(([e,t])=>{const r=t,i=e;n[r.name]={name:i,value:r.value}}),n[t]}};const i={in_source:e=>[e.$_source.$_position.x,e.$_source.$_position.y],in_target:e=>[e.$_target.$_position.x,e.$_target.$_position.y],in_shape:e=>["dash-line"===e.$_style.shape?2:"curve"===e.$_style.shape?1:0],in_strokeWidth:e=>[e.$_style.strokeWidth],in_strokeColor:e=>[e.$_style.strokeColor.r,e.$_style.strokeColor.g,e.$_style.strokeColor.b,e.$_style.strokeColor.a],in_curveness:e=>[e.$_style.curveness],in_dashInterval:e=>[e.$_style.dashInterval]},o={in_position:e=>[e.$_position.x,e.$_position.y],in_shape:e=>["rect"===e.$_style.shape?1:"triangle"===e.$_style.shape?2:"cross"===e.$_style.shape?3:0],in_offset:e=>[e.$_style.offset.x,e.$_style.offset.y],in_fill:e=>[e.$_style.fill.r,e.$_style.fill.g,e.$_style.fill.b,e.$_style.fill.a],in_strokeWidth:e=>[e.$_style.strokeWidth],in_strokeColor:e=>[e.$_style.strokeColor.r,e.$_style.strokeColor.g,e.$_style.strokeColor.b,e.$_style.strokeColor.a],in_rotate:e=>[e.$_style.rotate],in_r:e=>[e.$_style.r],in_size:e=>[e.$_style.width,e.$_style.height],in_vertexAlpha:e=>[e.$_style.vertexAlpha.x,e.$_style.vertexAlpha.y],in_vertexBeta:e=>[e.$_style.vertexBeta.x,e.$_style.vertexBeta.y],in_vertexGamma:e=>[e.$_style.vertexGamma.x,e.$_style.vertexGamma.y],in_innerSize:e=>[e.$_style.innerWidth,e.$_style.innerHeight]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6),i=r(7),o=r(9),a=r(10),s=r(11),u=r(14),l=r(19),c=r(2),p=r(3),h=r(20),d=r(21);class m{constructor(e){if(this.$_id2node=new Map,this.$_ends2link=new n.default,this.$_sourceId2links=new Map,this.$_targetId2links=new Map,this.$_configs=JSON.parse(JSON.stringify(a)),this.$_transform={x:0,y:0,k:1},this.$_lazyUpdate=!1,this.$_data={nodes:[],links:[]},!("container"in e)||"DIV"!==e.container.tagName)throw Error("Container should be specified as a div element!");this.$_container=e.container,this.$_configs=c.override(this.$_configs,e),delete this.$_configs.container;const t=document.createElement("canvas"),r=window.devicePixelRatio||1;t.style.width=this.$_configs.width+"px",t.style.height=this.$_configs.height+"px",t.setAttribute("width",String(this.$_configs.width*r)),t.setAttribute("height",String(this.$_configs.height*r)),this.$_container.appendChild(t),this.$_canvas=t,this.$_renderer=new u.Renderer({canvas:t,width:this.$_configs.width,height:this.$_configs.height,backgroundColor:this.$_configs.backgroundColor,nodeLimit:this.$_configs.nodeLimit,linkLimit:this.$_configs.linkLimit,getAllNodes:this.nodes.bind(this),getAllLinks:this.links.bind(this)}),console.log("lyhlyh11"),h.logJs();const i=document.getElementById("main-canvas"),o=d.platform("webgl-2d",i,this.$_configs.width,this.$_configs.height);this.$_platform=o,this.$_canvas2=i,this.$_interactionManager=new l.InteractionManager(this)}backgroundColor(e){return e&&(this.$_configs.backgroundColor=e,this.$_renderer.setBackgroundColor(e)),this.$_configs.backgroundColor}data(e){for(var t=[],r=0;r<96;r++)for(var i=0;i<50;i++){var o=r/95*2-1,a=i/49*2-1,s=Math.sqrt(o*o+a*a),u=s*Math.exp(-s*s*5),l=a/s*u,c=-o/s*u;t.push({x:o+2*l,y:a+2*c})}this.$_data_star=t;let p=new d.mark.circle(16);console.log("init mark");var h=d.mark.create(p,this.$_platform),m=d.mark.create(p,this.$_platform),f=d.scale.linear().domain([-1,1]).range([10,this.$_configs.width-10]),g=d.scale.linear().domain([-1,1]).range([10,this.$_configs.height-10]);if(h.attr("center",d.scale.Vector2(f(e=>e.x),g(e=>e.y))),h.attr("radius",2),h.attr("color",[0,0,0,.4]),m.attr("center",d.scale.Vector2(f(e=>e.x),g(e=>e.y))),m.attr("radius",4),m.attr("color",[255,0,0,1]),h.data(t),this.$_circles=h,this.$_circles2=m,void 0===e)return this.$_data;this.$_data={...this.$_data,...e},this.$_id2node=new Map,this.$_ends2link=new n.default,this.$_sourceId2links=new Map,this.$_targetId2links=new Map,this.$_renderer.clearData(),this.addNodes(this.$_data.nodes),this.addLinks(this.$_data.links)}addNode(e){return this.addNodes([e])[0]}addLink(e){return this.addLinks([e])[0]}addNodes(e){const t=e.map(e=>{e.id=e.id.toString();return new i.default(this,e)});return this.$_renderer.addNodes(t),t}addLinks(e){const t=new Array(e.length);for(let r=0;r<e.length;r++){const n=e[r];n.source=n.source.toString(),n.target=n.target.toString();const i=new o.default(this,n);t[r]=i}return this.$_renderer.addLinks(t),t}getNodeById(e){return this.$_id2node.get(e)}getLinkByEnds(e,t){return this.$_ends2link.get([e,t])}nodes(){return[...this.$_id2node.values()]}links(){return[...this.$_ends2link.values()]}wipe(){this.$_data=void 0,this.$_id2node=new Map,this.$_ends2link=new n.default,this.$_sourceId2links=new Map,this.$_targetId2links=new Map,this.$_renderer.clearData()}dispose(){this.wipe(),this.$_renderer.dispose(),this.$_canvas.remove()}loadDataset(e){return e in s?s[e]:(console.error("NetV does not have build-in dataset: "+e),{nodes:[],links:[]})}getElementByPosition(e){const t=this.$_renderer.getIdByPosition(e);if(t){if("string"==typeof t){return{type:"node",element:this.getNodeById(t)}}if(Array.isArray(t)){return{type:"link",element:this.getLinkByEnds(t[0],t[1])}}}}draw(){this.$_circles.render(),this.$_platform.endPicking(),this.$_canvas2.onmousemove=e=>{let t=this.$_canvas2.getBoundingClientRect();var r=e.clientX-t.left,n=e.clientY-t.top,i=this.$_platform.getPickingPixel(2*r,2*n);i&&(this.$_platform.clear(),this.$_circles.render(),this.$_circles2.attr("color",[1,0,0,1]),this.$_circles2.data([this.$_data_star[i[1]]]),this.$_circles2.render(),console.log("log in render"))},this.$_renderer.draw()}transition(e,t,r){const n=i=>{if(i>=e.length-1)return;const o=Math.max(.06*t[i],1),a={...e[i]},s=e[i+1].x-e[i].x,u=e[i+1].y-e[i].y,l=e[i+1].k-e[i].k,c=e[i].x,p=e[i].y,h=e[i].k,d=e=>e*e;let m=1;const f=setInterval(()=>{a.x=c+s*d(m/o),a.y=p+u*d(m/o),a.k=h+l*d(m/o),this.transform(a),this.draw(),r&&r({transform:a}),m+=1,m>=o&&(clearInterval(f),n(i+1))},1/.06)};n(0)}centerOn(e){const t=e.position();return this.$_interactionManager.centerPosition(t)}panBy(e,t){return this.$_interactionManager.panBy(e,t)}zoomBy(e,t){return this.$_interactionManager.zoomBy(e,t)}transform(e){return void 0===e||(this.$_transform=e,this.$_renderer.setTransform(this.$_transform)),this.$_transform}on(e,t){"zoom"===e.toLowerCase()?this.$_interactionManager.onZoom(t||p.EMPTY_FUNCTION):"pan"===e.toLowerCase()?this.$_interactionManager.onPan(t||p.EMPTY_FUNCTION):"mousedown"===e.toLowerCase()?this.$_interactionManager.onMousedown(t||p.EMPTY_FUNCTION):"mouseup"===e.toLowerCase()?this.$_interactionManager.onMouseup(t||p.EMPTY_FUNCTION):"click"===e.toLowerCase()&&this.$_interactionManager.onClick(t||p.EMPTY_FUNCTION)}off(e,t){"zoom"===e.toLowerCase()?this.$_interactionManager.offZoom(t||p.EMPTY_FUNCTION):"pan"===e.toLowerCase()?this.$_interactionManager.offPan(t||p.EMPTY_FUNCTION):"mousedown"===e.toLowerCase()?this.$_interactionManager.offMousedown(t||p.EMPTY_FUNCTION):"mouseup"===e.toLowerCase()?this.$_interactionManager.offMouseup(t||p.EMPTY_FUNCTION):"click"===e.toLowerCase()&&this.$_interactionManager.offClick(t||p.EMPTY_FUNCTION)}}t.default=m,m.Utils=c,window.NetV=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=String.fromCharCode(7),i=e=>e instanceof Array&&2===e.length&&e.every(e=>null!=e);t.default=class{constructor(e){this.map=new Map,e instanceof Array&&e.forEach(e=>{let[t,r]=e;this.set(t,r)})}get size(){return this.map.size}delete(e){if(i(e)){const t=e.join(n),r=e[1]+n+e[0];let i=this.map;i.delete(t),i.delete(r)}}set(e,t){if(i(e)){const r=e.join(n),i=e[1]+n+e[0];let o=this.map;o.has(i)?o.set(i,t):o.set(r,t)}return this}get(e){if(i(e)){const t=e.join(n),r=e[1]+n+e[0];return this.map.get(t)||this.map.get(r)}}has(e){if(i(e)){const t=e.join(n),r=e[1]+n+e[0];return this.map.has(t)||this.map.has(r)}return!1}forEach(e){this.map.forEach((t,r)=>{let i=r.split(n);e(t,i,this)})}entries(){return[...this.map.entries()].map(e=>[e[0].split(n),e[1]])}keys(){return[...this.map.keys()].map(e=>e.split(n))}values(){return[...this.map.values()]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8),i=r(1);class o extends i.default{constructor(e,t){super(e,t,"Node"),this.$_position={x:0,y:0},this.$_dragstartCallbackSet=new Set,this.$_draggingCallbackSet=new Set,this.$_dragendCallbackSet=new Set,this.$_elementReservedKeys=new Set(["id","x","y","style"]);for(const e in t)this.$_elementReservedKeys.has(e)||(this.$_attributes[e]=t[e]);const r={x:this.$_position.x,y:this.$_position.y,...t};this.$_setId(r.id),this.$_position={x:r.x,y:r.y}}id(){return this.$_id}neighborNodes(){let e=this.$_core.$_sourceId2links.get(this.$_id);e||(e=new Set);let t=this.$_core.$_targetId2links.get(this.$_id);t||(t=new Set);const r=new Set([...[...e].map(e=>e.$_target),...[...t].map(e=>e.$_source)]);return Array.from(r)}neighborLinks(){let e=this.$_core.$_sourceId2links.get(this.$_id);e||(e=new Set);let t=this.$_core.$_targetId2links.get(this.$_id);t||(t=new Set);const r=new Set([...e,...t]);return Array.from(r)}x(e){return arguments.length>0&&this.position({x:e}),this.$_position.x}y(e){return arguments.length>0&&this.position({y:e}),this.$_position.y}position(e){let t={};if(arguments.length>0&&("x"in e||"y"in e)){if("x"in e&&(this.$_position.x=e.x),"y"in e&&(this.$_position.y=e.y),this.$_core.$_renderer.shouldLazyUpdate)return this.$_position;t={source:this.$_core.$_sourceId2links.get(this.$_id),target:this.$_core.$_targetId2links.get(this.$_id)},Object.entries(t).forEach(e=>{const t=e[0],r=e[1];if(r){this.$_core.$_renderer.increaseModifiedElementsCountBy(r.size);for(const e of r)this.$_core.$_renderer.linkManager.changeAttribute(e,t)}}),this.$_core.$_renderer.increaseModifiedElementsCountBy(1),this.$_core.$_renderer.nodeManager.changeAttribute(this,"position")}return this.$_position}$_setId(e){if(!n.isValidId(e))throw new Error("Invalid ID "+e);if(this.$_core.$_id2node.has(e))throw new Error(`Duplicate node (${e}) is not allowed.`);if(n.isValidId(this.$_id))throw new Error("Can not change the id of an exist node.");this.$_core.$_id2node.set(e,this),this.$_id=e}}t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidId=void 0,t.isValidId=function(e){return void 0!==e&&"string"==typeof e&&e.length>0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1);class i extends n.default{constructor(e,t){super(e,t,"Link"),this.$_elementReservedKeys=new Set(["source","target","style"]);for(const e in t)this.$_elementReservedKeys.has(e)||(this.$_attributes[e]=t[e]);const r=this.$_core.getNodeById(t.source),n=this.$_core.getNodeById(t.target);this.sourceTarget({source:r,target:n})}source(e){return 1===arguments.length&&this.sourceTarget({source:e,target:this.$_target}),this.$_source}target(e){return 1===arguments.length&&this.sourceTarget({source:this.$_source,target:e}),this.$_target}sourceTarget(e){var t,r;if(arguments.length>0){const n=this.$_source,i=this.$_target,o=e.source,a=e.target,s=o.$_id,u=a.$_id;if(o===a)throw new Error(`Self loop (${s} <=> ${u}) is not allowed.`);if(this.$_core.$_ends2link.has([s,u]))throw new Error(`Multiple link (${s} <=> ${u}) is not allowd.`);n&&i&&(this.$_core.$_ends2link.delete([n.$_id,i.$_id]),null===(t=this.$_core.$_sourceId2links.get(n.$_id))||void 0===t||t.delete(this),null===(r=this.$_core.$_targetId2links.get(i.$_id))||void 0===r||r.delete(this)),this.$_source=o,this.$_target=a,this.$_core.$_ends2link.set([s,u],this),this.$_core.$_sourceId2links.has(s)?this.$_core.$_sourceId2links.get(s).add(this):this.$_core.$_sourceId2links.set(s,new Set([this])),this.$_core.$_targetId2links.has(u)?this.$_core.$_targetId2links.get(u).add(this):this.$_core.$_targetId2links.set(u,new Set([this]))}return{source:this.$_source,target:this.$_target}}}t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.link=t.node=t.linkLimit=t.nodeLimit=t.enablePanZoom=t.backgroundColor=t.height=t.width=void 0,t.width=800,t.height=600,t.backgroundColor={r:1,g:1,b:1,a:1},t.enablePanZoom=!0,t.nodeLimit=1e3,t.linkLimit=2e4,t.node={style:{shape:"circle",offset:{x:0,y:0},fill:{r:.2,g:.6,b:.2,a:1},strokeColor:{r:.9,g:.9,b:.9,a:.6},strokeWidth:2,r:10,width:5,height:5,innerWidth:5,innerHeight:5,rotate:0,vertexAlpha:{x:0,y:-4},vertexBeta:{x:-2*Math.sqrt(3),y:2},vertexGamma:{x:2*Math.sqrt(3),y:2}}},t.link={style:{shape:"line",strokeColor:{r:.4,g:.6,b:.8,a:.5},strokeWidth:2,curveness:.2,dashInterval:5}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.patents=t.miserables=void 0;const n=r(12);Object.defineProperty(t,"miserables",{enumerable:!0,get:function(){return n.miserables}});const i=r(13);Object.defineProperty(t,"patents",{enumerable:!0,get:function(){return i.patents}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.miserables=void 0,t.miserables={nodes:[{id:"Myriel",x:293.47145117553623,y:356.4335718104138,group:1},{id:"Napoleon",x:253.9025088618656,y:374.3058116536445,group:1},{id:"Mlle.Baptistine",x:350.92724989918077,y:332.3325539999943,group:1},{id:"Mme.Magloire",x:356.0916156539997,y:352.7885799116015,group:1},{id:"CountessdeLo",x:254.29291520989335,y:357.3175734076417,group:1},{id:"Geborand",x:257.857293626201,y:335.85427628358957,group:1},{id:"Champtercier",x:259.6255563825028,y:383.83027469832814,group:1},{id:"Cravatte",x:249.8596459829139,y:346.18225516832496,group:1},{id:"Count",x:269.96793951350924,y:390.6800842321571,group:1},{id:"OldMan",x:246.73952311277665,y:364.59357494432066,group:1},{id:"Labarre",x:443.516583315026,y:358.29204789477683,group:2},{id:"Valjean",x:442.16894757641506,y:320.8315532160861,group:2},{id:"Marguerite",x:413.3816851007931,y:240.04091559296504,group:3},{id:"Mme.deR",x:427.2361715950254,y:355.10211589979514,group:2},{id:"Isabeau",x:405.85082858191834,y:330.5201512205085,group:2},{id:"Gervais",x:405.2113121906881,y:316.29125359396136,group:2},{id:"Tholomyes",x:422.4125307781646,y:126.07649449775806,group:3},{id:"Listolier",x:363.1729422677979,y:102.77890368289785,group:3},{id:"Fameuil",x:381.7947103094028,y:66.58133724043948,group:3},{id:"Blacheville",x:383.1792676740261,y:94.80320315500154,group:3},{id:"Favourite",x:361.893731644285,y:70.38696381384074,group:3},{id:"Dahlia",x:398.75350988351653,y:77.09700751527119,group:3},{id:"Zephine",x:349.0495914601376,y:88.80888613372713,group:3},{id:"Fantine",x:398.01411438702473,y:173.76444196945977,group:3},{id:"Mme.Thenardier",x:471.2516533386725,y:262.218701666645,group:4},{id:"Thenardier",x:504.81672085603066,y:283.04638900481723,group:4},{id:"Cosette",x:472.3346941487192,y:228.68779443303478,group:5},{id:"Javert",x:460.05257689332836,y:295.5578154268904,group:4},{id:"Fauchelevent",x:385.43935764589986,y:302.12824588622857,group:0},{id:"Bamatabois",x:393.19041590383597,y:345.4971667690817,group:2},{id:"Perpetue",x:367.53833132893976,y:194.5556482306271,group:3},{id:"Simplice",x:401.3622252354655,y:242.9982847994576,group:2},{id:"Scaufflaire",x:414.67072799627573,y:344.0547720945736,group:2},{id:"Woman1",x:421.4167414392426,y:293.31120219129394,group:2},{id:"Judge",x:420.04392007841335,y:401.03233609152744,group:2},{id:"Champmathieu",x:377.79524254621833,y:383.8105787115102,group:2},{id:"Brevet",x:401.9529844469992,y:388.8684782987411,group:2},{id:"Chenildieu",x:400.6685707133538,y:413.49417790523466,group:2},{id:"Cochepaille",x:379.04969704462354,y:404.26974059233163,group:2},{id:"Pontmercy",x:553.1137401750198,y:244.92830027360765,group:4},{id:"Boulatruelle",x:490.1571086086932,y:249.2101923835803,group:6},{id:"Eponine",x:549.7584267571892,y:302.9031065228431,group:4},{id:"Anzelma",x:515.3807399395134,y:257.0179688983911,group:4},{id:"Woman2",x:433.6608665340514,y:265.8174673886634,group:5},{id:"MotherInnocent",x:403.02536257416523,y:289.03312200121326,group:0},{id:"Gribier",x:341.80973227456775,y:294.212396148023,group:0},{id:"Jondrette",x:565.1965303422186,y:470.65950349375856,group:7},{id:"Mme.Burgon",x:569.1896269242101,y:426.66185053824563,group:7},{id:"Gavroche",x:572.1619393936826,y:364.22606766497563,group:8},{id:"Gillenormand",x:524.5914505208005,y:257.4012214828336,group:5},{id:"Magnon",x:492.548393202341,y:222.5966351328885,group:5},{id:"Mlle.Gillenormand",x:514.3692655023644,y:229.09670062389281,group:5},{id:"Mme.Pontmercy",x:549.3250508171474,y:196.14056833084936,group:5},{id:"Mlle.Vaubois",x:517.8593572394071,y:186.2488309111565,group:5},{id:"Lt.Gillenormand",x:543.274961139455,y:223.68184285180976,group:5},{id:"Marius",x:574.2576699056139,y:283.85211708310334,group:8},{id:"BaronessT",x:573.7140909650625,y:245.59311909245818,group:5},{id:"Mabeuf",x:628.5432532486191,y:314.22078408627164,group:8},{id:"Enjolras",x:588.2395498093626,y:342.0594469923279,group:8},{id:"Combeferre",x:637.7370664614637,y:351.69235762788395,group:8},{id:"Prouvaire",x:650.8833522869903,y:386.83918103509916,group:8},{id:"Feuilly",x:626.8556606438109,y:365.9084164593141,group:8},{id:"Courfeyrac",x:628.3448989975013,y:336.7666454119022,group:8},{id:"Bahorel",x:656.7717772764985,y:362.5885882509189,group:8},{id:"Bossuet",x:599.0185765743107,y:363.8286723407053,group:8},{id:"Joly",x:656.6182923735408,y:343.2375733559165,group:8},{id:"Grantaire",x:638.4375855314988,y:402.4387250378995,group:8},{id:"MotherPlutarch",x:664.556723861883,y:298.0336964526786,group:9},{id:"Gueulemer",x:508.16450525817805,y:330.4502907444367,group:4},{id:"Babet",x:492.56005279882095,y:325.9834092848427,group:4},{id:"Claquesous",x:510.93855506250077,y:309.2869380697328,group:4},{id:"Montparnasse",x:502.7190894173557,y:350.9275183133438,group:4},{id:"Toussaint",x:445.1254802056807,y:266.46242665022004,group:5},{id:"Child1",x:588.0351552386961,y:410.2195555961996,group:10},{id:"Child2",x:559.2777814782705,y:408.3533184893569,group:10},{id:"Brujon",x:537.1787383904656,y:337.86922775917947,group:4},{id:"Mme.Hucheloup",x:626.3775850466164,y:384.35202066894516,group:8}],links:[{source:"Napoleon",target:"Myriel",value:1},{source:"Mlle.Baptistine",target:"Myriel",value:8},{source:"Mme.Magloire",target:"Myriel",value:10},{source:"Mme.Magloire",target:"Mlle.Baptistine",value:6},{source:"CountessdeLo",target:"Myriel",value:1},{source:"Geborand",target:"Myriel",value:1},{source:"Champtercier",target:"Myriel",value:1},{source:"Cravatte",target:"Myriel",value:1},{source:"Count",target:"Myriel",value:2},{source:"OldMan",target:"Myriel",value:1},{source:"Valjean",target:"Labarre",value:1},{source:"Valjean",target:"Mme.Magloire",value:3},{source:"Valjean",target:"Mlle.Baptistine",value:3},{source:"Valjean",target:"Myriel",value:5},{source:"Marguerite",target:"Valjean",value:1},{source:"Mme.deR",target:"Valjean",value:1},{source:"Isabeau",target:"Valjean",value:1},{source:"Gervais",target:"Valjean",value:1},{source:"Listolier",target:"Tholomyes",value:4},{source:"Fameuil",target:"Tholomyes",value:4},{source:"Fameuil",target:"Listolier",value:4},{source:"Blacheville",target:"Tholomyes",value:4},{source:"Blacheville",target:"Listolier",value:4},{source:"Blacheville",target:"Fameuil",value:4},{source:"Favourite",target:"Tholomyes",value:3},{source:"Favourite",target:"Listolier",value:3},{source:"Favourite",target:"Fameuil",value:3},{source:"Favourite",target:"Blacheville",value:4},{source:"Dahlia",target:"Tholomyes",value:3},{source:"Dahlia",target:"Listolier",value:3},{source:"Dahlia",target:"Fameuil",value:3},{source:"Dahlia",target:"Blacheville",value:3},{source:"Dahlia",target:"Favourite",value:5},{source:"Zephine",target:"Tholomyes",value:3},{source:"Zephine",target:"Listolier",value:3},{source:"Zephine",target:"Fameuil",value:3},{source:"Zephine",target:"Blacheville",value:3},{source:"Zephine",target:"Favourite",value:4},{source:"Zephine",target:"Dahlia",value:4},{source:"Fantine",target:"Tholomyes",value:3},{source:"Fantine",target:"Listolier",value:3},{source:"Fantine",target:"Fameuil",value:3},{source:"Fantine",target:"Blacheville",value:3},{source:"Fantine",target:"Favourite",value:4},{source:"Fantine",target:"Dahlia",value:4},{source:"Fantine",target:"Zephine",value:4},{source:"Fantine",target:"Marguerite",value:2},{source:"Fantine",target:"Valjean",value:9},{source:"Mme.Thenardier",target:"Fantine",value:2},{source:"Mme.Thenardier",target:"Valjean",value:7},{source:"Thenardier",target:"Mme.Thenardier",value:13},{source:"Thenardier",target:"Fantine",value:1},{source:"Thenardier",target:"Valjean",value:12},{source:"Cosette",target:"Mme.Thenardier",value:4},{source:"Cosette",target:"Valjean",value:31},{source:"Cosette",target:"Tholomyes",value:1},{source:"Cosette",target:"Thenardier",value:1},{source:"Javert",target:"Valjean",value:17},{source:"Javert",target:"Fantine",value:5},{source:"Javert",target:"Thenardier",value:5},{source:"Javert",target:"Mme.Thenardier",value:1},{source:"Javert",target:"Cosette",value:1},{source:"Fauchelevent",target:"Valjean",value:8},{source:"Fauchelevent",target:"Javert",value:1},{source:"Bamatabois",target:"Fantine",value:1},{source:"Bamatabois",target:"Javert",value:1},{source:"Bamatabois",target:"Valjean",value:2},{source:"Perpetue",target:"Fantine",value:1},{source:"Simplice",target:"Perpetue",value:2},{source:"Simplice",target:"Valjean",value:3},{source:"Simplice",target:"Fantine",value:2},{source:"Simplice",target:"Javert",value:1},{source:"Scaufflaire",target:"Valjean",value:1},{source:"Woman1",target:"Valjean",value:2},{source:"Woman1",target:"Javert",value:1},{source:"Judge",target:"Valjean",value:3},{source:"Judge",target:"Bamatabois",value:2},{source:"Champmathieu",target:"Valjean",value:3},{source:"Champmathieu",target:"Judge",value:3},{source:"Champmathieu",target:"Bamatabois",value:2},{source:"Brevet",target:"Judge",value:2},{source:"Brevet",target:"Champmathieu",value:2},{source:"Brevet",target:"Valjean",value:2},{source:"Brevet",target:"Bamatabois",value:1},{source:"Chenildieu",target:"Judge",value:2},{source:"Chenildieu",target:"Champmathieu",value:2},{source:"Chenildieu",target:"Brevet",value:2},{source:"Chenildieu",target:"Valjean",value:2},{source:"Chenildieu",target:"Bamatabois",value:1},{source:"Cochepaille",target:"Judge",value:2},{source:"Cochepaille",target:"Champmathieu",value:2},{source:"Cochepaille",target:"Brevet",value:2},{source:"Cochepaille",target:"Chenildieu",value:2},{source:"Cochepaille",target:"Valjean",value:2},{source:"Cochepaille",target:"Bamatabois",value:1},{source:"Pontmercy",target:"Thenardier",value:1},{source:"Boulatruelle",target:"Thenardier",value:1},{source:"Eponine",target:"Mme.Thenardier",value:2},{source:"Eponine",target:"Thenardier",value:3},{source:"Anzelma",target:"Eponine",value:2},{source:"Anzelma",target:"Thenardier",value:2},{source:"Anzelma",target:"Mme.Thenardier",value:1},{source:"Woman2",target:"Valjean",value:3},{source:"Woman2",target:"Cosette",value:1},{source:"Woman2",target:"Javert",value:1},{source:"MotherInnocent",target:"Fauchelevent",value:3},{source:"MotherInnocent",target:"Valjean",value:1},{source:"Gribier",target:"Fauchelevent",value:2},{source:"Mme.Burgon",target:"Jondrette",value:1},{source:"Gavroche",target:"Mme.Burgon",value:2},{source:"Gavroche",target:"Thenardier",value:1},{source:"Gavroche",target:"Javert",value:1},{source:"Gavroche",target:"Valjean",value:1},{source:"Gillenormand",target:"Cosette",value:3},{source:"Gillenormand",target:"Valjean",value:2},{source:"Magnon",target:"Gillenormand",value:1},{source:"Magnon",target:"Mme.Thenardier",value:1},{source:"Mlle.Gillenormand",target:"Gillenormand",value:9},{source:"Mlle.Gillenormand",target:"Cosette",value:2},{source:"Mlle.Gillenormand",target:"Valjean",value:2},{source:"Mme.Pontmercy",target:"Mlle.Gillenormand",value:1},{source:"Mme.Pontmercy",target:"Pontmercy",value:1},{source:"Mlle.Vaubois",target:"Mlle.Gillenormand",value:1},{source:"Lt.Gillenormand",target:"Mlle.Gillenormand",value:2},{source:"Lt.Gillenormand",target:"Gillenormand",value:1},{source:"Lt.Gillenormand",target:"Cosette",value:1},{source:"Marius",target:"Mlle.Gillenormand",value:6},{source:"Marius",target:"Gillenormand",value:12},{source:"Marius",target:"Pontmercy",value:1},{source:"Marius",target:"Lt.Gillenormand",value:1},{source:"Marius",target:"Cosette",value:21},{source:"Marius",target:"Valjean",value:19},{source:"Marius",target:"Tholomyes",value:1},{source:"Marius",target:"Thenardier",value:2},{source:"Marius",target:"Eponine",value:5},{source:"Marius",target:"Gavroche",value:4},{source:"BaronessT",target:"Gillenormand",value:1},{source:"BaronessT",target:"Marius",value:1},{source:"Mabeuf",target:"Marius",value:1},{source:"Mabeuf",target:"Eponine",value:1},{source:"Mabeuf",target:"Gavroche",value:1},{source:"Enjolras",target:"Marius",value:7},{source:"Enjolras",target:"Gavroche",value:7},{source:"Enjolras",target:"Javert",value:6},{source:"Enjolras",target:"Mabeuf",value:1},{source:"Enjolras",target:"Valjean",value:4},{source:"Combeferre",target:"Enjolras",value:15},{source:"Combeferre",target:"Marius",value:5},{source:"Combeferre",target:"Gavroche",value:6},{source:"Combeferre",target:"Mabeuf",value:2},{source:"Prouvaire",target:"Gavroche",value:1},{source:"Prouvaire",target:"Enjolras",value:4},{source:"Prouvaire",target:"Combeferre",value:2},{source:"Feuilly",target:"Gavroche",value:2},{source:"Feuilly",target:"Enjolras",value:6},{source:"Feuilly",target:"Prouvaire",value:2},{source:"Feuilly",target:"Combeferre",value:5},{source:"Feuilly",target:"Mabeuf",value:1},{source:"Feuilly",target:"Marius",value:1},{source:"Courfeyrac",target:"Marius",value:9},{source:"Courfeyrac",target:"Enjolras",value:17},{source:"Courfeyrac",target:"Combeferre",value:13},{source:"Courfeyrac",target:"Gavroche",value:7},{source:"Courfeyrac",target:"Mabeuf",value:2},{source:"Courfeyrac",target:"Eponine",value:1},{source:"Courfeyrac",target:"Feuilly",value:6},{source:"Courfeyrac",target:"Prouvaire",value:3},{source:"Bahorel",target:"Combeferre",value:5},{source:"Bahorel",target:"Gavroche",value:5},{source:"Bahorel",target:"Courfeyrac",value:6},{source:"Bahorel",target:"Mabeuf",value:2},{source:"Bahorel",target:"Enjolras",value:4},{source:"Bahorel",target:"Feuilly",value:3},{source:"Bahorel",target:"Prouvaire",value:2},{source:"Bahorel",target:"Marius",value:1},{source:"Bossuet",target:"Marius",value:5},{source:"Bossuet",target:"Courfeyrac",value:12},{source:"Bossuet",target:"Gavroche",value:5},{source:"Bossuet",target:"Bahorel",value:4},{source:"Bossuet",target:"Enjolras",value:10},{source:"Bossuet",target:"Feuilly",value:6},{source:"Bossuet",target:"Prouvaire",value:2},{source:"Bossuet",target:"Combeferre",value:9},{source:"Bossuet",target:"Mabeuf",value:1},{source:"Bossuet",target:"Valjean",value:1},{source:"Joly",target:"Bahorel",value:5},{source:"Joly",target:"Bossuet",value:7},{source:"Joly",target:"Gavroche",value:3},{source:"Joly",target:"Courfeyrac",value:5},{source:"Joly",target:"Enjolras",value:5},{source:"Joly",target:"Feuilly",value:5},{source:"Joly",target:"Prouvaire",value:2},{source:"Joly",target:"Combeferre",value:5},{source:"Joly",target:"Mabeuf",value:1},{source:"Joly",target:"Marius",value:2},{source:"Grantaire",target:"Bossuet",value:3},{source:"Grantaire",target:"Enjolras",value:3},{source:"Grantaire",target:"Combeferre",value:1},{source:"Grantaire",target:"Courfeyrac",value:2},{source:"Grantaire",target:"Joly",value:2},{source:"Grantaire",target:"Gavroche",value:1},{source:"Grantaire",target:"Bahorel",value:1},{source:"Grantaire",target:"Feuilly",value:1},{source:"Grantaire",target:"Prouvaire",value:1},{source:"MotherPlutarch",target:"Mabeuf",value:3},{source:"Gueulemer",target:"Thenardier",value:5},{source:"Gueulemer",target:"Valjean",value:1},{source:"Gueulemer",target:"Mme.Thenardier",value:1},{source:"Gueulemer",target:"Javert",value:1},{source:"Gueulemer",target:"Gavroche",value:1},{source:"Gueulemer",target:"Eponine",value:1},{source:"Babet",target:"Thenardier",value:6},{source:"Babet",target:"Gueulemer",value:6},{source:"Babet",target:"Valjean",value:1},{source:"Babet",target:"Mme.Thenardier",value:1},{source:"Babet",target:"Javert",value:2},{source:"Babet",target:"Gavroche",value:1},{source:"Babet",target:"Eponine",value:1},{source:"Claquesous",target:"Thenardier",value:4},{source:"Claquesous",target:"Babet",value:4},{source:"Claquesous",target:"Gueulemer",value:4},{source:"Claquesous",target:"Valjean",value:1},{source:"Claquesous",target:"Mme.Thenardier",value:1},{source:"Claquesous",target:"Javert",value:1},{source:"Claquesous",target:"Eponine",value:1},{source:"Claquesous",target:"Enjolras",value:1},{source:"Montparnasse",target:"Javert",value:1},{source:"Montparnasse",target:"Babet",value:2},{source:"Montparnasse",target:"Gueulemer",value:2},{source:"Montparnasse",target:"Claquesous",value:2},{source:"Montparnasse",target:"Valjean",value:1},{source:"Montparnasse",target:"Gavroche",value:1},{source:"Montparnasse",target:"Eponine",value:1},{source:"Montparnasse",target:"Thenardier",value:1},{source:"Toussaint",target:"Cosette",value:2},{source:"Toussaint",target:"Javert",value:1},{source:"Toussaint",target:"Valjean",value:1},{source:"Child1",target:"Gavroche",value:2},{source:"Child2",target:"Gavroche",value:2},{source:"Child2",target:"Child1",value:3},{source:"Brujon",target:"Babet",value:3},{source:"Brujon",target:"Gueulemer",value:3},{source:"Brujon",target:"Thenardier",value:3},{source:"Brujon",target:"Gavroche",value:1},{source:"Brujon",target:"Eponine",value:1},{source:"Brujon",target:"Claquesous",value:1},{source:"Brujon",target:"Montparnasse",value:1},{source:"Mme.Hucheloup",target:"Bossuet",value:1},{source:"Mme.Hucheloup",target:"Joly",value:1},{source:"Mme.Hucheloup",target:"Grantaire",value:1},{source:"Mme.Hucheloup",target:"Bahorel",value:1},{source:"Mme.Hucheloup",target:"Courfeyrac",value:1},{source:"Mme.Hucheloup",target:"Gavroche",value:1},{source:"Mme.Hucheloup",target:"Enjolras",value:1}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.patents=void 0,t.patents={nodes:[{type:"patent",id:"6516227",name:"Rechargeable spinal cord stimulator system",numCitations:1363,x:-146.50722772206416,y:237.7898848864182},{type:"patent",id:"6535909",name:"System and method for record and playback of collaborative Web browsing session",numCitations:1438,x:301.0880840740178,y:78.3544919158754},{type:"patent",id:"6549908",name:"Methods and apparatus for interpreting user selections in the context of a relation distributed as a set of orthogonalized sub-relations",numCitations:1268,x:-13.814856590741202,y:-183.5501679350274},{type:"patent",id:"6553563",name:"Development tool, method, and system for client server applications",numCitations:1351,x:-.5224312790142777,y:-247.1495779627279},{type:"patent",id:"6558320",name:"Handheld personal data assistant (PDA) with a medical device and method of using the same",numCitations:1514,x:-204.64071894654788,y:71.57055284512312},{type:"patent",id:"6558351",name:"Closed loop system for controlling insulin infusion",numCitations:1369,x:-212.97816000219387,y:14.71564053417009},{type:"patent",id:"6560461",name:"Authorized location reporting paging system",numCitations:1479,x:-250.43543062905093,y:-191.43720062406038},{type:"patent",id:"6563174",name:"Thin film transistor and matrix display device",numCitations:3284,x:-12.588249503652401,y:-3.606638925074952},{type:"patent",id:"6565509",name:"Analyte monitoring device and methods of use",numCitations:1333,x:-105.25511612362045,y:157.11713360602621},{type:"patent",id:"6571282",name:"Block-based communication in a communication services patterns environment",numCitations:1467,x:139.669746748281,y:253.01406501471942},{type:"patent",id:"6574635",name:"Application instantiation based upon attributes and values stored in a meta data repository, including tiering of application layers objects and components",numCitations:1368,x:11.002027627782116,y:-234.9180529832358},{type:"patent",id:"6577726",name:"Computer telephony integration hotelling method and system",numCitations:1270,x:-87.19153245841262,y:-173.97644755929284},{type:"patent",id:"6587835",name:"Shopping assistance with handheld computing device",numCitations:1471,x:-279.2865813378465,y:110.1587912501507},{type:"patent",id:"6601087",name:"Instant document sharing",numCitations:1397,x:210.94821350137184,y:92.53188786911404},{type:"patent",id:"6602252",name:"Combined dissecting, cauterizing, and stapling device",numCitations:1503,x:147.94977165043258,y:170.08888855631307},{type:"patent",id:"6604117",name:"Method of maintaining a network of partially replicated database system",numCitations:1261,x:-.888555802742035,y:-218.23048820307227},{type:"patent",id:"6604128",name:"Method and system for distributing objects over a network",numCitations:1261,x:-56.73872742120841,y:-243.3483841066443},{type:"patent",id:"6606744",name:"Providing collaborative installation management in a network-based supply chain environment",numCitations:1271,x:153.9948251850397,y:231.46579888120272},{type:"patent",id:"6609150",name:"Web client-server system and method for incompatible page markup and presentation languages",numCitations:1336,x:13.182867607321255,y:-184.8342643188157},{type:"patent",id:"6621834",name:"System and method for voice transmission over network protocols",numCitations:1265,x:85.08228149344369,y:105.43464571232896},{type:"patent",id:"6641533",name:"Handheld personal data assistant (PDA) with a medical device and method of using the same",numCitations:1431,x:-218.09766118001224,y:39.85760035797989},{type:"patent",id:"6644532",name:"Surgical stapling apparatus",numCitations:1267,x:304.6630925316294,y:-29.709611573491397},{type:"patent",id:"6654032",name:"Instant sharing of documents on a remote server",numCitations:1413,x:159.30050355296015,y:108.98389585627005},{type:"patent",id:"6656193",name:"Device for attachment of buttress material to a surgical fastening device",numCitations:1279,x:116.90914153158597,y:-78.76626936858557},{type:"patent",id:"6665648",name:"State models for monitoring process",numCitations:1288,x:-19.75185273935374,y:-126.65338912269928},{type:"patent",id:"6665655",name:"Implicit rating of retrieved information in an information search system",numCitations:1294,x:-205.5103612199467,y:-62.615175772923976},{type:"patent",id:"6684438",name:"Method of using cache to determine the visibility to a remote database client of a plurality of database transactions",numCitations:1265,x:-70.89621190805329,y:-211.65898126469475},{type:"patent",id:"6690387",name:"Touch-screen image scrolling system and method",numCitations:1361,x:-96.0833335861014,y:257.188666044209},{type:"patent",id:"6693232",name:"Inbred corn line LH295",numCitations:1585,x:225.21362396634333,y:-181.7023120873901},{type:"patent",id:"6698643",name:"Expanding parallel jaw device for use with an electromechanical driver device",numCitations:1355,x:116.93380088200308,y:220.21419705439607},{type:"patent",id:"6711565",name:"Method, apparatus, and system for previewing search results",numCitations:1388,x:-37.50448129076735,y:-273.41169584791356},{type:"patent",id:"6716233",name:"Electromechanical driver and remote surgical instrument attachment having computer assisted control capabilities",numCitations:1244,x:99.98744927740107,y:212.59527229962606},{type:"patent",id:"6718361",name:"Method and apparatus for reliable and scalable distribution of data files in distributed networks",numCitations:1349,x:-214.4706454200155,y:179.76445383311545},{type:"patent",id:"6724399",name:"Methods and apparatus for enabling keyboard accelerators in applications implemented via a browser",numCitations:1271,x:-3.865437098036597,y:-168.04665075977616},{type:"patent",id:"6727522",name:"Transistor and semiconductor device",numCitations:3301,x:45.493009086533476,y:-18.399336761865555},{type:"patent",id:"6728702",name:"System and method to implement an integrated search center supporting a full-text search and query on a database",numCitations:1290,x:-50.77651269647964,y:-265.6439416642619},{type:"patent",id:"6728960",name:"Techniques for managing multiple threads in a browser environment",numCitations:1287,x:-31.86098260027274,y:-177.09627925166075},{type:"patent",id:"6732095",name:"Method and apparatus for mapping between XML and relational representations",numCitations:1318,x:-45.17430826877544,y:-152.23938355298804},{type:"patent",id:"6732100",name:"Database access method and system for user role defined access",numCitations:1347,x:-59.210136806292674,y:-174.83877990849572},{type:"patent",id:"6732111",name:"Method, apparatus, system, and program product for attaching files and other objects to a partially replicated database",numCitations:1294,x:-90.7397050479451,y:-244.71990328774314},{type:"patent",id:"6754681",name:"Partially replicated distributed database with multiple levels of remote clients",numCitations:1269,x:-79.58083870312655,y:-228.1724054173842},{type:"patent",id:"6763351",name:"Method, apparatus, and system for attaching search results",numCitations:1487,x:-25.243474733492743,y:-263.25740794021067},{type:"patent",id:"6763501",name:"Remote document serving",numCitations:1319,x:158.3253837620942,y:93.49546231516919},{type:"patent",id:"6768904",name:"Data communication method using mobile terminal",numCitations:1256,x:-307.97606158133414,y:18.769756679797396},{type:"patent",id:"6782383",name:"System and method to implement a persistent and dismissible search center frame",numCitations:1282,x:-12.976177557835852,y:-272.9194404073791},{type:"patent",id:"6783524",name:"Robotic surgical tool with ultrasound cauterizing and cutting instrument",numCitations:1505,x:43.38231098694066,y:279.08217801147714},{type:"patent",id:"6786382",name:"Surgical stapling instrument incorporating an articulation joint for a firing bar track",numCitations:1371,x:134.94078164502835,y:-65.10082373566381},{type:"patent",id:"6804330",name:"Method and system for accessing CRM data via voice",numCitations:1348,x:41.445251723842865,y:-236.9915648109865},{type:"patent",id:"6809653",name:"Telemetered characteristic monitor system and method of using the same",numCitations:1250,x:-192.3665947756808,y:85.20039713859154},{type:"patent",id:"6826565",name:"Method and apparatus for serving files to browsing clients",numCitations:1253,x:-187.202078612142,y:-205.8028067140975},{type:"patent",id:"6826582",name:"Method and system for using file systems for content management",numCitations:1262,x:-173.39071713434592,y:-84.74810645391052},{type:"patent",id:"6826745",name:"System and method for smart scripting call centers and configuration thereof",numCitations:1290,x:-76.78126433121005,y:-189.22148175125054},{type:"patent",id:"6829655",name:"Method and system for server synchronization with a computing device via a companion device",numCitations:1292,x:54.15067210701869,y:-193.55954311545358},{type:"patent",id:"6830174",name:"Medical instrument",numCitations:1345,x:241.6836563040002,y:178.8101554942473},{type:"patent",id:"6842748",name:"Usage based strength between related information in an information retrieval system",numCitations:1273,x:-255.7671401763918,y:-89.30941490160309},{type:"patent",id:"6843403",name:"Surgical clamping, cutting and stapling device",numCitations:1278,x:80.62267888317515,y:204.67249292957572},{type:"patent",id:"6850252",name:"Intelligent electronic appliance system and method",numCitations:1784,x:-269.0939625716982,y:80.79152540917103},{type:"patent",id:"6850895",name:"Assignment manager",numCitations:1429,x:-104.71523172899978,y:-237.67489051495383},{type:"patent",id:"6850949",name:"System and method for generating a dynamic interface via a communications network",numCitations:1276,x:170.8948478666423,y:-157.1623996387279},{type:"patent",id:"6852915",name:"Inbred corn line LH283BtMON810",numCitations:1584,x:214.2878252666797,y:-221.65064590625735},{type:"patent",id:"6905057",name:"Surgical stapling instrument incorporating a firing mechanism having a linked rack transmission",numCitations:1398,x:204.244314091743,y:-78.10023672232607},{type:"patent",id:"6959852",name:"Surgical stapling instrument with multistroke firing incorporating an anti-backup mechanism",numCitations:1279,x:214.47741140236582,y:-56.291587636591125},{type:"patent",id:"6964363",name:"Surgical stapling instrument having articulation joint support plates for supporting a firing bar",numCitations:1330,x:171.89247270898028,y:-97.41002462550293},{type:"patent",id:"6978921",name:"Surgical stapling instrument incorporating an E-beam firing mechanism",numCitations:1271,x:220.9998003804044,y:-71.42078135636545},{type:"patent",id:"6981628",name:"Surgical instrument with a lateral-moving articulation control",numCitations:1588,x:155.12209667738722,y:-93.69628751460294},{type:"patent",id:"7000818",name:"Surgical stapling instrument having separate distinct closing and firing systems",numCitations:1422,x:227.01768845379692,y:7.024056611463051},{type:"patent",id:"7025743",name:"External infusion device with remote programming, bolus estimator and/or vibration alarm capabilities",numCitations:1348,x:-139.33487275744275,y:46.52061115334398},{type:"patent",id:"7049190",name:"Method for forming ZnO film, method for forming ZnO semiconductor layer, method for fabricating semiconductor device, and semiconductor device",numCitations:3234,x:-289.10918833611,y:-97.96776938549537},{type:"patent",id:"7055731",name:"Surgical stapling instrument incorporating a tapered firing bar for increased flexibility around the articulation joint",numCitations:1325,x:230.49518386439988,y:-59.64224567858248},{type:"patent",id:"7061014",name:"Natural-superlattice homologous single crystal thin film, method for preparation thereof, and device using said single crystal thin film",numCitations:3339,x:-5.800882044901439,y:68.52641595031525},{type:"patent",id:"7064346",name:"Transistor and semiconductor device",numCitations:3268,x:-3.4003031519913716,y:25.981356836043688},{type:"patent",id:"7105868",name:"High-electron mobility transistor with zinc oxide",numCitations:3233,x:-17.835785749785817,y:199.91883720210305},{type:"patent",id:"7111769",name:"Surgical instrument incorporating an articulation mechanism having rotation about the longitudinal axis",numCitations:1278,x:151.22579832524045,y:-37.17099074749013},{type:"patent",id:"7147138",name:"Surgical stapling instrument having an electroactive polymer actuated buttress deployment mechanism",numCitations:1428,x:189.086143238575,y:-73.69130392683924},{type:"patent",id:"7159750",name:"Surgical stapling device",numCitations:1258,x:-41.29995186519443,y:292.8462674537822},{type:"patent",id:"7211825",name:"Indium oxide-based thin film transistors and circuits",numCitations:3245,x:-312.3839057221477,y:-5.614541567133007},{type:"patent",id:"7246734",name:"Rotary hydraulic pump actuated multi-stroke surgical instrument",numCitations:1288,x:200.44563380086515,y:-63.18865588076886},{type:"patent",id:"7282782",name:"Combined binary oxide semiconductor device",numCitations:3273,x:-125.8309041477986,y:-31.277877893580488},{type:"patent",id:"7297977",name:"Semiconductor device",numCitations:3318,x:-128.28288629696726,y:-55.26147557803329},{type:"patent",id:"7323356",name:"LnCuO(S,Se,Te)monocrystalline thin film, its manufacturing method, and optical device or electronic device using the monocrystalline thin film",numCitations:3251,x:-18.59755305395574,y:88.95531610838968},{type:"patent",id:"7340411",name:"System and method for generating, capturing, and managing customer lead information over a computer network",numCitations:1282,x:171.1408315591698,y:-202.24883708044808},{type:"patent",id:"7380695",name:"Surgical stapling instrument having a single lockout mechanism for prevention of firing",numCitations:1386,x:186.25833530110194,y:-21.66321873245209},{type:"patent",id:"7380696",name:"Articulating surgical stapling instrument incorporating a two-piece E-beam firing mechanism",numCitations:1388,x:207.9029593903179,y:-8.531533737621885},{type:"patent",id:"7385224",name:"Thin film transistor having an etching protection film and manufacturing method thereof",numCitations:3224,x:-209.82230482555335,y:-138.5100409900293},{type:"patent",id:"7402506",name:"Methods of making thin film transistors comprising zinc-oxide-based semiconductor materials and transistors made thereby",numCitations:3258,x:205.02475667447774,y:185.67878066443038},{type:"patent",id:"7404508",name:"Surgical stapling and cutting device",numCitations:1517,x:142.8534886173237,y:1.3325885281748553},{type:"patent",id:"7411209",name:"Field-effect transistor and method for manufacturing the same",numCitations:3255,x:98.46207221183528,y:123.03084775370279},{type:"patent",id:"7453065",name:"Sensor and image pickup device",numCitations:3230,x:-.16573743942671854,y:141.28922935299022},{type:"patent",id:"7453087",name:"Thin-film transistor and thin-film diode having amorphous-oxide semiconductor layer",numCitations:3242,x:64.92619908272222,y:181.84593665090443},{type:"patent",id:"7462862",name:"Transistor using an isovalent semiconductor oxide as the active channel layer",numCitations:3244,x:-69.61679142848251,y:-17.951431766711924},{type:"patent",id:"7464846",name:"Surgical instrument having a removable battery",numCitations:1287,x:181.84194955991686,y:-6.130356644541759},{type:"patent",id:"7468304",name:"Method of fabricating oxide semiconductor device",numCitations:3240,x:43.14447422876499,y:84.30857449883901},{type:"patent",id:"7501293",name:"Semiconductor device in which zinc oxide is used as a semiconductor material and method for manufacturing the semiconductor device",numCitations:3216,x:100.75984495619763,y:263.93928117765387},{type:"patent",id:"7506791",name:"Surgical stapling instrument with mechanical mechanism for limiting maximum tissue compression",numCitations:1257,x:162.8994374938383,y:-13.50766436461125},{type:"patent",id:"7620655",name:"Method, device and computer program product for identifying visitors of websites",numCitations:1243,x:273.7453257058471,y:-134.11969716806783},{type:"patent",id:"7632985",name:"Soybean event MON89788 and methods for detection thereof",numCitations:1477,x:25.156412731130995,y:232.6383745363165},{type:"patent",id:"7663607",name:"Multipoint touchscreen",numCitations:2217,x:148.31729075714412,y:-252.1205411729562},{type:"patent",id:"7674650",name:"Semiconductor device and manufacturing method thereof",numCitations:3439,x:265.20775273511885,y:97.08753175649879},{type:"patent",id:"7732819",name:"Semiconductor device and manufacturing method thereof",numCitations:3288,x:241.27432475696145,y:92.57917159661595},{type:"patent",id:"8053184",name:"Soybean event MON89788 and methods for detection thereof",numCitations:1249,x:12.74173927451986,y:223.33050946853854},{type:"inventor",id:"4082602-2",name:"Adam Heller",numPatents:278,x:-78.97918367878395,y:175.83458551945697},{type:"inventor",id:"6551276-11",name:"Adrian Gut",numPatents:14,x:-126.49163896882082,y:77.05392542894437},{type:"inventor",id:"6551276-3",name:"Alan Haubach",numPatents:15,x:-133.54480618517556,y:13.73644337954243},{type:"inventor",id:"6732095-1",name:"Alex Warshavsky",numPatents:38,x:-41.43006091014681,y:-115.69468137064817},{type:"inventor",id:"4082097-1",name:"Alfred E. Mann",numPatents:73,x:-166.25127823417688,y:64.21424556623339},{type:"inventor",id:"7402506-2",name:"Andrea C. Scuderi",numPatents:2,x:232.021013564944,y:201.54360553214553},{type:"inventor",id:"6295530-1",name:"Andrew M. Ritchie",numPatents:3,x:-180.13270109380883,y:-175.89335875039285},{type:"inventor",id:"5944791-1",name:"Andrew W. Scherpbier",numPatents:8,x:89.03596788702271,y:73.41966601562058},{type:"inventor",id:"6665648-4",name:"Andrzej P. Mazur",numPatents:1,x:-17.75957738133269,y:-90.04327884141138},{type:"inventor",id:"6577726-4",name:"Anil K. Annadata",numPatents:19,x:-90.27237726758581,y:-142.1198155312784},{type:"inventor",id:"6336137-3",name:"Anil Mukundan",numPatents:24,x:44.97570003882059,y:-173.1912630521635},{type:"inventor",id:"6829655-3",name:"Anupam Singhal",numPatents:12,x:68.03341497080808,y:-159.6164090183031},{type:"inventor",id:"5276262-2",name:"Arthur L. Johnson",numPatents:9,x:185.5095664352228,y:-228.8419915898405},{type:"inventor",id:"7082832-4",name:"Ayanori Endo",numPatents:5,x:116.09261573010951,y:149.17176081875573},{type:"inventor",id:"6370584-1",name:"Azer Bestavros",numPatents:8,x:-240.41292415194087,y:197.40201072984638},{type:"inventor",id:"5722997-2",name:"Behrad Aria",numPatents:75,x:-76.88639579899268,y:140.59743480285144},{type:"inventor",id:"4972224-1",name:"Bennie Thompson",numPatents:46,x:129.80735052389812,y:-4.481972559839983},{type:"inventor",id:"7620655-2",name:"Bjrn Sperling",numPatents:1,x:265.69802466021343,y:-163.1748759268247},{type:"inventor",id:"6551276-12",name:"Bob Murtfeldt",numPatents:14,x:-104.57602641605023,y:43.21929386017491},{type:"inventor",id:"6809653-9",name:"Brad T. Hite",numPatents:4,x:-178.740694429597,y:114.56430107100311},{type:"inventor",id:"6665648-5",name:"Brian Groves",numPatents:3,x:-4.063703727593559,y:-93.24666021615177},{type:"inventor",id:"7000818-3",name:"Brian J. Hemmelgarn",numPatents:2,x:251.87825271692208,y:28.28980319526008},{type:"inventor",id:"6658577-1",name:"Brian Q. Huppi",numPatents:94,x:123.19631987835258,y:-269.5549552777111},{type:"inventor",id:"5465895-1",name:"Bryan D. Knodel",numPatents:147,x:249.27159352509696,y:149.8942269653444},{type:"inventor",id:"5948006-1",name:"Carla M. Mann",numPatents:30,x:-148.41153476987805,y:268.2102368533701},{type:"inventor",id:"6558351-8",name:"Cary D. Talbot",numPatents:51,x:-242.1201373960085,y:1.0809105861722483},{type:"inventor",id:"5176644-1",name:"Chad Srisathapat",numPatents:28,x:-106.59780325645289,y:56.72415996247363},{type:"inventor",id:"6732095-2",name:"Chandrakant Ramkrishna Bhavsar",numPatents:7,x:-56.44692423602858,y:-114.38936355952521},{type:"inventor",id:"6804330-5",name:"Chris Haven",numPatents:8,x:76.58996926607027,y:-233.59376421774968},{type:"inventor",id:"5859916-3",name:"Christopher A. Julian",numPatents:35,x:32.49529202915526,y:307.85587157329917},{type:"inventor",id:"5963953-3",name:"Christopher Stauber",numPatents:3,x:38.876499177308936,y:-254.6853371485407},{type:"inventor",id:"6593834-2",name:"Chunong Qiu",numPatents:30,x:-299.51357073275767,y:28.693586133179505},{type:"inventor",id:"5703357-3",name:"Cindy Xing Qiu",numPatents:37,x:-307.60494602088494,y:-36.09974297692554},{type:"inventor",id:"5382232-1",name:"Cliff Hague",numPatents:25,x:-158.94889170792217,y:75.57366125967091},{type:"inventor",id:"6535909-1",name:"David Bradley Rust",numPatents:10,x:293.89378266881215,y:108.24045592690449},{type:"inventor",id:"5713911-1",name:"David C. Racenet",numPatents:117,x:-70.73199996729076,y:283.6884502132661},{type:"inventor",id:"5512426-1",name:"David H. Levy",numPatents:97,x:175.62273346829593,y:195.03348092042785},{type:"inventor",id:"5755737-3",name:"David Karl Lee Peterson",numPatents:10,x:-116.19997593920681,y:235.42317467768706},{type:"inventor",id:"6004276-13",name:"David L. Rabbers",numPatents:9,x:90.05455138839467,y:-199.76724302660992},{type:"inventor",id:"4127227-1",name:"David T. Green",numPatents:253,x:320.0538956493474,y:-2.5674406983783777},{type:"inventor",id:"5329655-1",name:"Dean L. Garner",numPatents:9,x:82.9868378665844,y:-75.01472155002138},{type:"inventor",id:"6551276-9",name:"Deborah Ruppert",numPatents:22,x:-118.26552937451507,y:20.131481189101695},{type:"inventor",id:"6551276-10",name:"Dennis P. Bishop",numPatents:16,x:-113.04138432659943,y:68.5347918156229},{type:"inventor",id:"5918159-2",name:"Denzil Willoughby Chesney",numPatents:8,x:-221.3438163197732,y:-180.31258868435725},{type:"inventor",id:"6912839-2",name:"Derek Dee Deville",numPatents:127,x:124.00562369714609,y:30.303518573213328},{type:"inventor",id:"6718361-8",name:"Domenic J. LaRosa",numPatents:7,x:-185.1634027151588,y:191.49880558090896},{type:"inventor",id:"6850949-1",name:"Doug Warner",numPatents:1,x:197.4109586624888,y:-141.51137425901277},{type:"inventor",id:"6530932-2",name:"Douglas B. Hoffman",numPatents:41,x:112.65902202678886,y:-41.95179419340801},{type:"inventor",id:"6434550-1",name:"Douglas K. Warner",numPatents:11,x:-240.213051803147,y:-58.38534522176044},{type:"inventor",id:"6850895-5",name:"Duane Wandless",numPatents:3,x:-141.77120370957505,y:-235.84945888555336},{type:"inventor",id:"7632985-4",name:"Ellen Dickinson",numPatents:5,x:-6.650712953659232,y:243.85922494977996},{type:"inventor",id:"5616532-3",name:"Ephraim Heller",numPatents:125,x:-136.66276931786788,y:148.50833287306844},{type:"inventor",id:"6724399-1",name:"Ernst Katchour",numPatents:2,x:20.460705177816816,y:-138.6316174346047},{type:"inventor",id:"4403687-2",name:"Eugene L. Timperman",numPatents:69,x:167.81405976240322,y:23.653794348670516},{type:"inventor",id:"6905057-2",name:"Frederick E. Shelton, IV",numPatents:1047,x:206.94055601161958,y:-33.63794401922105},{type:"inventor",id:"5041086-4",name:"Fredric C. Colman",numPatents:119,x:-93.07141522233565,y:187.61382791214774},{type:"inventor",id:"6433921-2",name:"G. Victor Treyz",numPatents:19,x:-250.2141922087249,y:117.70936188128789},{type:"inventor",id:"6558351-1",name:"Garry M. Steil",numPatents:21,x:-197.55033843707088,y:-14.969054157255261},{type:"inventor",id:"5707369-2",name:"Geoffrey C. Hueil",numPatents:37,x:88.77732129975968,y:-59.34294469090431},{type:"inventor",id:"6826582-2",name:"George Ericsson",numPatents:1,x:-158.02070855249937,y:-111.41355666075413},{type:"inventor",id:"RE28932-2",name:"Graham W. Bryan",numPatents:17,x:302.15197174981995,y:2.971153301217186},{type:"inventor",id:"6144679-1",name:"Gregory S Herman",numPatents:70,x:-107.08721212438253,y:-22.999325980475344},{type:"inventor",id:"6601087-2",name:"Guanghong Yang",numPatents:8,x:181.9400868080221,y:77.6677862338119},{type:"inventor",id:"6577726-3",name:"Henry D. Jay",numPatents:7,x:-122.02320476982499,y:-157.95566732418285},{type:"inventor",id:"4283024-1",name:"Henry R. Sienkiewicz",numPatents:35,x:274.60415603712727,y:-27.27330962584567},{type:"inventor",id:"7323356-5",name:"Hidenori Hiramatsu",numPatents:4,x:-36.605424251950446,y:115.850089319988},{type:"inventor",id:"4703019-2",name:"Hideo Hosono",numPatents:68,x:-9.859457094237333,y:112.18374696348913},{type:"inventor",id:"4253061-3",name:"Hideo Ohno",numPatents:55,x:16.424397835913993,y:1.5981290321141162},{type:"inventor",id:"5272069-6",name:"Hiromichi Ota",numPatents:19,x:-42.930231233299565,y:72.03081578296118},{type:"inventor",id:"5041200-1",name:"Hiromitsu Ishii",numPatents:40,x:-240.4509629339296,y:-150.27601265988352},{type:"inventor",id:"6863363-1",name:"Hisato Yabuta",numPatents:40,x:60.4372147665455,y:56.49664921881387},{type:"inventor",id:"7385224-2",name:"Hitoshi Hokari",numPatents:3,x:-241.8310333799511,y:-133.54049779295428},{type:"inventor",id:"5041200-4",name:"Ikuhiro Yamaguchi",numPatents:10,x:-228.78086701719153,y:-162.3667158856017},{type:"inventor",id:"4997262-1",name:"Ikuo Sakono",numPatents:9,x:-22.451556652393943,y:-34.04750168418211},{type:"inventor",id:"5081422-1",name:"Ishiang Shih",numPatents:28,x:-286.3270775940396,y:-23.733105119458497},{type:"inventor",id:"6281898-2",name:"Jacquelyn A. Martino",numPatents:43,x:-77.40426674630258,y:233.14366209397406},{type:"inventor",id:"6665648-3",name:"Jai-Jein Yu",numPatents:3,x:-31.84005286492673,y:-91.62375747364119},{type:"inventor",id:"4809697-1",name:"James D. Causey, III",numPatents:108,x:-178.265216120422,y:51.755680930746685},{type:"inventor",id:"4863425-2",name:"James L. Henke",numPatents:25,x:-229.82632326693144,y:81.1483918350451},{type:"inventor",id:"5533238-1",name:"James Say",numPatents:115,x:-110.26514650550313,y:189.73841907261374},{type:"inventor",id:"6711565-2",name:"Jason Zoss",numPatents:14,x:-36.79763583041338,y:-303.3606293140057},{type:"inventor",id:"6551276-8",name:"Jay Yonemoto",numPatents:26,x:-108.39060115065696,y:30.667530964984817},{type:"inventor",id:"5863326-1",name:"Jeffrey E. Nause",numPatents:7,x:-34.97468782651399,y:225.53781276672427},{type:"inventor",id:"4951278-2",name:"Jeffrey I. Cohen",numPatents:45,x:-106.67729256003422,y:-275.96655765182123},{type:"inventor",id:"6393605-1",name:"Jeffrey Loomans",numPatents:4,x:-12.089523280862164,y:-146.87295689250564},{type:"inventor",id:"5243622-2",name:"Jeffrey M. Fischer",numPatents:23,x:-69.11510576403663,y:-121.59596238278911},{type:"inventor",id:"5897563-4",name:"Jeffrey S. Swayze",numPatents:237,x:182.7575218770712,y:-42.652264875397925},{type:"inventor",id:"7608761-4",name:"Jennifer Rinehart",numPatents:9,x:14.603033717644877,y:258.01693807943076},{type:"inventor",id:"7380696-3",name:"Jerry R. Morgan",numPatents:1,x:240.77923512539172,y:.756185655222625},{type:"inventor",id:"5715450-1",name:"Jesse Ambrose",numPatents:19,x:36.180423514508206,y:-271.11815189166657},{type:"inventor",id:"6711565-3",name:"Jian-Jung Ying",numPatents:15,x:-52.40594362916027,y:-298.6209852446577},{type:"inventor",id:"6516227-4",name:"Joey Chen",numPatents:50,x:-154.54667136290993,y:208.95072280734337},{type:"inventor",id:"6233617-2",name:"John Coker",numPatents:29,x:-107.81893815632144,y:-170.9074676231656},{type:"inventor",id:"4561444-1",name:"John H. Livingston",numPatents:31,x:-152.85300444583956,y:85.10940008964967},{type:"inventor",id:"5237178-2",name:"John J. Mastrototaro",numPatents:77,x:-205.49739590958532,y:50.31477970484868},{type:"inventor",id:"6424847-3",name:"John J. Shin",numPatents:6,x:-185.37446355710384,y:-3.2872027106235895},{type:"inventor",id:"5713911-2",name:"John W. Beardsley",numPatents:110,x:-33.81475988638202,y:262.88267211113725},{type:"inventor",id:"6690387-1",name:"John Zimmerman",numPatents:16,x:-103.86436428501,y:287.0324152077035},{type:"inventor",id:"6295530-2",name:"Jonathan Bradshaw",numPatents:7,x:-211.8714260910478,y:-224.50904787445123},{type:"inventor",id:"6964363-2",name:"Joseph Charles Heuil",numPatents:1,x:157.89490960975428,y:-126.44781831975064},{type:"inventor",id:"6804330-4",name:"Joseph Harb",numPatents:16,x:61.12664822458566,y:-268.1908816611899},{type:"inventor",id:"7154477-2",name:"Joshua A. Strickon",numPatents:31,x:143.607727645999,y:-281.669369261142},{type:"inventor",id:"6665648-1",name:"Karen Brodersen",numPatents:2,x:-52.887761617406746,y:-135.25324601212748},{type:"inventor",id:"6914182-1",name:"Katsutoshi Takeda",numPatents:12,x:-301.89433487691184,y:-70.43324650808906},{type:"inventor",id:"5925224-1",name:"Kazuki Kobayashi",numPatents:22,x:-41.900676918096416,y:7.301358596622912},{type:"inventor",id:"7061014-4",name:"Kazushige Ueda",numPatents:8,x:-37.66496363448323,y:59.62475565738286},{type:"inventor",id:"4356455-3",name:"Keishi Saito",numPatents:60,x:10.219140633910085,y:114.60611008460567},{type:"inventor",id:"6175752-9",name:"Keith A. Friedman",numPatents:56,x:-72.76478399432692,y:157.96280246014734},{type:"inventor",id:"D263987-1",name:"Keith L. Milliman",numPatents:148,x:285.27055146309806,y:-4.161607699952845},{type:"inventor",id:"D304234-2",name:"Keith Ratcliff",numPatents:76,x:298.25438655644587,y:-62.037733990730615},{type:"inventor",id:"6838397-3",name:"Kengo Akimoto",numPatents:301,x:233.30591089284124,y:118.12865814744283},{type:"inventor",id:"4072236-1",name:"Kenji Nomura",numPatents:72,x:-18.491573620748454,y:164.3319743882085},{type:"inventor",id:"4890611-3",name:"Kenneth H. Mollenauer",numPatents:139,x:171.12139099125284,y:149.8278932183207},{type:"inventor",id:"5409498-4",name:"Kenneth S. Wales",numPatents:34,x:151.61506500486365,y:-68.1715301096975},{type:"inventor",id:"6558351-2",name:"Kerstin Rebrin",numPatents:8,x:-213.99832648219893,y:-18.21020350970695},{type:"inventor",id:"7083075-3",name:"Kevin R. Doll",numPatents:33,x:195.17161861296412,y:21.82757190718286},{type:"inventor",id:"6826745-3",name:"Kevin R. Nix",numPatents:5,x:-113.52318349679786,y:-186.65850464097767},{type:"inventor",id:"4682596-2",name:"Kevin W. Smith",numPatents:245,x:142.01517052619224,y:35.31713032040018},{type:"inventor",id:"6336137-1",name:"King-Hwa Lee",numPatents:7,x:29.136416821389545,y:-152.83892279100135},{type:"inventor",id:"6553563-3",name:"Klaus W. Strobel",numPatents:3,x:18.502269802896187,y:-277.84229119164485},{type:"inventor",id:"5715675-2",name:"Korey Kline",numPatents:67,x:107.3928086404656,y:.12497168391208881},{type:"inventor",id:"6718361-2",name:"Krishna Mangiapudi",numPatents:2,x:-221.42351181095376,y:210.68462107621696},{type:"inventor",id:"6577726-1",name:"Kuang-Yang Huang",numPatents:7,x:-110.90293474419634,y:-144.1107477274019},{type:"inventor",id:"7159750-5",name:"Lee Ann Olson",numPatents:102,x:-12.291045729816593,y:284.322824027671},{type:"inventor",id:"6718361-4",name:"Leroy R. Karge",numPatents:6,x:-246.56898495901828,y:176.8643082489128},{type:"inventor",id:"6551276-4",name:"Luis J. Malave",numPatents:25,x:-150.46955158412106,y:15.466681355594043},{type:"inventor",id:"6048110-3",name:"Lyn M. Irving",numPatents:50,x:185.89368255203638,y:211.73497316837444},{type:"inventor",id:"6718361-3",name:"Lynne M. Murach",numPatents:6,x:-184.59731612599379,y:168.95459030128404},{type:"inventor",id:"5948789-1",name:"Magnus Larsson",numPatents:32,x:282.3498743492304,y:-105.85390576839409},{type:"inventor",id:"6829655-2",name:"Magnus Vejlstrup",numPatents:5,x:84.57683420505849,y:-211.60546591129122},{type:"inventor",id:"6711565-4",name:"Marc Caltabiano",numPatents:18,x:-21.572503547031765,y:-303.25001204800884},{type:"inventor",id:"7078503-3",name:"Marianne Malven",numPatents:24,x:39.36478912183982,y:204.50761088237962},{type:"inventor",id:"6223205-2",name:"Mark E. Crovella",numPatents:11,x:-239.130673392076,y:159.5386268120703},{type:"inventor",id:"6621834-2",name:"Mark Randle Boyns",numPatents:9,x:92.9515991340844,y:139.72491699418129},{type:"inventor",id:"5534132-1",name:"Mark S. Vreeke",numPatents:99,x:-126.17414240825202,y:182.14886801748534},{type:"inventor",id:"4892244-4",name:"Mark S. Zeiner",numPatents:112,x:87.86551233944792,y:-93.61435949906866},{type:"inventor",id:"6829655-6",name:"Martin Susser",numPatents:8,x:86.5166449716311,y:-176.3680568624842},{type:"inventor",id:"4486720-1",name:"Masahiro Hirano",numPatents:64,x:-26.473941021328834,y:50.583877501287475},{type:"inventor",id:"5622653-1",name:"Masahiro Orita",numPatents:13,x:-43.311943512469504,y:88.05852401092362},{type:"inventor",id:"6080998-3",name:"Masao Isomura",numPatents:3,x:-277.1673968733419,y:-69.16313590358769},{type:"inventor",id:"4902671-3",name:"Masashi Kawasaki",numPatents:44,x:25.499834981751505,y:12.458835962907768},{type:"inventor",id:"5117838-1",name:"Matthew A. Palmer",numPatents:213,x:111.84440719512871,y:17.55352243854731},{type:"inventor",id:"6577726-2",name:"Matthew S. Malden",numPatents:15,x:-89.77281715762112,y:-212.5200099480745},{type:"inventor",id:"6665655-2",name:"Michael A. Myer",numPatents:3,x:-222.1548984266278,y:-91.88370779987125},{type:"inventor",id:"5632432-4",name:"Michael E. Setser",numPatents:46,x:236.1453486905915,y:-29.533043437416676},{type:"inventor",id:"5306623-3",name:"Michael F. Tomasco",numPatents:89,x:-136.35034022301926,y:166.87376786095362},{type:"inventor",id:"6606744-1",name:"Michael G. Mikurak",numPatents:14,x:143.06107123828787,y:203.68650030864686},{type:"inventor",id:"6264087-1",name:"Michael P. Whitman",numPatents:134,x:88.31330790988822,y:237.10476528058422},{type:"inventor",id:"6665648-2",name:"Michael Tsunghsi Yu",numPatents:2,x:7.3045597411881005,y:-101.62893346986323},{type:"inventor",id:"6081518-1",name:"Michel K. Bowman-Amuah",numPatents:56,x:153.55805703292674,y:278.7584163590403},{type:"inventor",id:"4224725-1",name:"Michio Kadota",numPatents:173,x:70.25249110067011,y:260.17630684500784},{type:"inventor",id:"6850949-2",name:"Mike Myer",numPatents:1,x:200.98410027290677,y:-165.1800994159187},{type:"inventor",id:"5261037-2",name:"Min Zhu",numPatents:119,x:187.21787990519445,y:119.18052322241124},{type:"inventor",id:"6732100-4",name:"Mingte J. Chen",numPatents:1,x:-74.89396821135054,y:-144.48151011840986},{type:"inventor",id:"5176502-3",name:"Mitchell J. Palmer",numPatents:40,x:315.79092621337537,y:-58.79666939419763},{type:"inventor",id:"7385224-3",name:"Motohiko Yoshida",numPatents:5,x:-231.18768324847443,y:-116.45107756791272},{type:"inventor",id:"5918159-1",name:"Mundi Fomukong",numPatents:12,x:-221.62526815353186,y:-201.75317388265475},{type:"inventor",id:"7632985-3",name:"Nancy Taylor",numPatents:5,x:50.015886492956845,y:227.2759540780497},{type:"inventor",id:"7468304-1",name:"Nobuyuki Kaji",numPatents:16,x:41.822376082161696,y:52.514246752854255},{type:"inventor",id:"7205716-5",name:"Norihito Sone",numPatents:19,x:269.115065567314,y:70.01224836249358},{type:"inventor",id:"5358514-3",name:"Paul M. Meadows",numPatents:70,x:-171.2697553163847,y:256.54794390887173},{type:"inventor",id:"6558351-3",name:"Paul V. Goode",numPatents:154,x:-230.16114196390936,y:-13.410314845001913},{type:"inventor",id:"6711565-1",name:"Pavitra Subramaniam",numPatents:20,x:-6.372748347947338,y:-297.9670264909068},{type:"inventor",id:"D423761-3",name:"Peter Hong",numPatents:25,x:-207.02913444458756,y:113.2044477207746},{type:"inventor",id:"6152987-2",name:"Peter Mardilovich",numPatents:110,x:-113.70541462763414,y:-71.63866878448928},{type:"inventor",id:"5873096-1",name:"Peter S. Lim",numPatents:19,x:-41.4971575994779,y:-229.8634738486308},{type:"inventor",id:"6732111-4",name:"Peter Siam Sy Lim III",numPatents:1,x:-119.68776087181291,y:-264.7441153149242},{type:"inventor",id:"6850895-3",name:"Peter Siam Sy Lim, III",numPatents:3,x:-137.51327861868992,y:-253.05015263416013},{type:"inventor",id:"7159750-4",name:"Philip Roy",numPatents:45,x:-55.915331837334584,y:265.4527399859059},{type:"inventor",id:"6103033-7",name:"Phillip John Plante",numPatents:76,x:-89.56172634273938,y:128.49359954020937},{type:"inventor",id:"5978829-1",name:"Pi-Yu Chung",numPatents:15,x:79.03330309768333,y:-166.89620301402695},{type:"inventor",id:"6092083-2",name:"Prashant Chatterjee",numPatents:12,x:-127.98166248978045,y:-226.09590322983067},{type:"inventor",id:"7340411-1",name:"Rachael L. Cook",numPatents:1,x:145.5816434953685,y:-185.9115227848251},{type:"inventor",id:"4872603-1",name:"Ralph Stearns",numPatents:82,x:-17.638261139740077,y:311.87440096016235},{type:"inventor",id:"6836540-6",name:"Randy Hoffman",numPatents:66,x:-96.67915062271523,y:-18.863267642338357},{type:"inventor",id:"4798594-1",name:"Richard A. Hillstead",numPatents:56,x:220.9404304325887,y:155.9212493217171},{type:"inventor",id:"5097122-2",name:"Richard E. Purvis",numPatents:22,x:-231.6221173485312,y:58.532788593406465},{type:"inventor",id:"6268803-3",name:"Richard Gorman",numPatents:10,x:76.71667439228202,y:-247.40756847543366},{type:"inventor",id:"5271543-1",name:"Richard L. Grant",numPatents:22,x:108.37790261638156,y:-109.53429774011205},{type:"inventor",id:"6092083-1",name:"Robert A. Brodersen",numPatents:21,x:-116.78677329380332,y:-211.74312172754898},{type:"inventor",id:"5873096-2",name:"Robert Broderson",numPatents:3,x:32.470564362710334,y:-212.3565037616904},{type:"inventor",id:"5963953-1",name:"Robert Cram",numPatents:3,x:39.731656228036044,y:-159.70117419662853},{type:"inventor",id:"4362387-1",name:"Roy Clark",numPatents:23,x:-143.38065467805583,y:-83.18646932332894},{type:"inventor",id:"5417770-8",name:"Ryo Hayashi",numPatents:71,x:109.56900270181322,y:94.2690776193339},{type:"inventor",id:"6081875-2",name:"Sanjoy Chatterjee",numPatents:2,x:-168.55351719373274,y:-55.00391327710072},{type:"inventor",id:"5416255-1",name:"Scott A. Bergemann",numPatents:106,x:236.9843658437831,y:-154.5385328936314},{type:"inventor",id:"6724399-2",name:"Shankar S. Nathan",numPatents:1,x:8.017651326713803,y:-132.67439205632664},{type:"inventor",id:"6804330-1",name:"Shannon Jones",numPatents:5,x:71.13206981844631,y:-258.49934239941376},{type:"inventor",id:"6887736-4",name:"Shanthi Ganesan",numPatents:4,x:-36.994882107564074,y:176.4435210395316},{type:"inventor",id:"6183589-1",name:"Shin Kim",numPatents:47,x:-287.672664666798,y:45.812611641390674},{type:"inventor",id:"6654032-4",name:"Songxiang Wei",numPatents:7,x:132.3199171044082,y:86.33369201811875},{type:"inventor",id:"6783524-1",name:"Stephen C. Anderson",numPatents:1,x:62.6200720139505,y:302.49618857083027},{type:"inventor",id:"5774357-1",name:"Steven M. Hoffberg",numPatents:106,x:-298.14981578939944,y:88.5680351045039},{type:"inventor",id:"5594169-2",name:"Steven P. Hotelling",numPatents:306,x:178.31356224420756,y:-255.43042507480578},{type:"inventor",id:"6526335-2",name:"Susan M. Treyz",numPatents:15,x:-279.2338471304183,y:139.99257336727945},{type:"inventor",id:"6639246-1",name:"Tatsuya Honda",numPatents:109,x:250.0602077201684,y:66.33401322268637},{type:"inventor",id:"5345639-6",name:"Tatsuya Iwasaki",numPatents:116,x:86.3336134471773,y:157.82593462060743},{type:"inventor",id:"6324568-1",name:"Thanh Diec",numPatents:3,x:-78.03147469125184,y:-272.5886606861718},{type:"inventor",id:"5715450-2",name:"Thomas M. Rothwein",numPatents:13,x:-19.165101013241493,y:-208.1804640840619},{type:"inventor",id:"RE39841-4",name:"Todd Phillip Omaits",numPatents:7,x:129.99306854625007,y:-22.049901615038408},{type:"inventor",id:"6850949-3",name:"Tom Abshire",numPatents:1,x:140.26566902715228,y:-153.3917294843958},{type:"inventor",id:"7061014-6",name:"Toshio Kamiya",numPatents:25,x:9.126271276254377,y:101.82298630556326},{type:"inventor",id:"6718361-1",name:"Vijay R. Basani",numPatents:9,x:-201.38227173205027,y:208.74327049926328},{type:"inventor",id:"6718361-5",name:"Vitaly S. Revsin",numPatents:13,x:-198.70473078024983,y:152.4052211665943},{type:"inventor",id:"6978921-3",name:"William B. Weisenburgh, II",numPatents:152,x:248.24393906293733,y:-90.29342524369324},{type:"inventor",id:"5257971-2",name:"William P. Van Antwerp",numPatents:69,x:-243.520991916779,y:23.417679977911327},{type:"inventor",id:"6829655-1",name:"Xiaofei Huang",numPatents:5,x:89.9887416103856,y:-187.79413998163483},{type:"inventor",id:"5283452-1",name:"Yi-Chi Shih",numPatents:33,x:-323.71359641871163,y:23.908936586494086},{type:"inventor",id:"5901896-1",name:"Yoram Gal",numPatents:76,x:-107.23225510620489,y:124.73541739026112},{type:"inventor",id:"4573472-1",name:"Yoshihiro Ito",numPatents:189,x:118.20250938383892,y:287.9615326434283},{type:"inventor",id:"5855957-1",name:"Zheng Yuan",numPatents:58,x:138.0920695217319,y:124.0644011797693},{type:"assignee",id:"org_Z59aUBGtZ9P5QzdFiKmZ",name:"Ablaise Limited",numPatents:2,x:-190.4821130010742,y:-236.53619698539487},{type:"assignee",id:"org_4zO2Bc08x56XjDq5TeBp",name:"Accenture LLP",numPatents:210,x:172.86602300833957,y:253.70330815416585},{type:"assignee",id:"org_bwq83jbccKqF4jJrPcaR",name:"Advanced Bionics AG",numPatents:633,x:-176.91468472981555,y:233.6338835259619},{type:"assignee",id:"org_IDUbS09ZR0JhJ8jFEptT",name:"Apple Inc.",numPatents:21023,x:151.68246641578867,y:-222.1248748814489},{type:"assignee",id:"org_EhYFPIJEmYQYRoYvsnpy",name:"Canon Kabushiki Kaisha",numPatents:74596,x:49.48223920573296,y:134.09228873115592},{type:"assignee",id:"org_Imeg9W6P1TE6I2QutS4y",name:"Casio Computer Co., Ltd.",numPatents:4521,x:-179.8175934120515,y:-142.71828852921044},{type:"assignee",id:"org_8csMgtgnN0mREZpNP1Ji",name:"Cerebral Vascular Applications, Inc.",numPatents:4,x:268.8004541444387,y:164.52369478315683},{type:"assignee",id:"org_0eTr3XIBjAKpXkC6823r",name:"Cermet, Inc.",numPatents:7,x:-48.40372768955156,y:205.44025883826066},{type:"assignee",id:"org_107WKNPbvDDKrZBlmw8U",name:"Contigo Software, Inc.",numPatents:2,x:299.3174359095953,y:48.03492469800833},{type:"assignee",id:"org_ppElkEtQvFtG6A4754UI",name:"Eastman Kodak Company",numPatents:21539,x:211.37525941352786,y:217.58287786532108},{type:"assignee",id:"org_0jPWM7YqhtXm0lm3fm1Y",name:"EMC Corporation",numPatents:4976,x:-189.70156274838973,y:-110.01559890437628},{type:"assignee",id:"org_Wh2cnOIzKlhzjuqVmOqY",name:"Enecto AB",numPatents:1,x:243.6765412246258,y:-131.2090311866099},{type:"assignee",id:"org_Xu6gXSsltDBZTAhMFBWD",name:"Ethicon Endo-Surger, Inc.",numPatents:3,x:224.71243580316477,y:39.60984252547865},{type:"assignee",id:"org_NfKBB9TWF4As8TSasJ5n",name:"Ethicon Endo-Surgery, Inc.",numPatents:2194,x:171.0743702247664,y:-55.03680709894609},{type:"assignee",id:"org_vS6rcKyc2qN3rFdX0P2K",name:"Hewlett-Packard Development Company, L.P.",numPatents:35118,x:-90.3103968526694,y:-50.0521628929454},{type:"assignee",id:"per_tX2e2yVLgyNgobEpzWKT",name:"Hideo Ohno",numPatents:4,x:-39.53612842704436,y:-20.270273354977252},{type:"assignee",id:"org_MKvbnCcyPudXexUvsSwF",name:"Holden's Foundation Seeds, Inc.",numPatents:83,x:240.0999059851908,y:-206.02637614806125},{type:"assignee",id:"org_fA0azqoBGEzoPoy85Jyv",name:"INTUITIVE SURGICAL OPERATIONS, INC.",numPatents:1202,x:15.378862865447624,y:290.2178222875223},{type:"assignee",id:"org_DttZMvkyvW3fV6oCUMTF",name:"Japan Science and Technology Agency",numPatents:1157,x:13.173450731061086,y:56.48614099577767},{type:"assignee",id:"org_c5vyBzK7iikkU4DjQFHT",name:"Japan Science and Technology Corporation",numPatents:418,x:63.56317058275,y:6.273673519090753},{type:"assignee",id:"org_FvgvGFe8JZ0iYlZ80weF",name:"Koninklijke Philips Electronics N.V.",numPatents:17138,x:-123.24179123790191,y:270.99746548441016},{type:"assignee",id:"org_XcqCjtT8pi8Mk3UjQlDt",name:"LG Electronics Inc.",numPatents:32725,x:-277.3460229984558,y:7.13369822254301},{type:"assignee",id:"per_DIjUTM7lHhDsAz2u8jiO",name:"Masashi Kawasaki",numPatents:3,x:19.895436596662908,y:-10.717178250900918},{type:"assignee",id:"org_GVMlLVbwCDSiqP9Og8Tn",name:"Medtronic MiniMed, Inc.",numPatents:800,x:-183.74023419057417,y:37.687218769839085},{type:"assignee",id:"org_Qw8EsrN0M52nVQUM6vsV",name:"Monsanto Technology LLC",numPatents:8689,x:19.763901488352673,y:196.62236862589774},{type:"assignee",id:"org_j5U5IEa1FIbgtr7iNsQM",name:"Murata Manufacturing Co., Ltd.",numPatents:7342,x:87.64878197108817,y:291.1023195872352},{type:"assignee",id:"org_1p4FWEoItjyKbwTpCJol",name:"Network Appliance, Inc.",numPatents:530,x:-222.2920372118052,y:149.08372155272062},{type:"assignee",id:"org_ATOWHd4GGaoh14zutXq7",name:"Power Medical Interventions, Inc.",numPatents:30,x:108.88110399749706,y:186.8533878262659},{type:"assignee",id:"org_k8V7c5gnmC7SVmup5Vu7",name:"Raindance Communications, Inc.",numPatents:3,x:65.15717694264417,y:83.41943637820401},{type:"assignee",id:"org_242hJegwfQCeP9hsfwpW",name:"Right Now Technologies, Inc.",numPatents:2,x:186.81965281602268,y:-183.4017025145853},{type:"assignee",id:"org_6r9t7ZA6YT031Od4kMPg",name:"Rightnow Technologies, Inc.",numPatents:10,x:-231.73615880122236,y:-74.09916970934252},{type:"assignee",id:"org_2IF97zVymSuraSnUAXmq",name:"Sanyo Electric Co., Ltd.",numPatents:8383,x:-283.9028253608946,y:-127.87253381969171},{type:"assignee",id:"org_plZbLxiysESbaI9pOeym",name:"SEMICONDUCTOR ENERGY LABORATORY CO., LTD.",numPatents:13885,x:256.2283987637905,y:124.46141696066522},{type:"assignee",id:"org_CMWcoCJWPOfisLWrKvyd",name:"Sharp Kabushiki Kaisha",numPatents:22540,x:4.095560406482671,y:-32.13618482579938},{type:"assignee",id:"org_83NNgJrP5lkIN876kNeG",name:"Siebel Systems, Inc.",numPatents:298,x:-33.91994752314842,y:-212.5994288988811},{type:"assignee",id:"org_J8VnAzFqEjWgxq4ev71z",name:"Starion Instruments Corporation",numPatents:20,x:178.98416654116346,y:169.54821211190276},{type:"assignee",id:"org_m2tNPJkA2g1AWOc7uzS1",name:"TheraSense, Inc.",numPatents:53,x:-125.9145998460851,y:132.41739054516117},{type:"assignee",id:"org_JjrM6UmeOY0Q5MmoNiP8",name:"TOKYO INSTITUTE OF TECHNOLOGY",numPatents:395,x:18.61413008116646,y:165.21253699554214},{type:"assignee",id:"org_ewVsCutpRzD9pT07kBoE",name:"Tyco Healtcare Group LP",numPatents:5,x:-67.25430526742107,y:308.6149282041579},{type:"assignee",id:"org_5wNNrJ4zFQ5KQ8OWnzRC",name:"United States Surtical Corporation",numPatents:1,x:282.781009224431,y:-52.981590115087144},{type:"assignee",id:"org_3vI2Z5kC1SaSlbUBoOBT",name:"WebEx Communications, Inc.",numPatents:22,x:187.36763951128714,y:101.20849847080181}],links:[{source:"6516227",target:"5358514-3"},{source:"6516227",target:"5755737-3"},{source:"6516227",target:"5948006-1"},{source:"6516227",target:"6516227-4"},{source:"6516227",target:"org_bwq83jbccKqF4jJrPcaR"},{source:"6535909",target:"6535909-1"},{source:"6535909",target:"org_107WKNPbvDDKrZBlmw8U"},{source:"6549908",target:"6393605-1"},{source:"6549908",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6553563",target:"5715450-1"},{source:"6553563",target:"5715450-2"},{source:"6553563",target:"6553563-3"},{source:"6553563",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6558320",target:"4809697-1"},{source:"6558320",target:"4863425-2"},{source:"6558320",target:"5097122-2"},{source:"6558320",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"6558351",target:"5097122-2"},{source:"6558351",target:"5237178-2"},{source:"6558351",target:"5257971-2"},{source:"6558351",target:"6424847-3"},{source:"6558351",target:"6558351-1"},{source:"6558351",target:"6558351-2"},{source:"6558351",target:"6558351-3"},{source:"6558351",target:"6558351-8"},{source:"6558351",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"6560461",target:"5918159-1"},{source:"6560461",target:"5918159-2"},{source:"6563174",target:"4253061-3"},{source:"6563174",target:"4902671-3"},{source:"6563174",target:"4997262-1"},{source:"6563174",target:"5925224-1"},{source:"6563174",target:"org_CMWcoCJWPOfisLWrKvyd"},{source:"6563174",target:"per_DIjUTM7lHhDsAz2u8jiO"},{source:"6563174",target:"per_tX2e2yVLgyNgobEpzWKT"},{source:"6565509",target:"4082602-2"},{source:"6565509",target:"5041086-4"},{source:"6565509",target:"5306623-3"},{source:"6565509",target:"5533238-1"},{source:"6565509",target:"5534132-1"},{source:"6565509",target:"5616532-3"},{source:"6565509",target:"5722997-2"},{source:"6565509",target:"5901896-1"},{source:"6565509",target:"6103033-7"},{source:"6565509",target:"6175752-9"},{source:"6565509",target:"org_m2tNPJkA2g1AWOc7uzS1"},{source:"6571282",target:"6081518-1"},{source:"6571282",target:"org_4zO2Bc08x56XjDq5TeBp"},{source:"6574635",target:"5715450-1"},{source:"6574635",target:"5715450-2"},{source:"6574635",target:"5963953-3"},{source:"6574635",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6577726",target:"6577726-1"},{source:"6577726",target:"6577726-2"},{source:"6577726",target:"6577726-3"},{source:"6577726",target:"6577726-4"},{source:"6577726",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6587835",target:"6433921-2"},{source:"6587835",target:"6526335-2"},{source:"6601087",target:"5261037-2"},{source:"6601087",target:"6601087-2"},{source:"6601087",target:"org_3vI2Z5kC1SaSlbUBoOBT"},{source:"6602252",target:"4890611-3"},{source:"6602252",target:"org_J8VnAzFqEjWgxq4ev71z"},{source:"6604117",target:"5873096-1"},{source:"6604117",target:"5873096-2"},{source:"6604117",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6604128",target:"6324568-1"},{source:"6604128",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6606744",target:"6606744-1"},{source:"6606744",target:"org_4zO2Bc08x56XjDq5TeBp"},{source:"6609150",target:"5963953-1"},{source:"6609150",target:"6336137-1"},{source:"6609150",target:"6336137-3"},{source:"6609150",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6621834",target:"5944791-1"},{source:"6621834",target:"6621834-2"},{source:"6621834",target:"org_k8V7c5gnmC7SVmup5Vu7"},{source:"6641533",target:"4809697-1"},{source:"6641533",target:"4863425-2"},{source:"6641533",target:"5097122-2"},{source:"6641533",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"6644532",target:"4127227-1"},{source:"6644532",target:"4283024-1"},{source:"6644532",target:"5176502-3"},{source:"6644532",target:"D263987-1"},{source:"6644532",target:"D304234-2"},{source:"6644532",target:"RE28932-2"},{source:"6644532",target:"org_5wNNrJ4zFQ5KQ8OWnzRC"},{source:"6654032",target:"5261037-2"},{source:"6654032",target:"5855957-1"},{source:"6654032",target:"6601087-2"},{source:"6654032",target:"6654032-4"},{source:"6654032",target:"org_3vI2Z5kC1SaSlbUBoOBT"},{source:"6656193",target:"4892244-4"},{source:"6656193",target:"5271543-1"},{source:"6656193",target:"5329655-1"},{source:"6656193",target:"5409498-4"},{source:"6656193",target:"5707369-2"},{source:"6656193",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6665648",target:"6665648-1"},{source:"6665648",target:"6665648-2"},{source:"6665648",target:"6665648-3"},{source:"6665648",target:"6665648-4"},{source:"6665648",target:"6665648-5"},{source:"6665648",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6665655",target:"6434550-1"},{source:"6665655",target:"6665655-2"},{source:"6665655",target:"org_6r9t7ZA6YT031Od4kMPg"},{source:"6684438",target:"5873096-1"},{source:"6684438",target:"6092083-1"},{source:"6684438",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6690387",target:"6281898-2"},{source:"6690387",target:"6690387-1"},{source:"6690387",target:"org_FvgvGFe8JZ0iYlZ80weF"},{source:"6693232",target:"5416255-1"},{source:"6693232",target:"org_MKvbnCcyPudXexUvsSwF"},{source:"6698643",target:"6264087-1"},{source:"6698643",target:"org_ATOWHd4GGaoh14zutXq7"},{source:"6711565",target:"6711565-1"},{source:"6711565",target:"6711565-2"},{source:"6711565",target:"6711565-3"},{source:"6711565",target:"6711565-4"},{source:"6711565",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6716233",target:"6264087-1"},{source:"6716233",target:"org_ATOWHd4GGaoh14zutXq7"},{source:"6718361",target:"6223205-2"},{source:"6718361",target:"6370584-1"},{source:"6718361",target:"6718361-1"},{source:"6718361",target:"6718361-2"},{source:"6718361",target:"6718361-3"},{source:"6718361",target:"6718361-4"},{source:"6718361",target:"6718361-5"},{source:"6718361",target:"6718361-8"},{source:"6718361",target:"org_1p4FWEoItjyKbwTpCJol"},{source:"6724399",target:"6724399-1"},{source:"6724399",target:"6724399-2"},{source:"6724399",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6727522",target:"4253061-3"},{source:"6727522",target:"4902671-3"},{source:"6727522",target:"org_c5vyBzK7iikkU4DjQFHT"},{source:"6728702",target:"6577726-2"},{source:"6728702",target:"6711565-1"},{source:"6728702",target:"6711565-2"},{source:"6728702",target:"6711565-3"},{source:"6728702",target:"6711565-4"},{source:"6728702",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6728960",target:"6393605-1"},{source:"6728960",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6732095",target:"5243622-2"},{source:"6732095",target:"6732095-1"},{source:"6732095",target:"6732095-2"},{source:"6732095",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6732100",target:"5715450-2"},{source:"6732100",target:"6577726-2"},{source:"6732100",target:"6577726-4"},{source:"6732100",target:"6665648-1"},{source:"6732100",target:"6732100-4"},{source:"6732100",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6732111",target:"4951278-2"},{source:"6732111",target:"6092083-1"},{source:"6732111",target:"6092083-2"},{source:"6732111",target:"6732111-4"},{source:"6732111",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6754681",target:"5873096-1"},{source:"6754681",target:"6092083-1"},{source:"6754681",target:"6092083-2"},{source:"6754681",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6763351",target:"6711565-1"},{source:"6763351",target:"6711565-2"},{source:"6763351",target:"6711565-3"},{source:"6763351",target:"6711565-4"},{source:"6763351",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6763501",target:"5261037-2"},{source:"6763501",target:"5855957-1"},{source:"6763501",target:"6601087-2"},{source:"6763501",target:"6654032-4"},{source:"6763501",target:"org_3vI2Z5kC1SaSlbUBoOBT"},{source:"6768904",target:"6183589-1"},{source:"6768904",target:"org_XcqCjtT8pi8Mk3UjQlDt"},{source:"6782383",target:"6711565-1"},{source:"6782383",target:"6711565-2"},{source:"6782383",target:"6711565-3"},{source:"6782383",target:"6711565-4"},{source:"6782383",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6783524",target:"5859916-3"},{source:"6783524",target:"6783524-1"},{source:"6783524",target:"org_fA0azqoBGEzoPoy85Jyv"},{source:"6786382",target:"6530932-2"},{source:"6786382",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6804330",target:"5715450-1"},{source:"6804330",target:"6268803-3"},{source:"6804330",target:"6804330-1"},{source:"6804330",target:"6804330-4"},{source:"6804330",target:"6804330-5"},{source:"6804330",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6809653",target:"4082097-1"},{source:"6809653",target:"4561444-1"},{source:"6809653",target:"4809697-1"},{source:"6809653",target:"4863425-2"},{source:"6809653",target:"5097122-2"},{source:"6809653",target:"5237178-2"},{source:"6809653",target:"5382232-1"},{source:"6809653",target:"6809653-9"},{source:"6809653",target:"D423761-3"},{source:"6809653",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"6826565",target:"6295530-1"},{source:"6826565",target:"6295530-2"},{source:"6826565",target:"org_Z59aUBGtZ9P5QzdFiKmZ"},{source:"6826582",target:"4362387-1"},{source:"6826582",target:"6081875-2"},{source:"6826582",target:"6826582-2"},{source:"6826582",target:"org_0jPWM7YqhtXm0lm3fm1Y"},{source:"6826745",target:"6233617-2"},{source:"6826745",target:"6577726-2"},{source:"6826745",target:"6826745-3"},{source:"6826745",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6829655",target:"5978829-1"},{source:"6829655",target:"6004276-13"},{source:"6829655",target:"6829655-1"},{source:"6829655",target:"6829655-2"},{source:"6829655",target:"6829655-3"},{source:"6829655",target:"6829655-6"},{source:"6829655",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6830174",target:"4798594-1"},{source:"6830174",target:"5465895-1"},{source:"6830174",target:"org_8csMgtgnN0mREZpNP1Ji"},{source:"6842748",target:"6434550-1"},{source:"6842748",target:"6665655-2"},{source:"6842748",target:"org_6r9t7ZA6YT031Od4kMPg"},{source:"6843403",target:"6264087-1"},{source:"6843403",target:"org_ATOWHd4GGaoh14zutXq7"},{source:"6850252",target:"5774357-1"},{source:"6850895",target:"6092083-1"},{source:"6850895",target:"6092083-2"},{source:"6850895",target:"6577726-2"},{source:"6850895",target:"6850895-3"},{source:"6850895",target:"6850895-5"},{source:"6850895",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6850949",target:"6850949-1"},{source:"6850949",target:"6850949-2"},{source:"6850949",target:"6850949-3"},{source:"6850949",target:"org_242hJegwfQCeP9hsfwpW"},{source:"6852915",target:"5276262-2"},{source:"6852915",target:"org_MKvbnCcyPudXexUvsSwF"},{source:"6905057",target:"5897563-4"},{source:"6905057",target:"6905057-2"},{source:"6905057",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6959852",target:"5632432-4"},{source:"6959852",target:"6905057-2"},{source:"6959852",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6964363",target:"5409498-4"},{source:"6964363",target:"6964363-2"},{source:"6964363",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6978921",target:"5632432-4"},{source:"6978921",target:"6905057-2"},{source:"6978921",target:"6978921-3"},{source:"6978921",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6981628",target:"5409498-4"},{source:"6981628",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7000818",target:"5632432-4"},{source:"7000818",target:"6905057-2"},{source:"7000818",target:"7000818-3"},{source:"7000818",target:"org_Xu6gXSsltDBZTAhMFBWD"},{source:"7025743",target:"4082097-1"},{source:"7025743",target:"4561444-1"},{source:"7025743",target:"4809697-1"},{source:"7025743",target:"5176644-1"},{source:"7025743",target:"5382232-1"},{source:"7025743",target:"6551276-10"},{source:"7025743",target:"6551276-11"},{source:"7025743",target:"6551276-12"},{source:"7025743",target:"6551276-3"},{source:"7025743",target:"6551276-4"},{source:"7025743",target:"6551276-8"},{source:"7025743",target:"6551276-9"},{source:"7025743",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"7049190",target:"6080998-3"},{source:"7049190",target:"6914182-1"},{source:"7049190",target:"org_2IF97zVymSuraSnUAXmq"},{source:"7055731",target:"5632432-4"},{source:"7055731",target:"6905057-2"},{source:"7055731",target:"6978921-3"},{source:"7055731",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7061014",target:"4486720-1"},{source:"7061014",target:"4703019-2"},{source:"7061014",target:"5272069-6"},{source:"7061014",target:"5622653-1"},{source:"7061014",target:"7061014-4"},{source:"7061014",target:"7061014-6"},{source:"7061014",target:"org_DttZMvkyvW3fV6oCUMTF"},{source:"7064346",target:"4253061-3"},{source:"7064346",target:"4902671-3"},{source:"7064346",target:"org_DttZMvkyvW3fV6oCUMTF"},{source:"7105868",target:"5863326-1"},{source:"7105868",target:"6887736-4"},{source:"7105868",target:"org_0eTr3XIBjAKpXkC6823r"},{source:"7111769",target:"5409498-4"},{source:"7111769",target:"5897563-4"},{source:"7111769",target:"6530932-2"},{source:"7111769",target:"6905057-2"},{source:"7111769",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7147138",target:"6905057-2"},{source:"7147138",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7159750",target:"4872603-1"},{source:"7159750",target:"5713911-1"},{source:"7159750",target:"5713911-2"},{source:"7159750",target:"7159750-4"},{source:"7159750",target:"7159750-5"},{source:"7159750",target:"org_ewVsCutpRzD9pT07kBoE"},{source:"7211825",target:"5081422-1"},{source:"7211825",target:"5283452-1"},{source:"7211825",target:"5703357-3"},{source:"7211825",target:"6593834-2"},{source:"7246734",target:"6905057-2"},{source:"7246734",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7282782",target:"6144679-1"},{source:"7282782",target:"6152987-2"},{source:"7282782",target:"6836540-6"},{source:"7282782",target:"org_vS6rcKyc2qN3rFdX0P2K"},{source:"7297977",target:"6144679-1"},{source:"7297977",target:"6152987-2"},{source:"7297977",target:"6836540-6"},{source:"7297977",target:"org_vS6rcKyc2qN3rFdX0P2K"},{source:"7323356",target:"4486720-1"},{source:"7323356",target:"4703019-2"},{source:"7323356",target:"5272069-6"},{source:"7323356",target:"5622653-1"},{source:"7323356",target:"7061014-4"},{source:"7323356",target:"7323356-5"},{source:"7323356",target:"org_DttZMvkyvW3fV6oCUMTF"},{source:"7340411",target:"7340411-1"},{source:"7380695",target:"5409498-4"},{source:"7380695",target:"5632432-4"},{source:"7380695",target:"6905057-2"},{source:"7380695",target:"7083075-3"},{source:"7380695",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7380696",target:"5632432-4"},{source:"7380696",target:"6905057-2"},{source:"7380696",target:"7083075-3"},{source:"7380696",target:"7380696-3"},{source:"7380696",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7385224",target:"5041200-1"},{source:"7385224",target:"5041200-4"},{source:"7385224",target:"7385224-2"},{source:"7385224",target:"7385224-3"},{source:"7385224",target:"org_Imeg9W6P1TE6I2QutS4y"},{source:"7402506",target:"5512426-1"},{source:"7402506",target:"6048110-3"},{source:"7402506",target:"7402506-2"},{source:"7402506",target:"org_ppElkEtQvFtG6A4754UI"},{source:"7404508",target:"4682596-2"},{source:"7404508",target:"5117838-1"},{source:"7404508",target:"5715675-2"},{source:"7404508",target:"6912839-2"},{source:"7404508",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7411209",target:"5345639-6"},{source:"7411209",target:"5417770-8"},{source:"7411209",target:"7082832-4"},{source:"7411209",target:"org_EhYFPIJEmYQYRoYvsnpy"},{source:"7453065",target:"4072236-1"},{source:"7453065",target:"4356455-3"},{source:"7453065",target:"4703019-2"},{source:"7453065",target:"7061014-6"},{source:"7453065",target:"org_EhYFPIJEmYQYRoYvsnpy"},{source:"7453065",target:"org_JjrM6UmeOY0Q5MmoNiP8"},{source:"7453087",target:"5345639-6"},{source:"7453087",target:"org_EhYFPIJEmYQYRoYvsnpy"},{source:"7462862",target:"6144679-1"},{source:"7462862",target:"6836540-6"},{source:"7462862",target:"org_vS6rcKyc2qN3rFdX0P2K"},{source:"7464846",target:"4403687-2"},{source:"7464846",target:"5897563-4"},{source:"7464846",target:"6905057-2"},{source:"7464846",target:"7083075-3"},{source:"7464846",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7468304",target:"6863363-1"},{source:"7468304",target:"7468304-1"},{source:"7468304",target:"org_EhYFPIJEmYQYRoYvsnpy"},{source:"7501293",target:"4224725-1"},{source:"7501293",target:"4573472-1"},{source:"7501293",target:"org_j5U5IEa1FIbgtr7iNsQM"},{source:"7506791",target:"4403687-2"},{source:"7506791",target:"4972224-1"},{source:"7506791",target:"6905057-2"},{source:"7506791",target:"RE39841-4"},{source:"7506791",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7620655",target:"5948789-1"},{source:"7620655",target:"7620655-2"},{source:"7620655",target:"org_Wh2cnOIzKlhzjuqVmOqY"},{source:"7632985",target:"7078503-3"},{source:"7632985",target:"7608761-4"},{source:"7632985",target:"7632985-3"},{source:"7632985",target:"7632985-4"},{source:"7632985",target:"org_Qw8EsrN0M52nVQUM6vsV"},{source:"7663607",target:"5594169-2"},{source:"7663607",target:"6658577-1"},{source:"7663607",target:"7154477-2"},{source:"7663607",target:"org_IDUbS09ZR0JhJ8jFEptT"},{source:"7674650",target:"6639246-1"},{source:"7674650",target:"6838397-3"},{source:"7674650",target:"7205716-5"},{source:"7674650",target:"org_plZbLxiysESbaI9pOeym"},{source:"7732819",target:"6639246-1"},{source:"7732819",target:"6838397-3"},{source:"7732819",target:"7205716-5"},{source:"7732819",target:"org_plZbLxiysESbaI9pOeym"},{source:"8053184",target:"7078503-3"},{source:"8053184",target:"7608761-4"},{source:"8053184",target:"7632985-3"},{source:"8053184",target:"7632985-4"},{source:"8053184",target:"org_Qw8EsrN0M52nVQUM6vsV"}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;const n=r(15),i=r(16),o=r(17),a=r(18),s=r(0);t.Renderer=class{constructor(e){this.modifiedElementsCount=0,this.shouldLazyUpdate=!1;const{canvas:t,width:r,height:s,backgroundColor:u,nodeLimit:l,linkLimit:c,getAllNodes:p,getAllLinks:h}=e;try{this.gl=t.getContext("webgl2")}catch(e){throw new Error("NetV requires WebGL2 supported by your browser")}this.backgroundColor=u,this.width=r,this.height=s,this.pixelRatio=window.devicePixelRatio||1,this.getAllNodes=p,this.getAllLinks=h,this.initIdTexture(),this.nodeManager=new o.RenderNodeManager(this.gl,{width:r,height:s,limit:l},n,this.idTexture),this.linkManager=new a.RenderLinkManager(this.gl,{width:r,height:s,limit:c},i,this.idTexture)}dispose(){const e=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS);for(let t=0;t<e;++t)this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.bindTexture(this.gl.TEXTURE_CUBE_MAP,null);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,null),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.getExtension("WEBGL_lose_context").loseContext()}setBackgroundColor(e){this.backgroundColor=e}clearData(){this.nodeManager.clearData(),this.linkManager.clearData()}addNodes(e){this.nodeManager.addData(e)}addLinks(e){this.linkManager.addData(e)}setTransform(e){this.nodeManager.setTransform(e),this.linkManager.setTransform(e)}draw(){this.shouldLazyUpdate&&(this.nodeManager.refreshPosition(this.getAllNodes()),this.linkManager.refreshPosition(this.getAllLinks()),this.shouldLazyUpdate=!1,this.modifiedElementsCount=0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.idTexture),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.linkManager.draw(),this.nodeManager.draw()}getIdByPosition(e){const t=this.readIdTexture(e);if(t>=0){if(t%2==0){return this.nodeManager.getElementByRenderId(t).id()}{const e=this.linkManager.getElementByRenderId(t).sourceTarget();return[e.source.id(),e.target.id()]}}}readIdTexture(e){const t=this.pixelRatio;this.gl.bindFramebuffer(this.gl.READ_FRAMEBUFFER,this.idTexture);const r=new Uint8Array([255,255,255,255]);this.gl.readPixels(e.x*t,e.y*t,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r);return s.decodeRenderId(r)}increaseModifiedElementsCountBy(e){this.modifiedElementsCount+=e,this.modifiedElementsCount>100&&(this.shouldLazyUpdate=!0)}initIdTexture(){const e=this.gl,t=this.pixelRatio,r=this.width*t,n=this.height*t,i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i);const o=e.createTexture();if(e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,n,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,o,0),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer generate failed");e.bindFramebuffer(e.FRAMEBUFFER,null),this.idTexture=i}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.idFragment=t.fragment=t.idVertex=t.vertex=void 0;const n=r(0),i=new n.Shader;t.vertex=i,i.inputs={inVertexPos:"vec3",in_shape:"float",in_position:"vec2",in_offset:"vec2",in_size:"vec2",in_innerSize:"vec2",in_rotate:"float",in_r:"float",in_vertexAlpha:"vec2",in_vertexBeta:"vec2",in_vertexGamma:"vec2",in_fill:"vec4",in_strokeWidth:"float",in_strokeColor:"vec4"},i.outputs={position:"vec2",shape:"float",size:"vec2",innerSize:"vec2",rotate:"float",r:"float",vertexAlpha:"vec2",vertexBeta:"vec2",vertexGamma:"vec2",fill:"vec4",strokeWidth:"float",strokeColor:"vec4"},i.uniforms={projection:"mat3",scale:"vec2",translate:"vec2",viewport:"vec2",pixelRatio:"float"},i.methods=[["vec2 calculate_inner_point (vec2 p1, vec2 p2, vec2 p3) {","    float inner_p1 = distance(p2, p3);","    float inner_p2 = distance(p1, p3);","    float inner_p3 = distance(p1, p2);","    vec2 inner = (p1 * inner_p1 + p2 * inner_p2 + p3 * inner_p3) / (inner_p1 + inner_p2 + inner_p3);","    return inner;","}"],["float distance2line (vec2 point, vec2 line_begin, vec2 line_end) {","   vec3 cross_product = cross(vec3(point - line_begin, 0), vec3(line_end - line_begin, 0));","   float area = length(cross_product);","   return area / length(line_begin - line_end);","}"],["float calculate_stroke_scale (vec2 p1, vec2 p2, vec2 p3) {","   vec2 inner = calculate_inner_point(p1, p2, p3);","   float radius = distance2line(inner, p1, p2);","   float stroke_scale = strokeWidth / 2.0 / radius;","   return stroke_scale;","}"]],i.main=["void main(void) {","   r = in_r;","   size = in_size;","   float width = size.x;","   float height = size.y;","   innerSize = in_innerSize;","   shape = in_shape;","   fill = in_fill;","   strokeColor = in_strokeColor;","   strokeWidth = in_strokeWidth;","   rotate = in_rotate;","   position = scale * (in_position + in_offset) + translate;","   vertexAlpha = in_vertexAlpha;","   vertexBeta = in_vertexBeta;","   vertexGamma = in_vertexGamma;","   mat3 scale_mat = mat3(","       1, 0, 0,","       0, 1, 0,","       0, 0, 1","   );","   mat3 rotate_mat = mat3(","       cos(rotate), sin(rotate), 0,","       -sin(rotate), cos(rotate), 0,","       0, 0, 1","   );","   mat3 translate_mat = mat3(","       1, 0, 0,","       0, 1, 0,","       position.x, position.y, 1","   );","   if (shape == 0.0) {","       float size = (r + strokeWidth / 2.) * 2. * 1.5;","       scale_mat = mat3(","           size, 0, 0,","           0, size, 0,","           0, 0, 1","           );","   } else if (shape == 1.0 || shape == 3.0) {","       scale_mat = mat3(","           width + strokeWidth, 0, 0,","           0, height + strokeWidth, 0,","           0, 0, 1","       );","   } else if (shape == 2.0) {","       vec2 inner = calculate_inner_point(vertexAlpha, vertexBeta, vertexGamma);","       float stroke_scale = calculate_stroke_scale(vertexAlpha, vertexBeta, vertexGamma);","       vec2 outer_vertexAlpha = (vertexAlpha - inner) * (1.0 + stroke_scale) + inner;","       vec2 outer_vertexBeta = (vertexBeta - inner) * (1.0 + stroke_scale) + inner;","       vec2 outer_vertexGamma = (vertexGamma - inner) * (1.0 + stroke_scale) + inner;","       width = 2.0 * max(abs(max(max(outer_vertexAlpha.x, outer_vertexBeta.x), outer_vertexGamma.x)), abs(min(min(outer_vertexAlpha.x, outer_vertexBeta.x), outer_vertexGamma.x)));","       height = 2.0 * max(abs(max(max(outer_vertexAlpha.y, outer_vertexBeta.y), outer_vertexGamma.y)), abs(min(min(outer_vertexAlpha.y, outer_vertexBeta.y), outer_vertexGamma.y)));","       scale_mat = mat3(","           width, 0, 0,","           0, height, 0,","           0, 0, 1","       );","   }","   mat3 transform = translate_mat * rotate_mat * scale_mat;","   gl_Position = vec4(projection * transform * inVertexPos, 1.);","}"];const o=i.copy();t.idVertex=o,o.inputs.in_id="vec4",o.outputs.id="vec4",o.main.splice(1,0,"id = in_id;");const a=new n.Shader;t.fragment=a,a.inputs={...i.outputs},a.outputs={fragmentColor:"vec4"},a.uniforms={viewport:"vec2",pixelRatio:"float"},a.methods=[i.methods[0],i.methods[1],i.methods[2],["float sign (vec2 p1, vec2 p2, vec2 p3) {","    return (p1.x - p3.x) * (p2.y - p3.y) - (p2.x - p3.x) * (p1.y - p3.y);","}"],["float inTriangle() {","    mat2 rotate_mat = mat2(","        cos(rotate), sin(rotate),","        -sin(rotate), cos(rotate)","    );","    vec2 inner = calculate_inner_point(vertexAlpha, vertexBeta, vertexGamma);","    float stroke_scale = calculate_stroke_scale(vertexAlpha, vertexBeta, vertexGamma);","    vec2 flip_pos = vec2(position.x, viewport.y - position.y);","    vec2 rotate_related_FragCoord = rotate_mat * (gl_FragCoord.xy / pixelRatio - flip_pos);","    vec2 inner_vertexAlpha = (vertexAlpha - inner) * (1.0 - stroke_scale) + inner;","    vec2 inner_vertexBeta = (vertexBeta - inner) * (1.0 - stroke_scale) + inner;","    vec2 inner_vertexGamma = (vertexGamma - inner) * (1.0 - stroke_scale) + inner;","    vec2 flip_vertexAlpha = vec2(inner_vertexAlpha.x, - inner_vertexAlpha.y);","    vec2 flip_vertexBeta = vec2(inner_vertexBeta.x, - inner_vertexBeta.y);","    vec2 flip_vertexGamma = vec2(inner_vertexGamma.x, - inner_vertexGamma.y);","    float d1 = sign(rotate_related_FragCoord, flip_vertexAlpha, flip_vertexBeta);","    float d2 = sign(rotate_related_FragCoord, flip_vertexBeta, flip_vertexGamma);","    float d3 = sign(rotate_related_FragCoord, flip_vertexGamma, flip_vertexAlpha);","    bool has_neg = (d1 < 0.0) || (d2 < 0.0) || (d3 < 0.0);","    bool has_pos = (d1 > 0.0) || (d2 > 0.0) || (d3 > 0.0);","    if (!(has_neg && has_pos)) {","        return 1.0;","    } else {","        return 0.0;","    }","}"],["float inTriangleBorder() {","    mat2 rotate_mat = mat2(","        cos(rotate), sin(rotate),","        -sin(rotate), cos(rotate)","    );","    vec2 inner = calculate_inner_point(vertexAlpha, vertexBeta, vertexGamma);","    float stroke_scale = calculate_stroke_scale(vertexAlpha, vertexBeta, vertexGamma);","    vec2 outer_vertexAlpha = (vertexAlpha - inner) * (1.0 + stroke_scale) + inner;","    vec2 outer_vertexBeta = (vertexBeta - inner) * (1.0 + stroke_scale) + inner;","    vec2 outer_vertexGamma = (vertexGamma - inner) * (1.0 + stroke_scale) + inner;","    vec2 flip_pos = vec2(position.x, viewport.y - position.y);","    vec2 rotate_related_FragCoord = rotate_mat * (gl_FragCoord.xy / pixelRatio - flip_pos);","    vec2 flip_vertexAlpha = vec2(outer_vertexAlpha.x, - outer_vertexAlpha.y);","    vec2 flip_vertexBeta = vec2(outer_vertexBeta.x, - outer_vertexBeta.y);","    vec2 flip_vertexGamma =vec2(outer_vertexGamma.x, - outer_vertexGamma.y);","","    float d1 = sign(rotate_related_FragCoord, flip_vertexAlpha, flip_vertexBeta);","    float d2 = sign(rotate_related_FragCoord, flip_vertexBeta, flip_vertexGamma);","    float d3 = sign(rotate_related_FragCoord, flip_vertexGamma, flip_vertexAlpha);","","    bool has_neg = (d1 <= 0.0) || (d2 <= 0.0) || (d3 <= 0.0);","    bool has_pos = (d1 >= 0.0) || (d2 >= 0.0) || (d3 >= 0.0);","","    bool inTriangle = inTriangle() > 0.5;","    bool inTriangleBorder = !(has_neg && has_pos);","","    if (!inTriangle && inTriangleBorder) {","        return 1.0;","    } else {","        return 0.0;","    }","}"],["float inRect() {","    float width = size.x;","    float height = size.y;","    vec2 flip_pos = position;","    flip_pos.y = viewport.y - position.y;","    mat2 rotate_mat = mat2(","        cos(rotate), sin(rotate),","        -sin(rotate), cos(rotate)","    );","    vec2 rotate_related_FragCoord = rotate_mat * (gl_FragCoord.xy / pixelRatio - flip_pos);","    float x_in = step(rotate_related_FragCoord.x, width / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.x, - width / 2.0 + strokeWidth / 2.0));","    float y_in = step(rotate_related_FragCoord.y, height / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.y, - height / 2.0 + strokeWidth / 2.0));","    return x_in * y_in;","}"],["float inRectBorder() {","    float width = size.x;","    float height = size.y;","    vec2 flip_pos = position;","    flip_pos.y = viewport.y - position.y;","    mat2 rotate_mat = mat2(","        cos(rotate), sin(rotate),","        -sin(rotate), cos(rotate)","    );","    vec2 rotate_related_FragCoord = rotate_mat * (gl_FragCoord.xy / pixelRatio - flip_pos);","    float x_in_outer = step(rotate_related_FragCoord.x, width / 2.0 + strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.x, - width / 2.0 - strokeWidth / 2.0));","    float y_in_outer = step(rotate_related_FragCoord.y, height / 2.0 + strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.y, - height / 2.0 - strokeWidth / 2.0));","    float x_in_inner = step(rotate_related_FragCoord.x, width / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.x, - width / 2.0 + strokeWidth / 2.0));","    float y_in_inner = step(rotate_related_FragCoord.y, height / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.y, - height / 2.0 + strokeWidth / 2.0));","","    return x_in_outer * y_in_outer * (1.0 - x_in_inner * y_in_inner);","}"],["float inCross() {","    vec2 flip_pos = position;","    flip_pos.y = viewport.y - position.y;","    mat2 rotate_mat = mat2(","        cos(rotate), sin(rotate),","        -sin(rotate), cos(rotate)","    );","    vec2 rotate_related_FragCoord = rotate_mat * (gl_FragCoord.xy / pixelRatio - flip_pos);","    float innerWidth = innerSize.x;","    float innerHeight = innerSize.y;","    float width = size.x;","    float height = size.y;","    float x_in1 = step(rotate_related_FragCoord.x, width / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.x, - width / 2.0 + strokeWidth / 2.0));","    float y_in1 = step(rotate_related_FragCoord.y, innerHeight / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.y, - innerHeight / 2.0 + strokeWidth / 2.0));","    float x_in2 = step(rotate_related_FragCoord.x, innerWidth / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.x, - innerWidth / 2.0 + strokeWidth / 2.0));","    float y_in2 = step(rotate_related_FragCoord.y, height / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.y, - height / 2.0 + strokeWidth / 2.0));","    return min(1., x_in1 * y_in1 + x_in2 * y_in2);","}"],["float inCrossBorder() {","    vec2 flip_pos = position;","    flip_pos.y = viewport.y - position.y;","    mat2 rotate_mat = mat2(","        cos(rotate), sin(rotate),","        -sin(rotate), cos(rotate)","    );","    vec2 rotate_related_FragCoord = rotate_mat * (gl_FragCoord.xy / pixelRatio - flip_pos);","    float innerWidth = innerSize.x;","    float innerHeight = innerSize.y;","    float width = size.x;","    float height = size.y;","    float x_in1 = step(rotate_related_FragCoord.x, width / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.x, - width / 2.0 + strokeWidth / 2.0));","    float y_in1 = step(rotate_related_FragCoord.y, innerHeight / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.y, - innerHeight / 2.0 + strokeWidth / 2.0));","    float x_in2 = step(rotate_related_FragCoord.x, innerWidth / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.x, - innerWidth / 2.0 + strokeWidth / 2.0));","    float y_in2 = step(rotate_related_FragCoord.y, height / 2.0 - strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.y, - height / 2.0 + strokeWidth / 2.0));","    float outCross = 1. - min(1., x_in1 * y_in1 + x_in2 * y_in2);","","    float x_out1 = step(rotate_related_FragCoord.x, width / 2.0 + strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.x, - width / 2.0 - strokeWidth / 2.0));","    float y_out1 = step(rotate_related_FragCoord.y, innerHeight / 2.0 + strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.y, - innerHeight / 2.0 - strokeWidth / 2.0));","    float x_out2 = step(rotate_related_FragCoord.x, innerWidth / 2.0 + strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.x, - innerWidth / 2.0 - strokeWidth / 2.0));","    float y_out2 = step(rotate_related_FragCoord.y, height / 2.0 + strokeWidth / 2.0) * (1.0 - step(rotate_related_FragCoord.y, - height / 2.0 - strokeWidth / 2.0));","    float inCrossBorder = min(1., x_out1 * y_out1 + x_out2 * y_out2);","    return inCrossBorder * outCross;","}"],["float inCircle() {","    vec2 flip_pos = position;","    flip_pos.y = viewport.y - position.y;","    float dist = distance(gl_FragCoord.xy / pixelRatio, flip_pos);","    return 1. - smoothstep((r - strokeWidth / 2.) - 2. * fwidth(dist), (r - strokeWidth / 2.), dist);","}"],["float inCircleBorder() {","    if (strokeWidth == 0.) {","      return 0.;","    }","    vec2 flip_pos = position;","    flip_pos.y = viewport.y - position.y;","","    float dist = distance(gl_FragCoord.xy / pixelRatio, flip_pos);","    float drawOuter = 1. - smoothstep((r + strokeWidth / 2.) - fwidth(dist), (r + strokeWidth / 2.), dist);","    float drawInner = 1. - smoothstep((r - strokeWidth / 2.) - fwidth(dist), (r - strokeWidth / 2.), dist);","    return drawOuter * (1. - drawInner);","}"]],a.main=["void main(void) {","    if (shape == 0.0) {","        // circle shape","        // border check, using 0.5(center of smoothstep)","        if (inCircle() < 0.1 && (inCircleBorder() < 0.1)) {","            discard;","        }","        fragmentColor = inCircleBorder() * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a) + inCircle() * vec4(fill.rgb * fill.a, fill.a);","    } else if (shape == 1.0) {","        if (inRect() < 0.5 && (inRectBorder() < 0.5)) {","            discard;","        }","        // rect shape","        fragmentColor = inRectBorder() * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a) + inRect() * vec4(fill.rgb * fill.a, fill.a);","    } else if (shape == 2.0) {","        if (inTriangle() < 0.5 && (inTriangleBorder() < 0.5)) {","            discard;","        }","        // triangle shape","        fragmentColor = inTriangleBorder() * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a) + inTriangle() * vec4(fill.rgb * fill.a, fill.a);","    } else if (shape == 3.0) {","        if (inCross() < 0.5 && (inCrossBorder() < 0.5)) {","            discard;","        }","        // cross shape","        fragmentColor = inCrossBorder() * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a) + inCross() * vec4(fill.rgb * fill.a, fill.a);","    }","}"];const s=a.copy();t.idFragment=s,s.inputs.id="vec4";["        fragmentColor = inCircleBorder() * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a) + inCircle() * vec4(fill.rgb * fill.a, fill.a);","        fragmentColor = inRectBorder() * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a) + inRect() * vec4(fill.rgb * fill.a, fill.a);","        fragmentColor = inTriangleBorder() * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a) + inTriangle() * vec4(fill.rgb * fill.a, fill.a);","        fragmentColor = inCrossBorder() * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a) + inCross() * vec4(fill.rgb * fill.a, fill.a);"].forEach(e=>{s.main[s.main.indexOf(e)]="fragmentColor = id;"})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.idFragment=t.fragment=t.idVertex=t.vertex=void 0;const n=r(0),i=new n.Shader;t.vertex=i,i.inputs={inVertexPos:"vec3",in_shape:"float",in_source:"vec2",in_target:"vec2",in_curveness:"float",in_dashInterval:"float",in_strokeWidth:"float",in_strokeColor:"vec4"},i.outputs={shape:"float",strokeColor:"vec4",strokeWidth:"float",cpA:"vec2",cpB:"vec2",cpC:"vec2",curveness:"float",dashInterval:"float"},i.uniforms={projection:"mat3",scale:"vec2",translate:"vec2"},i.main=["void main(void) {","    strokeColor = in_strokeColor;","    strokeWidth = in_strokeWidth;","    shape = in_shape;","    dashInterval = in_dashInterval;","    vec2 source = in_source * scale + translate;","    vec2 target = in_target * scale + translate;","    vec2 delta = target - source;","    vec2 center = 0.5 * (source + target);","    float len = length(delta);","    float phi = atan(delta.y / delta.x);","    float containerWidth = in_strokeWidth;","    if (in_shape == 1.) {","       containerWidth = 2. * (in_curveness * len + in_strokeWidth); // TODO: can optimize to half","    }","    vec2 normal = normalize(vec2(delta.y, -delta.x)); // TODO: link's normal, need control side","    cpA = source;","    cpB = center + normal * len * in_curveness;","    cpC = target;","","    mat3 line_scale = mat3(","        len, 0, 0,","        0, containerWidth, 0,","        0, 0, 1","    );","    mat3 line_rotate = mat3(","        cos(phi), sin(phi), 0,","        -sin(phi), cos(phi), 0,","        0, 0, 1","    );","    mat3 line_translate = mat3(","        1, 0, 0,","        0, 1, 0,","        center.x, center.y, 1","    );","    ","    mat3 transform = line_translate * line_rotate * line_scale;","","    gl_Position = vec4(projection * transform * inVertexPos, 1.);","}"];const o=i.copy();t.idVertex=o,o.inputs.in_id="vec4",o.outputs.id="vec4",o.main.splice(1,0,"id = in_id;");const a=new n.Shader;t.fragment=a,a.inputs={...i.outputs},a.outputs={fragmentColor:"vec4"},a.uniforms={viewport:"vec2",pixelRatio:"float"},a.methods=[["// reference paper: http://hhoppe.com/ravg.pdf","// distance vector to origin(0, 0)","float det(vec2 a, vec2 b) { return a.x * b.y - b.x * a.y; }","","vec2 get_distance_vector(vec2 b0, vec2 b1, vec2 b2) {","  float a = det(b0, b2), b = 2.0 * det(b1, b0), d = 2.0 * det(b2, b1);","  float f = b * d - a * a;","  vec2 d21 = b2 - b1, d10 = b1 - b0, d20 = b2 - b0;","  vec2 gf = 2.0 * (b * d21 + d * d10 + a * d20);","  gf = vec2(gf.y, -gf.x);","  vec2 pp = -f * gf / dot(gf, gf);","  vec2 d0p = b0 - pp;","  float ap = det(d0p, d20), bp = 2.0 * det(d10, d0p);","  float t = clamp((ap + bp) / (2.0 * a + b + d), 0.0, 1.0);","  return mix(mix(b0, b1, t), mix(b1, b2, t), t);","}"],["float distToQuadraticBezierCurve(vec2 p, vec2 b0, vec2 b1, vec2 b2) {","  return length(get_distance_vector(b0 - p, b1 - p, b2 - p));","}"],["float isInDash(vec2 p, vec2 p0, vec2 p1, int dashInterval) {","  if (dashInterval <= 0) {","    return 0.;","  }","  if (dashInterval >= int(length(p1 - p0))) {","    return 1.;","  }","  float d = dot((p - p0), (p1 - p0)) / length(p1 - p0);","  int idx = int(d) / dashInterval;","  return 1. - float(idx % 2);","}"]],a.main=["void main(void) {","  if (shape == 0.) {","    // line","    fragmentColor = vec4(strokeColor.rgb * strokeColor.a, strokeColor.a);","  } else if (shape == 1.) {","    // curve","    vec2 pos = gl_FragCoord.xy / pixelRatio;","    vec2 cpAFlipped = vec2(cpA.x, viewport.y - cpA.y);","    vec2 cpBFlipped = vec2(cpB.x, viewport.y - cpB.y);","    vec2 cpCFlipped = vec2(cpC.x, viewport.y - cpC.y);","    float dist = distToQuadraticBezierCurve(pos, cpAFlipped, cpBFlipped, cpCFlipped);","    float epsilon = fwidth(dist);","    if (dist < strokeWidth / 2. + epsilon) {","      float inCurve = 1. - smoothstep(strokeWidth / 2. - epsilon, strokeWidth / 2. + epsilon, dist);","      fragmentColor = inCurve * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a);","    } else {","      discard;","    }","  } else if (shape == 2.) {","    // dash-line","    vec2 pos = gl_FragCoord.xy / pixelRatio;","    vec2 cpAFlipped = vec2(cpA.x, viewport.y - cpA.y);","    vec2 cpCFlipped = vec2(cpC.x, viewport.y - cpC.y);","    if(isInDash(pos, cpAFlipped, cpCFlipped, int(dashInterval)) > 0.5) {","      fragmentColor = vec4(strokeColor.rgb * strokeColor.a, strokeColor.a);","    } else {","      discard;","    }","  }","}"];const s=a.copy();t.idFragment=s,s.inputs.id="vec4";["    fragmentColor = vec4(strokeColor.rgb * strokeColor.a, strokeColor.a);","      fragmentColor = inCurve * vec4(strokeColor.rgb * strokeColor.a, strokeColor.a);","      fragmentColor = vec4(strokeColor.rgb * strokeColor.a, strokeColor.a);"].forEach(e=>{s.main[s.main.indexOf(e)]="fragmentColor = id;"})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderNodeManager=void 0;const n=r(4);class i extends n.RenderElementManager{constructor(e,t,r,n){super(e,{...t,instanceVerteces:[-.5,.5,1,-.5,-.5,1,.5,.5,1,.5,-.5,1]},{...r},n),this.renderIdToElement={}}refreshPosition(e){const t=this.attributes.get("in_position");e.forEach((e,r)=>{t.array[2*r]=e.$_position.x,t.array[2*r+1]=e.$_position.y}),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.buffer),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,t.array,0,t.size*e.length)}}t.RenderNodeManager=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderLinkManager=void 0;const n=r(4);class i extends n.RenderElementManager{constructor(e,t,r,n){super(e,{...t,instanceVerteces:[-.5,.5,1,-.5,-.5,1,.5,.5,1,.5,-.5,1]},{...r},n),this.renderIdToElement={}}refreshPosition(e){const t=this.attributes.get("in_source"),r=this.attributes.get("in_target");e.forEach((e,n)=>{t.array[2*n]=e.$_source.$_position.x,t.array[2*n+1]=e.$_source.$_position.y,r.array[2*n]=e.$_target.$_position.x,r.array[2*n+1]=e.$_target.$_position.y});[t,r].forEach(t=>{this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.buffer),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,t.array,0,t.size*e.length)})}}t.RenderLinkManager=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractionManager=void 0;t.InteractionManager=class{constructor(e){this.isZoomListened=!1,this.isMouseListened=!1,this.mouseEventCallbackCount=0,this.isMouseDown=!1,this.isMouseMove=!1,this.netv=e,this.canvas=this.netv.$_container.querySelector("canvas"),this.zoomCallbackSet=new Set,this.panCallbackSet=new Set,this.clickCallbackSet=new Set,this.mousedownCallbackSet=new Set,this.mouseupCallbackSet=new Set}panBy(e,t){const r={...this.netv.$_transform};return r.x+=e,r.y+=t,this.netv.transform(r)}zoomBy(e,t){const r={...this.netv.$_transform};let n=t;n||(n={x:this.netv.$_configs.width/2,y:this.netv.$_configs.height/2});const{x:i,y:o}=n;return r.x=(1-e)*i+e*r.x,r.y=(1-e)*o+e*r.y,r.k*=e,this.netv.transform(r)}centerPosition(e){const t={...this.netv.$_transform},r=e.x*t.k+t.x,n=e.y*t.k+t.y,i=this.netv.$_configs.width/2,o=this.netv.$_configs.height/2;return t.x+=i-r,t.y+=o-n,this.netv.transform(t),t}onZoom(e){this.zoomCallbackSet.add(e),this.isZoomListened||(this.addWheelListeners(),this.isZoomListened=!0)}offZoom(e){this.zoomCallbackSet.delete(e),this.zoomCallbackSet.size||(this.removeWheelListeners(),this.isZoomListened=!1)}onClick(e){this.clickCallbackSet.add(e),this.increaseMouseEventCallbackCountBy(1)}offClick(e){this.clickCallbackSet.delete(e),this.decreaseMouseEventCallbackCountBy(1)}onMousedown(e){this.mousedownCallbackSet.add(e),this.increaseMouseEventCallbackCountBy(1)}offMousedown(e){this.mousedownCallbackSet.delete(e),this.decreaseMouseEventCallbackCountBy(1)}onMouseup(e){this.mouseupCallbackSet.add(e),this.increaseMouseEventCallbackCountBy(1)}offMouseup(e){this.mouseupCallbackSet.delete(e),this.decreaseMouseEventCallbackCountBy(1)}onPan(e){this.panCallbackSet.add(e),this.increaseMouseEventCallbackCountBy(1)}offPan(e){this.panCallbackSet.delete(e),this.decreaseMouseEventCallbackCountBy(1)}increaseMouseEventCallbackCountBy(e){this.mouseEventCallbackCount+=e,!this.isMouseListened&&this.mouseEventCallbackCount>0&&(this.addMouseListeners(),this.isMouseListened=!0)}decreaseMouseEventCallbackCountBy(e){this.mouseEventCallbackCount-=e,this.mouseEventCallbackCount<=0&&!this.panCallbackSet.size&&(this.removeMouseListeners(),this.isMouseListened=!1)}handleZoom(e){const t={...this.netv.$_transform},r=e.offsetX||e.pageX-this.canvas.offsetLeft,n=e.offsetY||e.pageY-this.canvas.offsetTop,i=e.deltaY?e.deltaY/40:e.detail?-e.detail:0;if(i){const o=Math.pow(1.1,i);t.x=(1-o)*r+o*t.x,t.y=(1-o)*n+o*t.y,t.k*=o,this.netv.transform(t),this.netv.draw(),this.zoomCallbackSet.forEach(r=>r({event:e,name:"zoom",transform:t}))}e.preventDefault()}handleMouseDown(e){var t;const r=e.offsetX||e.pageX-this.canvas.offsetLeft,n=e.offsetY||e.pageY-this.canvas.offsetTop,i=this.netv.$_configs.height-n,o={...this.netv.$_transform};if(this.isMouseDown=!0,this.mouseDownPos={x:r,y:n},this.dragStartTransform=JSON.parse(JSON.stringify(o)),this.mouseDownElement=this.netv.getElementByPosition({x:r,y:i}),null===(t=this.mouseDownElement)||void 0===t?void 0:t.element){const t=this.mouseDownElement.element;"Node"===(null==t?void 0:t.type)&&(this.mouseDownElementOriginPos={...t.position()}),t.$_mousedownCallbackSet.forEach(r=>{r({event:e,name:"mousedown",element:t})})}else this.mousedownCallbackSet.forEach(t=>{t({event:e,name:"mousedown"})})}handleMouseMove(e){var t,r;let n={...this.netv.$_transform};const i=e.offsetX||e.pageX-this.canvas.offsetLeft,o=e.offsetY||e.pageY-this.canvas.offsetTop,a=this.isMouseMove,s=this.mouseMoveElement;if(this.isMouseDown){this.isMouseMove=!0;const r=null===(t=this.mouseDownElement)||void 0===t?void 0:t.element;"Node"===(null==r?void 0:r.type)&&r.$_dragstartCallbackSet.size+r.$_draggingCallbackSet.size+r.$_dragendCallbackSet.size?(a||r.$_dragstartCallbackSet.forEach(t=>{t({event:e,name:"dragstart",element:r})}),r.position({x:this.mouseDownElementOriginPos.x+(i-this.mouseDownPos.x)/n.k,y:this.mouseDownElementOriginPos.y+(o-this.mouseDownPos.y)/n.k}),this.netv.draw(),r.$_draggingCallbackSet.forEach(t=>{t({event:e,name:"dragging",element:r})})):(n.x=this.dragStartTransform.x+i-this.mouseDownPos.x,n.y=this.dragStartTransform.y+o-this.mouseDownPos.y,this.panCallbackSet.size&&(this.netv.transform(n),this.netv.draw(),this.panCallbackSet.forEach(t=>t({event:e,name:"pan",transform:n}))))}else{const t=this.netv.$_configs.height-o,n=null===(r=this.netv.getElementByPosition({x:i,y:t}))||void 0===r?void 0:r.element;this.mouseMoveElement=n,s===n?null==n||n.$_mousemoveCallbackSet.forEach(t=>t({event:e,name:"mousemove",element:n})):(null==s||s.$_mouseoutCallbackSet.forEach(t=>t({event:e,name:"mouseout",element:s})),null==n||n.$_mouseoverCallbackSet.forEach(t=>t({event:e,name:"mouseover",element:n})))}}handleMouseUp(e){var t,r;if(this.mouseDownElement){if(this.isMouseMove){if(null===(t=this.mouseDownElement)||void 0===t?void 0:t.element.$_dragendCallbackSet){const t=this.mouseDownElement.element;t.$_dragendCallbackSet.forEach(r=>r({event:e,name:"dragend",element:t}))}}else{const t=this.mouseDownElement.element;t.$_clickCallbackSet.forEach(r=>r({event:e,name:"click",element:t}))}if(null===(r=this.mouseDownElement)||void 0===r?void 0:r.element.$_mouseupCallbackSet){const t=this.mouseDownElement.element;t.$_mouseupCallbackSet.forEach(r=>r({event:e,name:"mouseup",element:t}))}}else this.mouseupCallbackSet.forEach(t=>t({event:e,name:"mouseup"})),this.isMouseMove||this.clickCallbackSet.forEach(t=>t({event:e,name:"click"}));this.isMouseDown=!1,this.isMouseMove=!1,this.mouseDownElement=void 0}addWheelListeners(){this.canvas.addEventListener("DOMMouseScroll",this.handleZoom.bind(this),!1),this.canvas.addEventListener("mousewheel",this.handleZoom.bind(this),!1)}removeWheelListeners(){this.canvas.removeEventListener("DOMMouseScroll",this.handleZoom.bind(this)),this.canvas.removeEventListener("mousewheel",this.handleZoom.bind(this))}addMouseListeners(){const e=this.canvas;e.addEventListener("mousedown",this.handleMouseDown.bind(this)),e.addEventListener("mousemove",this.handleMouseMove.bind(this)),e.addEventListener("mouseup",this.handleMouseUp.bind(this))}removeMouseListeners(){const e=this.canvas;e.removeEventListener("mousedown",this.handleMouseDown.bind(this)),e.removeEventListener("mousemove",this.handleMouseMove.bind(this)),e.removeEventListener("mouseup",this.handleMouseUp.bind(this))}}},function(e,t,r){"use strict";function n(){console.log("js log")}r.r(t),r.d(t,"logJs",(function(){return n}))},function(e,t,r){e.exports=function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,(function(e){var r=t[a][1][e];return i(r||e)}),l,l.exports,e,t,r,n)}return r[a].exports}for(var o=!1,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){"use strict";!function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(e("stardust-core"));var n=e("stardust-webgl");r.WebGLPlatform=n.WebGLPlatform,r.WebGLCanvasPlatform2D=n.WebGLCanvasPlatform2D;var i=e("stardust-isotype");!function(e){e.isotype=i.isotype}(r.mark||(r.mark={})),e("stardust-webgl")},{"stardust-core":27,"stardust-isotype":28,"stardust-webgl":33}],2:[function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("./types"),o=function(){};r.TextureBinding=o;var a=function(e){function t(){e.apply(this,arguments),this._data=null,this._valueFunction=null,this._dirty=!1,this._textureData=null}return n(t,e),t.prototype.getTextureData=function(){if(this._dirty){var e=this._data.map(this._valueFunction).map(i.getBindingValue);if(0==e.length)this._textureData=null;else{var t,r=void 0;if("number"==typeof e[0]){r=1,t=new Float32Array(4*e.length);for(var n=0;n<e.length;n++)t[4*n]=e[n]}else{r=e[0].length,t=new Float32Array(4*e.length);var o=0;for(n=0;n<e.length;n++){for(var a=e[n],s=0;s<r;s++)t[o++]=a[s];o+=4-r}}this._textureData={width:this._data.length,height:1,dimensions:1,numberComponents:r,data:t}}}return this._textureData},t.prototype.data=function(e){return null!=e?(this._data=e,this._dirty=!0,this):this._data},t.prototype.value=function(e){return null!=e?(this._valueFunction=e,this._dirty=!0,this):this._valueFunction},t}(o);r.Array=a,r.array=function(){return new a}},{"./types":4}],3:[function(e,t,r){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}var i=e("../spec/spec"),o=e("./array"),a=e("../exceptions"),s=e("./types");n(e("./types")),n(e("./array"));var u=function(){function e(e,t){this._type=i.types[e],this._value=t}return Object.defineProperty(e.prototype,"valueType",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bindingType",{get:function(){return this._value instanceof o.TextureBinding?s.BindingType.TEXTURE:"function"==typeof this._value?s.BindingType.FUNCTION:s.BindingType.VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specValue",{get:function(){return s.getBindingValue(this._value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureValue",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e,t){switch(this.bindingType){case s.BindingType.FUNCTION:for(var r=this._value,n=0;n<e.length;n++)t(s.getBindingValue(r(e[n],n)),n);break;case s.BindingType.VALUE:var i=s.getBindingValue(this._value);for(n=0;n<e.length;n++)t(i,n);break;case s.BindingType.TEXTURE:throw new a.RuntimeError("Texture binding does not support for each")}},e.prototype.map=function(e){switch(this.bindingType){case s.BindingType.FUNCTION:var t=this._value;return e.map((function(e,r){return s.getBindingValue(t(e,r))}));case s.BindingType.VALUE:var r=s.getBindingValue(this._value);return e.map((function(){return r}));case s.BindingType.TEXTURE:throw new a.RuntimeError("Texture binding does not support for map")}},e.prototype.fillBinary=function(e,t,r){var n=e.length,i=this._type.primitiveCount,o=0;switch(this.bindingType){case s.BindingType.FUNCTION:var u=this._value;if(1==i)for(var l=0;l<n;l++)for(var c=s.getBindingValue(u(e[l],l)),p=0;p<t;p++)r[o++]=c;else for(l=0;l<n;l++)for(c=s.getBindingValue(u(e[l],l)),p=0;p<t;p++)for(var h=0;h<i;h++)r[o++]=c[h];break;case s.BindingType.VALUE:var d=s.getBindingValue(this._value);if(1==i){var m=d;for(l=0;l<n;l++)for(p=0;p<t;p++)r[o++]=m}else for(m=d,l=0;l<n;l++)for(p=0;p<t;p++)for(h=0;h<i;h++)r[o++]=m[h];break;case s.BindingType.TEXTURE:throw new a.RuntimeError("Texture binding does not support for fillBinary")}},e}();r.Binding=u},{"../exceptions":11,"../spec/spec":23,"./array":2,"./types":4}],4:[function(e,t,r){"use strict";var n=e("../math/math");!function(e){e[e.VALUE=0]="VALUE",e[e.FUNCTION=1]="FUNCTION",e[e.TEXTURE=2]="TEXTURE"}(r.BindingType||(r.BindingType={})),r.BindingType;var i=function(e,t){this.name=e,this.offset=t};r.ShiftBinding=i,r.getBindingValue=function(e){return e instanceof n.MathType?e.toArray():e}},{"../math/math":18}],5:[function(e,t,r){"use strict";var n,i=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=function(e){function t(t,r,n,i){void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=1),e.call(this),this.r=t,this.g=r,this.b=n,this.a=i}return i(t,e),t.prototype.toArray=function(){return[this.r,this.g,this.b,this.a]},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.FromArray=function(e){return new t(e[0],e[1],e[2],e[3])},t.FromHTML=function(e){return t.FromArray(n.fromHTML(e))},t}(e("../math/math").MathType);r.Color=o,function(e){e.fromHTML=function(e,t){var r;return void 0===e&&(e="#000000"),(r=e.match(/^ *rgb *\( *([0-9\.\-e]+) *, *([0-9\.\-e]+) *, *([0-9\.\-e]+) *\) *$/))?[+r[1]/255,+r[2]/255,+r[3]/255,null!=t?t:1]:(r=e.match(/^ *rgba *\( *([0-9\.\-e]+) *, *([0-9\.\-e]+) *, *([0-9\.\-e]+) *, *([0-9\.\-e]+) *\) *$/))?[+r[1]/255,+r[2]/255,+r[3]/255,null!=t?t*+r[4]:+r[4]]:(r=e.match(/^ *\#([0-9a-fA-F]{3}) *$/))?[17*parseInt(r[1][0],16)/255,17*parseInt(r[1][1],16)/255,17*parseInt(r[1][2],16)/255,null!=t?t:1]:(r=e.match(/^ *\#([0-9a-fA-F]{6}) *$/))?[parseInt(r[1].slice(0,2),16)/255,parseInt(r[1].slice(2,4),16)/255,parseInt(r[1].slice(4,6),16)/255,null!=t?t:1]:[0,0,0,1]}}(n=r.color||(r.color={}))},{"../math/math":18}],6:[function(e,t,r){"use strict";var n=e("../exceptions"),i=e("./parser"),o=e("../utils/utils"),a=e("../intrinsics/intrinsics"),s=e("../library/library"),u=function(){function e(){var e=this;this._functions=new o.Dictionary,this._functionModule=new o.Dictionary,this._currentMoudles=[],a.forEachIntrinsicFunction((function(t){e.addIntrinsicFunction(t.name,{type:"function",isMark:!1,isShader:!1,name:t.internalName,returnType:t.returnType,arguments:t.argTypes.map((function(e,t){return{name:"a"+t,type:e}})),statements:null})}))}return e.prototype.addIntrinsicFunction=function(e,t){if(this._functions.has(e))(r=this._functions.get(e)).addFunction(t);else{var r=new h(e);this._functions.set(e,r),r.addFunction(t)}},e.prototype.addFunction=function(e,t){if(this._functions.has(e))(r=this._functions.get(e)).addFunction(t);else{var r=new h(e);this._functions.set(e,r),r.addFunction(t)}},e.prototype.importFunction=function(e,t){this.addFunction(t,e.get(t)),this._functionModule.set(t,e)},e.prototype.getFunction=function(e){for(var t=this._currentMoudles.length-1;t>=0;t--){var r=this._currentMoudles[t];if(r&&r.has(e)){var n=new h(e);return n.addFunction(r.get(e)),n}}return this._functions.has(e)?this._functions.get(e):null},e.prototype.enterFunctionImplementation=function(e){this._currentMoudles.push(this._functionModule.get(e))},e.prototype.leaveFunctionImplementation=function(e){this._currentMoudles.pop()},e}();r.ModuleResolver=u;var l=function(){function e(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null),this._owner=e,this._variables=new o.Dictionary,this._parentScope=t||null,this._argMap=r}return e.prototype.addVariable=function(e,t){if(this._variables.has(e)||null!=this._argMap&&this._argMap.has(e))throw new n.CompileError(e+" is already declared.");var r=this._owner.newTranslatedName(e,t);this._variables.set(e,{name:e,type:t,translatedName:r})},e.prototype.nextVariable=function(e){var t=this,r=o.attemptName("tmp",(function(e){return!(t._variables.has(e)||null!=t._argMap&&t._argMap.has(e))}));return this.addVariable(r,e),this.getVariable(r)},e.prototype.getVariable=function(e){if(this._variables.has(e))return this._variables.get(e);if(null!=this._argMap&&this._argMap.has(e))return this._parentScope.getVariable(this._argMap.get(e));if(this._parentScope)return this._parentScope.getVariable(e);throw new n.CompileError(e+" is undefined.")},Object.defineProperty(e.prototype,"parentScope",{get:function(){return this._parentScope},enumerable:!0,configurable:!0}),e}();r.ScopeVariables=l;var c=function(){function e(){this._translatedNames=new o.Dictionary,this._globalScope=new l(this),this._currentScope=this._globalScope}return e.prototype.resetScope=function(){this._translatedNames=new o.Dictionary,this._globalScope=new l(this),this._currentScope=this._globalScope},e.prototype.pushScope=function(e){void 0===e&&(e=null),this._currentScope=new l(this,this._currentScope,e)},e.prototype.popScope=function(){this._currentScope=this._currentScope.parentScope},e.prototype.newTranslatedName=function(e,t){var r=this,n=o.attemptName(e,(function(e){return!r._translatedNames.has(e)}));return this._translatedNames.set(n,{name:e,type:t,translatedName:n}),n},e.prototype.forEach=function(e){this._translatedNames.forEach((function(t){e(t.translatedName,t.type)}))},e.prototype.nextVariableTranslatedName=function(e){return this.nextVariable(e).translatedName},e.prototype.nextVariableName=function(e){return this.nextVariable(e).name},e.prototype.nextVariable=function(e){return this._currentScope.nextVariable(e)},e.prototype.addVariable=function(e,t,r){"global"==r?this._globalScope.addVariable(e,t):this._currentScope.addVariable(e,t)},e.prototype.translateVariableName=function(e){return this.getVariable(e).translatedName},e.prototype.getVariable=function(e){return this._currentScope.getVariable(e)},e}();function p(e,t){var r=a.getTypeConversion(e.valueType,t);if(r){var n=r.rank;return[{type:"function",valueType:t,arguments:[e],functionName:r.internalName},n]}return[null,null]}r.ScopeStack=c;var h=function(){function e(e){this._name=e,this._functions=[]}return e.prototype.addFunction=function(e){this._functions.push(e)},e.prototype.resolveArguments=function(e,t){for(var r=null,i=null,o=0,a=this._functions;o<a.length;o++){var s=a[o],u=0,l=!0,c=[],h=[],d=[];for(var m in s.arguments){var f=s.arguments[m],g=e[m]||t[f.name];if(null!=e[m]?h.push(m):t[f.name]&&d.push(f.name),null!=g)if(g.valueType!=f.type){var v=p(g,f.type),y=v[0],_=v[1];if(!y){l=!1;break}c.push(y),u+=_}else c.push(g);else{if(null===f.default||void 0===f.default){l=!1;break}c.push({type:"constant",value:f.default,valueType:f.type})}}var x=!0;for(var m in e)h.indexOf(m)<0&&(x=!1);for(var b in t)d.indexOf(b)<0&&(x=!1);l&&x&&(!r||u<i)&&(r=[s,c],i=u)}if(r)return r;var C=e.map((function(e){return e.valueType})).join(", ");throw new n.CompileError("unable to resolve function '"+this._name+"' with arguments ("+C+")")},e}();r.FunctionOverloadResolver=h;var d=function(){function e(){this._scope=new c,this._constants=new o.Dictionary,this._moduleResolver=new u,this._statements=[],this._lastIndex=1,this.prepareFieldTypeRegistry(),this.prepareConstants()}return e.prototype.prepareFieldTypeRegistry=function(){this._fieldTypeRegistry={};for(var e=this._fieldTypeRegistry,t=0,r=["x","y"];t<r.length;t++)e["Vector2."+r[t]]="float";for(var n=0,i=["x","y","z","r","g","b"];n<i.length;n++)e["Vector3."+i[n]]="float";for(var o=0,a=["x","y","z","w","r","g","b","a"];o<a.length;o++)e["Vector4."+a[o]]="float";for(var s=0,u=["r","g","b","a"];s<u.length;s++)e["Color."+u[s]]="float"},e.prototype.prepareConstants=function(){var e=this;a.forEachConstant((function(t){e._constants.set(t.name,t)}))},e.prototype.resolveFunction=function(e,t,r){var i=this._moduleResolver.getFunction(e);if(i)return i.resolveArguments(t,r);throw new n.CompileError("function '"+e+" is undefined.")},e.prototype.loadFile=function(e){for(var t=this,r=function(e){if("function"==e.type){var r=e;n._moduleResolver.addFunction(r.name,r)}if("import"==e.type){var i=e;if(null!=i.functionNames)i.functionNames.forEach((function(e){t._moduleResolver.importFunction(s.getModule(i.moduleName),e)}));else{var o=s.getModule(i.moduleName);o.forEach((function(e,r){t._moduleResolver.importFunction(o,r)}))}}},n=this,i=0,o=e.blocks;i<o.length;i++)r(o[i])},e.prototype.getDefaultValueForType=function(e){return"float"==e?0:"Vector2"==e?[0,0]:"Vector3"==e?[0,0,0]:"Vector4"==e?[0,0,0,0]:"Color"==e||"Quaternion"==e?[0,0,0,1]:0},e.prototype.compileFunctionToMark=function(e,t){this._scope.resetScope(),this._lastIndex=1;for(var r={},i={},o={},a=0,s=e;a<s.length;a++){var u=s[a];this._scope.addVariable(u.name,u.valueType,"global"),r[u.name]={type:u.valueType,default:u.default||this.getDefaultValueForType(u.valueType)}}for(var l=0,c=t.arguments;l<c.length;l++){var p=c[l];this._scope.addVariable(p.name,p.type,"local"),r[p.name]={type:p.type,default:p.default||this.getDefaultValueForType(p.type)}}this.compileStatements({type:"statements",statements:t.statements}),this._scope.forEach((function(e,t){r[e]||(o[e]=t)}));var h=function(e){e.forEach((function(e){if("emit"==e.type){var t=e;for(var r in t.attributes)if(i.hasOwnProperty(r)){if(i[r].type!=t.attributes[r].valueType)throw new n.CompileError("output variable '"+r+" has conflicting types.")}else i[r]={type:t.attributes[r].valueType}}if("condition"==e.type){var o=e;h(o.trueStatements),h(o.falseStatements)}"for"==e.type&&h(e.statements)}))};return h(this._statements),{input:r,output:i,variables:o,statements:this._statements}},e.prototype.addStatement=function(e){this._statements.push(e)},e.prototype.addStatements=function(e){this._statements=this._statements.concat(e)},e.prototype.captureStatements=function(e){var t=this._statements;this._statements=[],e();var r=this._statements;return this._statements=t,r},e.prototype.compileExpression=function(e){switch(e.type){case"value":return{type:"constant",value:(t=e).value,valueType:t.valueType};case"variable":var t=e;if(this._constants.has(t.name)){var r=this._constants.get(t.name);return{type:"constant",value:r.value,valueType:r.type}}return{type:"variable",variableName:this._scope.translateVariableName(t.name),valueType:this._scope.getVariable(t.name).type};case"field":t=e;var n=this.compileExpression(t.value);return{type:"field",fieldName:t.fieldName,value:n,valueType:this._fieldTypeRegistry[n.valueType+"."+t.fieldName]};case"function":for(var i=[],a={},s=0,u=(t=e).args.args;s<u.length;s++){var l=u[s];i.push(this.compileExpression(l))}for(var c in t.args.kwargs)t.args.kwargs[c],a[c]=this.compileExpression(t.args.kwargs[c]);var p=this.resolveFunction(t.name,i,a),h=p[0],d=p[1],m=null;if(h.statements){var f=new o.Dictionary;for(var g in h.arguments){l=h.arguments[g];var v=this._scope.nextVariableName(l.type);f.set(l.name,v),this.addStatement({type:"assign",variableName:this._scope.translateVariableName(v),expression:d[g]})}this._scope.pushScope(f),this._moduleResolver.enterFunctionImplementation(t.name);for(var y=0,_=h.statements;y<_.length;y++){var x=_[y];if("return"==x.type){var b=x;m=this.compileExpression(b.value);break}this.compileStatement(x)}this._moduleResolver.leaveFunctionImplementation(t.name),this._scope.popScope()}else m={type:"function",functionName:h.name,arguments:d,valueType:h.returnType};return m}return null},e.prototype.compileStandaloneExpression=function(e,t){switch(e.type){case"value":return{type:"constant",value:(r=e).value,valueType:r.valueType};case"variable":var r=e;if(t.has(r.name))return t.get(r.name);if(this._constants.has(r.name)){var i=this._constants.get(r.name);return{type:"constant",value:i.value,valueType:i.type}}throw new n.CompileError("variable "+r.name+" is undefined");case"field":r=e;var o=this.compileStandaloneExpression(r.value,t);return{type:"field",fieldName:r.fieldName,value:o,valueType:this._fieldTypeRegistry[o.valueType+"."+r.fieldName]};case"function":for(var a=[],s={},u=0,l=(r=e).args.args;u<l.length;u++){var c=l[u];a.push(this.compileStandaloneExpression(c,t))}for(var p in r.args.kwargs)r.args.kwargs[p],s[p]=this.compileStandaloneExpression(r.args.kwargs[p],t);var h=this.resolveFunction(r.name,a,s),d=h[0],m=h[1];return{type:"function",functionName:d.name,arguments:m,valueType:d.returnType}}return null},e.prototype.compileStatements=function(e){this._scope.pushScope();for(var t=0,r=e.statements;t<r.length;t++){var n=r[t];this.compileStatement(n)}this._scope.popScope()},e.prototype.compileStatement=function(e){var t=this;switch(e.type){case"declare":if((a=e).initial){var r=this.compileExpression(a.initial),i=a.variableType;if("auto"==i&&(i=r.valueType),this._scope.addVariable(a.variableName,i,"local"),r.valueType!=i){var o=r.valueType;if(null===(r=p(r,this._scope.getVariable(a.variableName).type)[0]))throw new n.CompileError("cannot convert type '"+o+"' to '"+i+"'.")}this.addStatement({type:"assign",variableName:this._scope.translateVariableName(a.variableName),expression:r})}else this._scope.addVariable(a.variableName,a.variableType,"local");break;case"expression":var a=e;this.compileExpression(a.expression);break;case"assign":a=e,r=this.compileExpression(a.expression);var s=this._scope.getVariable(a.variableName).type;if(r.valueType!=s&&(o=r.valueType,null===(r=p(r,this._scope.getVariable(a.variableName).type)[0])))throw new n.CompileError("cannot convert type '"+o+" to '"+s+"'.");this.addStatement({type:"assign",variableName:this._scope.translateVariableName(a.variableName),expression:r});break;case"emit":(a=e).vertices.forEach((function(e){var r={};for(var n in e){var i=e[n];r[n]=t.compileExpression(i)}t.addStatement({type:"emit",attributes:r})}));break;case"statements":a=e,this.compileStatements(a);break;case"for":var u=e;this._scope.pushScope(),this._scope.addVariable(u.variableName,"int","local");var l={type:"for",variableName:this._scope.translateVariableName(u.variableName),rangeMin:u.start,rangeMax:u.end,statements:this.captureStatements((function(){return t.compileStatement(u.statement)}))};this.addStatement(l),this._scope.popScope();break;case"if":var c=e,h=function(e){if(e<c.conditions.length){t._scope.pushScope();var r={type:"condition",condition:t.compileExpression(c.conditions[e].condition),trueStatements:t.captureStatements((function(){return t.compileStatement(c.conditions[e].statement)})),falseStatements:t.captureStatements((function(){return h(e+1)}))};t.addStatement(r),t._scope.popScope()}else c.else&&t.compileStatement(c.else)};h(0);break;case"return":throw new n.CompileError("unexpected return statement")}},e}();function m(e){for(var t={},r=e.blocks.filter((function(e){return"global"==e.type})),n=0,i=e.blocks;n<i.length;n++){var o=i[n];if("function"==o.type){var a=o;if(a.isMark||a.isShader){var s=new d;s.loadFile(e);var u=s.compileFunctionToMark(r,a);t[a.name]=u}}}return t}r.Compiler=d,r.compileTree=m;var f=new d;r.compileExpression=function(e,t){return f.compileStandaloneExpression(e,t)},r.compileString=function(e){return m(i.parseFile(e))}},{"../exceptions":11,"../intrinsics/intrinsics":12,"../library/library":13,"../utils/utils":26,"./parser":8}],7:[function(e,t,r){"use strict";var n=e("../utils/utils"),i=e("./compiler"),o=function(){function e(e){this._name=e,this._attrs=new n.Dictionary}return e.prototype.attr=function(e,t){return this._attrs.set(e,t),this},e.prototype.generateCode=function(){var e=[];return this._attrs.forEach((function(t,r){e.push(r+" = "+t)})),this._name+"("+e.join(", ")+")"},e}();r.CustomMarkItem=o;var a=function(){function e(){this._imports=[],this._inputs=[],this._variables=[],this._items=[]}return e.prototype.input=function(e,t,r){return this._inputs.push([e,t,r]),this},e.prototype.variable=function(e,t){return this._variables.push([e,t]),this},e.prototype.add=function(e){for(var t=e.split("."),r=t[0],n=t[1],i=!1,a=0,s=this._imports;a<s.length;a++){var u=s[a],l=u[0],c=u[1];l==r&&c==n&&(i=!0)}i||this._imports.push([r,n]);var p=new o(n);return this._items.push(p),p},e.prototype.generateCode=function(e){for(var t=[],r=0,n=this._imports;r<n.length;r++){var i=n[r],o=i[0],a=i[1];t.push("import { "+a+" } from "+o+";")}for(var s=[],u=0,l=this._inputs;u<l.length;u++){var c=l[u],p=c[0],h=c[1],d=c[2];null==d?s.push(p+": "+h):s.push(p+": "+h+" = "+d)}t.push("mark "+e+"("),t.push("    "+s.join(", ")),t.push(") {");for(var m=0,f=this._variables;m<f.length;m++){var g=f[m],v=g[0],y=g[1];t.push("    let "+v+" = "+y+";")}for(var _=0,x=this._items;_<x.length;_++){var b=x[_];t.push("    "+b.generateCode()+";")}return t.push("}"),t.join("\n")},e.prototype.compile=function(){var e=this.generateCode("Mark");return i.compileString(e).Mark},e}();r.CustomMark=a},{"../utils/utils":26,"./compiler":6}],8:[function(e,t,r){"use strict";var n=e("../exceptions"),i=e("./parser_pegjs");r.parseFile=function(e){e=function(e){return e=(e=e.replace(/\/\/[^\n]*\n/g,"\n")).replace(/\/\/[^\n]*$/g,"")}(e);var t=null;try{t=i.parse(e,{startRule:"FileEntry"})}catch(e){throw e.location?new n.ParseError(e.message,e.location.start,e.location.end):new n.ParseError(e.message)}return t},r.parseExpression=function(e){var t=null;try{t=i.parse(e,{startRule:"ExpressionEntry"})}catch(e){throw e.location?new n.ParseError(e.message,e.location.start,e.location.end):new n.ParseError(e.message)}return t}},{"../exceptions":11,"./parser_pegjs":9}],9:[function(e,t,r){t.exports=function(){"use strict";function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),{SyntaxError:e,parse:function(t){var r,n=arguments.length>1?arguments[1]:{},i={},o={FileEntry:Gt,ExpressionEntry:Ot},a=Gt,s=function(e){return{blocks:e.map((function(e){return e[0]}))}},u=function(e){return e},l="function",c={type:"literal",value:"function",description:'"function"'},p="mark",h={type:"literal",value:"mark",description:'"mark"'},d="shader",m={type:"literal",value:"shader",description:'"shader"'},f="(",g={type:"literal",value:"(",description:'"("'},v=")",y={type:"literal",value:")",description:'")"'},_=":",x={type:"literal",value:":",description:'":"'},b="{",C={type:"literal",value:"{",description:'"{"'},w="}",T={type:"literal",value:"}",description:'"}"'},E=function(e,t,r,n,i){return{type:"function",isMark:"mark"==Br(e),isShader:"shader"==Br(e),name:t,returnType:n?n[3]:"void",arguments:r,statements:i}},k="let",P={type:"literal",value:"let",description:'"let"'},A="=",M={type:"literal",value:"=",description:'"="'},V=";",B={type:"literal",value:";",description:'";"'},S=function(e,t,r){return{type:"global",name:e,valueType:t?t[3]:"auto",default:r?r[3]:void 0}},F="import",R={type:"literal",value:"import",description:'"import"'},N="*",I={type:"literal",value:"*",description:'"*"'},L="from",$={type:"literal",value:"from",description:'"from"'},D=function(e){return{type:"import",moduleName:e,functionNames:null}},z=",",G={type:"literal",value:",",description:'","'},O=function(e,t,r){return{type:"import",moduleName:r,functionNames:Sr(e,t,3)}},U=function(e,t){return Sr(e,t,3)},W=function(){return[]},j=function(e,t,r){return{type:t,name:e,default:r}},J=function(e,t){return{type:t,name:e}},Y=function(e,t){return Sr(e,t,1)},H=function(e){return e},K=function(e){return{type:"statements",statements:e}},q="return",Z={type:"literal",value:"return",description:'"return"'},X=function(e){return{type:"return",value:e}},Q="emit",ee={type:"literal",value:"emit",description:'"emit"'},te="[",re={type:"literal",value:"[",description:'"["'},ne="]",ie={type:"literal",value:"]",description:'"]"'},oe=function(e){return{type:"emit",vertices:e}},ae=function(e){return{type:"emit",vertices:[e]}},se=function(e,t){return{name:e,value:t}},ue=function(e,t){return Rr(Sr(e,t,3)).kwargs},le=function(){return{}},ce=function(e,t){return Sr(e,t,4)},pe=function(e){return{type:"expression",expression:e}},he=function(e,t,r){return{type:"declare",variableType:t?t[3]:"auto",variableName:e,initial:r?r[3]:void 0}},de=function(e,t){return{type:"assign",variableName:e,expression:t}},me="for",fe={type:"literal",value:"for",description:'"for"'},ge="in",ve={type:"literal",value:"in",description:'"in"'},ye="..",_e={type:"literal",value:"..",description:'".."'},xe=function(e,t,r,n){return{type:"for",variableName:e,statement:n,start:t,end:r}},be="if",Ce={type:"literal",value:"if",description:'"if"'},we="else",Te={type:"literal",value:"else",description:'"else"'},Ee=function(e,t,r,n){return{type:"if",conditions:[{condition:e,statement:t}].concat(r.map((function(e){return{condition:e[7],statement:e[11]}}))),else:n?n[3]:null}},ke="&&",Pe={type:"literal",value:"&&",description:'"&&"'},Ae="||",Me={type:"literal",value:"||",description:'"||"'},Ve=">=",Be={type:"literal",value:">=",description:'">="'},Se=">",Fe={type:"literal",value:">",description:'">"'},Re="<=",Ne={type:"literal",value:"<=",description:'"<="'},Ie="<",Le={type:"literal",value:"<",description:'"<"'},$e="==",De={type:"literal",value:"==",description:'"=="'},ze="!=",Ge={type:"literal",value:"!=",description:'"!="'},Oe="+",Ue={type:"literal",value:"+",description:'"+"'},We="-",je={type:"literal",value:"-",description:'"-"'},Je="/",Ye={type:"literal",value:"/",description:'"/"'},He="%",Ke={type:"literal",value:"%",description:'"%"'},qe="not",Ze={type:"literal",value:"not",description:'"not"'},Xe=function(e){return Nr({type:"operator",operator:"!",args:[item]})},Qe=function(e,t){return Fr(e,t)},et=function(e){return Nr({type:"operator",operator:"-",args:[e]})},tt=function(e){return{type:"variable",name:e}},rt=".",nt={type:"literal",value:".",description:'"."'},it=function(e,t){return{type:"field",value:e,fieldName:t}},ot=function(e,t){return{type:"function",name:e,args:Rr(t)}},at=function(e){return{value:e}},st=function(e){return{type:"value",valueType:"float",value:e}},ut=function(e){return{type:"value",valueType:"bool",value:e}},lt=function(e){return{type:"value",valueType:"int",value:e}},ct=function(e,t){var r=Sr(e,t,3);return{type:"value",valueType:"Vector"+r.length,value:r}},pt=/^[+\-]/,ht={type:"class",value:"[+-]",description:"[+-]"},dt=/^[0-9]/,mt={type:"class",value:"[0-9]",description:"[0-9]"},ft=function(e){return parseFloat(Br(e))},gt=/^[eE]/,vt={type:"class",value:"[eE]",description:"[eE]"},yt="true",_t={type:"literal",value:"true",description:'"true"'},xt=function(){return!0},bt="false",Ct={type:"literal",value:"false",description:'"false"'},wt=function(){return!1},Tt=/^[a-zA-Z_]/,Et={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},kt=/^[a-zA-Z0-9_]/,Pt={type:"class",value:"[a-zA-Z0-9_]",description:"[a-zA-Z0-9_]"},At=function(e){return Br(e)},Mt=/^[ \t\n]/,Vt={type:"class",value:"[ \\t\\n]",description:"[ \\t\\n]"},Bt=function(){return" "},St=0,Ft=[{line:1,column:1,seenCR:!1}],Rt=0,Nt=[],It=0;if("startRule"in n){if(!(n.startRule in o))throw new Error("Can't start parsing from rule \""+n.startRule+'".');a=o[n.startRule]}function Lt(e){var r,n,i=Ft[e];if(i)return i;for(r=e-1;!Ft[r];)r--;for(i={line:(i=Ft[r]).line,column:i.column,seenCR:i.seenCR};r<e;)"\n"===(n=t.charAt(r))?(i.seenCR||i.line++,i.column=1,i.seenCR=!1):"\r"===n||"\u2028"===n||"\u2029"===n?(i.line++,i.column=1,i.seenCR=!0):(i.column++,i.seenCR=!1),r++;return Ft[e]=i,i}function $t(e,t){var r=Lt(e),n=Lt(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function Dt(e){St<Rt||(St>Rt&&(Rt=St,Nt=[]),Nt.push(e))}function zt(t,r,n,i){return null!==r&&function(e){var t=1;for(e.sort((function(e,t){return e.description<t.description?-1:e.description>t.description?1:0}));t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(r),new e(null!==t?t:function(e,t){var r,n=new Array(e.length);for(r=0;r<e.length;r++)n[r]=e[r].description;return"Expected "+(e.length>1?n.slice(0,-1).join(", ")+" or "+n[e.length-1]:n[0])+" but "+(t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,(function(e){return"\\x0"+t(e)})).replace(/[\x10-\x1F\x80-\xFF]/g,(function(e){return"\\x"+t(e)})).replace(/[\u0100-\u0FFF]/g,(function(e){return"\\u0"+t(e)})).replace(/[\u1000-\uFFFF]/g,(function(e){return"\\u"+t(e)}))}(t)+'"':"end of input")+" found."}(r,n),r,n,i)}function Gt(){var e,t,r,n,o;if(e=St,Mr()!==i){for(t=[],r=St,(n=Ut())!==i&&(o=Mr())!==i?r=n=[n,o]:(St=r,r=i);r!==i;)t.push(r),r=St,(n=Ut())!==i&&(o=Mr())!==i?r=n=[n,o]:(St=r,r=i);t!==i?e=s(t):(St=e,e=i)}else St=e,e=i;return e}function Ot(){var e,t;return e=St,Mr()!==i&&(t=pr())!==i&&Mr()!==i?e=u(t):(St=e,e=i),e}function Ut(){var e;return(e=Wt())===i&&(e=jt())===i&&(e=Jt()),e}function Wt(){var e,r,n,o,a,s,u,k,P,A,M,V;return e=St,t.substr(St,8)===l?(r=l,St+=8):(r=i,0===It&&Dt(c)),r===i&&(t.substr(St,4)===p?(r=p,St+=4):(r=i,0===It&&Dt(h)),r===i&&(t.substr(St,6)===d?(r=d,St+=6):(r=i,0===It&&Dt(m)))),r!==i&&Vr()!==i&&(n=Ar())!==i&&Mr()!==i?(40===t.charCodeAt(St)?(o=f,St++):(o=i,0===It&&Dt(g)),o!==i&&(a=Yt())!==i?(41===t.charCodeAt(St)?(s=v,St++):(s=i,0===It&&Dt(y)),s!==i?(u=St,(k=Mr())!==i?(58===t.charCodeAt(St)?(P=_,St++):(P=i,0===It&&Dt(x)),P!==i&&(A=Mr())!==i&&(M=Ar())!==i?u=k=[k,P,A,M]:(St=u,u=i)):(St=u,u=i),u===i&&(u=null),u!==i&&(k=Mr())!==i?(123===t.charCodeAt(St)?(P=b,St++):(P=i,0===It&&Dt(C)),P!==i&&(A=Mr())!==i&&(M=Kt())!==i&&Mr()!==i?(125===t.charCodeAt(St)?(V=w,St++):(V=i,0===It&&Dt(T)),V!==i?e=r=E(r,n,a,u,M):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)):(St=e,e=i),e}function jt(){var e,r,n,o,a,s,u,l,c;return e=St,t.substr(St,3)===k?(r=k,St+=3):(r=i,0===It&&Dt(P)),r!==i&&Vr()!==i&&(n=Ar())!==i?(o=St,(a=Mr())!==i?(58===t.charCodeAt(St)?(s=_,St++):(s=i,0===It&&Dt(x)),s!==i&&(u=Mr())!==i&&(l=Ar())!==i?o=a=[a,s,u,l]:(St=o,o=i)):(St=o,o=i),o===i&&(o=null),o!==i?(a=St,(s=Mr())!==i?(61===t.charCodeAt(St)?(u=A,St++):(u=i,0===It&&Dt(M)),u!==i&&(l=Mr())!==i&&(c=Tr())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i),a===i&&(a=null),a!==i&&(s=Mr())!==i?(59===t.charCodeAt(St)?(u=V,St++):(u=i,0===It&&Dt(B)),u!==i?e=r=S(n,o,a):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)):(St=e,e=i),e}function Jt(){var e,r,n,o,a,s,u,l,c,p,h,d;if(e=St,t.substr(St,6)===F?(r=F,St+=6):(r=i,0===It&&Dt(R)),r!==i&&Vr()!==i?(42===t.charCodeAt(St)?(n=N,St++):(n=i,0===It&&Dt(I)),n!==i&&Vr()!==i?(t.substr(St,4)===L?(o=L,St+=4):(o=i,0===It&&Dt($)),o!==i&&(a=Vr())!==i&&(s=Ar())!==i&&(u=Mr())!==i?(59===t.charCodeAt(St)?(l=V,St++):(l=i,0===It&&Dt(B)),l!==i?e=r=D(s):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)):(St=e,e=i),e===i)if(e=St,t.substr(St,6)===F?(r=F,St+=6):(r=i,0===It&&Dt(R)),r!==i)if(Mr()!==i)if(123===t.charCodeAt(St)?(n=b,St++):(n=i,0===It&&Dt(C)),n!==i)if(Mr()!==i)if((o=Ar())!==i){for(a=[],s=St,(u=Mr())!==i?(44===t.charCodeAt(St)?(l=z,St++):(l=i,0===It&&Dt(G)),l!==i&&(c=Mr())!==i&&(p=Ar())!==i?s=u=[u,l,c,p]:(St=s,s=i)):(St=s,s=i);s!==i;)a.push(s),s=St,(u=Mr())!==i?(44===t.charCodeAt(St)?(l=z,St++):(l=i,0===It&&Dt(G)),l!==i&&(c=Mr())!==i&&(p=Ar())!==i?s=u=[u,l,c,p]:(St=s,s=i)):(St=s,s=i);a!==i&&(s=Mr())!==i?(125===t.charCodeAt(St)?(u=w,St++):(u=i,0===It&&Dt(T)),u!==i&&(l=Mr())!==i?(t.substr(St,4)===L?(c=L,St+=4):(c=i,0===It&&Dt($)),c!==i&&(p=Vr())!==i&&(h=Ar())!==i&&Mr()!==i?(59===t.charCodeAt(St)?(d=V,St++):(d=i,0===It&&Dt(B)),d!==i?e=r=O(o,a,h):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)}else St=e,e=i;else St=e,e=i;else St=e,e=i;else St=e,e=i;else St=e,e=i;return e}function Yt(){var e,r,n,o,a,s,u,l,c;if(e=St,(r=Mr())!==i)if((n=Ht())!==i){for(o=[],a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=Ht())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);a!==i;)o.push(a),a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=Ht())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);o!==i&&(a=Mr())!==i?e=r=U(n,o):(St=e,e=i)}else St=e,e=i;else St=e,e=i;return e===i&&(e=St,(r=Mr())!==i&&(r=W()),e=r),e}function Ht(){var e,r,n,o,a,s;return e=St,(r=Ar())!==i&&Mr()!==i?(58===t.charCodeAt(St)?(n=_,St++):(n=i,0===It&&Dt(x)),n!==i&&Mr()!==i&&(o=Ar())!==i&&Mr()!==i?(61===t.charCodeAt(St)?(a=A,St++):(a=i,0===It&&Dt(M)),a!==i&&Mr()!==i&&(s=Tr())!==i?e=r=j(r,o,s):(St=e,e=i)):(St=e,e=i)):(St=e,e=i),e===i&&(e=St,(r=Ar())!==i&&Mr()!==i?(58===t.charCodeAt(St)?(n=_,St++):(n=i,0===It&&Dt(x)),n!==i&&Mr()!==i&&(o=Ar())!==i?e=r=J(r,o):(St=e,e=i)):(St=e,e=i)),e}function Kt(){var e,t,r,n,o,a;if(e=St,(t=qt())!==i){for(r=[],n=St,(o=Mr())!==i&&(a=qt())!==i?n=o=[o,a]:(St=n,n=i);n!==i;)r.push(n),n=St,(o=Mr())!==i&&(a=qt())!==i?n=o=[o,a]:(St=n,n=i);r!==i?e=t=Y(t,r):(St=e,e=i)}else St=e,e=i;return e===i&&(e=St,(t=Mr())!==i&&(t=W()),e=t),e}function qt(){var e,r,n,o;return e=St,(r=Zt())===i&&(r=Xt())===i&&(r=nr())===i&&(r=ir())===i&&(r=rr()),r!==i&&Mr()!==i?(59===t.charCodeAt(St)?(n=V,St++):(n=i,0===It&&Dt(B)),n!==i?e=r=H(r):(St=e,e=i)):(St=e,e=i),e===i&&(e=or())===i&&(e=ar())===i&&(e=St,123===t.charCodeAt(St)?(r=b,St++):(r=i,0===It&&Dt(C)),r!==i&&Mr()!==i&&(n=Kt())!==i&&Mr()!==i?(125===t.charCodeAt(St)?(o=w,St++):(o=i,0===It&&Dt(T)),o!==i?e=r=K(n):(St=e,e=i)):(St=e,e=i)),e}function Zt(){var e,r,n;return e=St,t.substr(St,6)===q?(r=q,St+=6):(r=i,0===It&&Dt(Z)),r!==i&&Vr()!==i&&(n=pr())!==i?e=r=X(n):(St=e,e=i),e}function Xt(){var e,r,n,o,a;return e=St,t.substr(St,4)===Q?(r=Q,St+=4):(r=i,0===It&&Dt(ee)),r!==i&&Mr()!==i?(91===t.charCodeAt(St)?(n=te,St++):(n=i,0===It&&Dt(re)),n!==i&&(o=tr())!==i?(93===t.charCodeAt(St)?(a=ne,St++):(a=i,0===It&&Dt(ie)),a!==i?e=r=oe(o):(St=e,e=i)):(St=e,e=i)):(St=e,e=i),e===i&&(e=St,t.substr(St,4)===Q?(r=Q,St+=4):(r=i,0===It&&Dt(ee)),r!==i&&Mr()!==i?(123===t.charCodeAt(St)?(n=b,St++):(n=i,0===It&&Dt(C)),n!==i&&(o=er())!==i?(125===t.charCodeAt(St)?(a=w,St++):(a=i,0===It&&Dt(T)),a!==i?e=r=ae(o):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)),e}function Qt(){var e,r,n,o;return e=St,(r=Ar())!==i&&Mr()!==i?(58===t.charCodeAt(St)?(n=_,St++):(n=i,0===It&&Dt(x)),n!==i&&Mr()!==i&&(o=pr())!==i?e=r=se(r,o):(St=e,e=i)):(St=e,e=i),e}function er(){var e,r,n,o,a,s,u,l,c;if(e=St,(r=Mr())!==i)if((n=Qt())!==i){for(o=[],a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=Qt())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);a!==i;)o.push(a),a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=Qt())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);o!==i&&(a=Mr())!==i?e=r=ue(n,o):(St=e,e=i)}else St=e,e=i;else St=e,e=i;return e===i&&(e=St,(r=Mr())!==i&&(r=le()),e=r),e}function tr(){var e,r,n,o,a,s,u,l,c,p,h,d,m;if(e=St,(r=Mr())!==i)if(123===t.charCodeAt(St)?(n=b,St++):(n=i,0===It&&Dt(C)),n!==i)if((o=er())!==i)if(125===t.charCodeAt(St)?(a=w,St++):(a=i,0===It&&Dt(T)),a!==i){for(s=[],u=St,(l=Mr())!==i?(44===t.charCodeAt(St)?(c=z,St++):(c=i,0===It&&Dt(G)),c!==i&&(p=Mr())!==i?(123===t.charCodeAt(St)?(h=b,St++):(h=i,0===It&&Dt(C)),h!==i&&(d=er())!==i?(125===t.charCodeAt(St)?(m=w,St++):(m=i,0===It&&Dt(T)),m!==i?u=l=[l,c,p,h,d,m]:(St=u,u=i)):(St=u,u=i)):(St=u,u=i)):(St=u,u=i);u!==i;)s.push(u),u=St,(l=Mr())!==i?(44===t.charCodeAt(St)?(c=z,St++):(c=i,0===It&&Dt(G)),c!==i&&(p=Mr())!==i?(123===t.charCodeAt(St)?(h=b,St++):(h=i,0===It&&Dt(C)),h!==i&&(d=er())!==i?(125===t.charCodeAt(St)?(m=w,St++):(m=i,0===It&&Dt(T)),m!==i?u=l=[l,c,p,h,d,m]:(St=u,u=i)):(St=u,u=i)):(St=u,u=i)):(St=u,u=i);s!==i&&(u=Mr())!==i?e=r=ce(o,s):(St=e,e=i)}else St=e,e=i;else St=e,e=i;else St=e,e=i;else St=e,e=i;return e===i&&(e=St,(r=Mr())!==i&&(r=W()),e=r),e}function rr(){var e;return(e=pr())!==i&&(e=pe(e)),e}function nr(){var e,r,n,o,a,s,u,l,c;return e=St,t.substr(St,3)===k?(r=k,St+=3):(r=i,0===It&&Dt(P)),r!==i&&Vr()!==i&&(n=Ar())!==i?(o=St,(a=Mr())!==i?(58===t.charCodeAt(St)?(s=_,St++):(s=i,0===It&&Dt(x)),s!==i&&(u=Mr())!==i&&(l=Ar())!==i?o=a=[a,s,u,l]:(St=o,o=i)):(St=o,o=i),o===i&&(o=null),o!==i?(a=St,(s=Mr())!==i?(61===t.charCodeAt(St)?(u=A,St++):(u=i,0===It&&Dt(M)),u!==i&&(l=Mr())!==i&&(c=pr())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i),a===i&&(a=null),a!==i?e=r=he(n,o,a):(St=e,e=i)):(St=e,e=i)):(St=e,e=i),e}function ir(){var e,r,n,o;return e=St,(r=Ar())!==i&&Mr()!==i?(61===t.charCodeAt(St)?(n=A,St++):(n=i,0===It&&Dt(M)),n!==i&&Mr()!==i&&(o=pr())!==i?e=r=de(r,o):(St=e,e=i)):(St=e,e=i),e}function or(){var e,r,n,o,a,s,u,l,c,p;return e=St,t.substr(St,3)===me?(r=me,St+=3):(r=i,0===It&&Dt(fe)),r!==i&&Mr()!==i?(40===t.charCodeAt(St)?(n=f,St++):(n=i,0===It&&Dt(g)),n!==i&&Mr()!==i&&(o=Ar())!==i&&Mr()!==i?(t.substr(St,2)===ge?(a=ge,St+=2):(a=i,0===It&&Dt(ve)),a!==i&&Mr()!==i&&(s=Er())!==i&&Mr()!==i?(t.substr(St,2)===ye?(u=ye,St+=2):(u=i,0===It&&Dt(_e)),u!==i&&Mr()!==i&&(l=Er())!==i&&Mr()!==i?(41===t.charCodeAt(St)?(c=v,St++):(c=i,0===It&&Dt(y)),c!==i&&Mr()!==i&&(p=qt())!==i?e=r=xe(o,s,l,p):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)):(St=e,e=i)):(St=e,e=i),e}function ar(){var e,r,n,o,a,s,u,l,c,p,h,d,m,_,x,b,C,w,T,E;if(e=St,t.substr(St,2)===be?(r=be,St+=2):(r=i,0===It&&Dt(Ce)),r!==i)if(Mr()!==i)if(40===t.charCodeAt(St)?(n=f,St++):(n=i,0===It&&Dt(g)),n!==i)if(Mr()!==i)if((o=pr())!==i)if(Mr()!==i)if(41===t.charCodeAt(St)?(a=v,St++):(a=i,0===It&&Dt(y)),a!==i)if(Mr()!==i)if((s=qt())!==i){for(u=[],l=St,(c=Mr())!==i?(t.substr(St,4)===we?(p=we,St+=4):(p=i,0===It&&Dt(Te)),p!==i&&(h=Vr())!==i?(t.substr(St,2)===be?(d=be,St+=2):(d=i,0===It&&Dt(Ce)),d!==i&&(m=Mr())!==i?(40===t.charCodeAt(St)?(_=f,St++):(_=i,0===It&&Dt(g)),_!==i&&(x=Mr())!==i&&(b=pr())!==i&&(C=Mr())!==i?(41===t.charCodeAt(St)?(w=v,St++):(w=i,0===It&&Dt(y)),w!==i&&(T=Mr())!==i&&(E=qt())!==i?l=c=[c,p,h,d,m,_,x,b,C,w,T,E]:(St=l,l=i)):(St=l,l=i)):(St=l,l=i)):(St=l,l=i)):(St=l,l=i);l!==i;)u.push(l),l=St,(c=Mr())!==i?(t.substr(St,4)===we?(p=we,St+=4):(p=i,0===It&&Dt(Te)),p!==i&&(h=Vr())!==i?(t.substr(St,2)===be?(d=be,St+=2):(d=i,0===It&&Dt(Ce)),d!==i&&(m=Mr())!==i?(40===t.charCodeAt(St)?(_=f,St++):(_=i,0===It&&Dt(g)),_!==i&&(x=Mr())!==i&&(b=pr())!==i&&(C=Mr())!==i?(41===t.charCodeAt(St)?(w=v,St++):(w=i,0===It&&Dt(y)),w!==i&&(T=Mr())!==i&&(E=qt())!==i?l=c=[c,p,h,d,m,_,x,b,C,w,T,E]:(St=l,l=i)):(St=l,l=i)):(St=l,l=i)):(St=l,l=i)):(St=l,l=i);u!==i?(l=St,(c=Mr())!==i?(t.substr(St,4)===we?(p=we,St+=4):(p=i,0===It&&Dt(Te)),p!==i&&(h=Mr())!==i&&(d=qt())!==i?l=c=[c,p,h,d]:(St=l,l=i)):(St=l,l=i),l===i&&(l=null),l!==i?e=r=Ee(o,s,u,l):(St=e,e=i)):(St=e,e=i)}else St=e,e=i;else St=e,e=i;else St=e,e=i;else St=e,e=i;else St=e,e=i;else St=e,e=i;else St=e,e=i;else St=e,e=i;else St=e,e=i;return e}function sr(){var e;return t.substr(St,2)===ke?(e=ke,St+=2):(e=i,0===It&&Dt(Pe)),e===i&&(t.substr(St,2)===Ae?(e=Ae,St+=2):(e=i,0===It&&Dt(Me))),e}function ur(){var e;return t.substr(St,2)===Ve?(e=Ve,St+=2):(e=i,0===It&&Dt(Be)),e===i&&(62===t.charCodeAt(St)?(e=Se,St++):(e=i,0===It&&Dt(Fe)),e===i&&(t.substr(St,2)===Re?(e=Re,St+=2):(e=i,0===It&&Dt(Ne)),e===i&&(60===t.charCodeAt(St)?(e=Ie,St++):(e=i,0===It&&Dt(Le)),e===i&&(t.substr(St,2)===$e?(e=$e,St+=2):(e=i,0===It&&Dt(De)),e===i&&(t.substr(St,2)===ze?(e=ze,St+=2):(e=i,0===It&&Dt(Ge))))))),e}function lr(){var e;return 43===t.charCodeAt(St)?(e=Oe,St++):(e=i,0===It&&Dt(Ue)),e===i&&(45===t.charCodeAt(St)?(e=We,St++):(e=i,0===It&&Dt(je))),e}function cr(){var e;return 42===t.charCodeAt(St)?(e=N,St++):(e=i,0===It&&Dt(I)),e===i&&(47===t.charCodeAt(St)?(e=Je,St++):(e=i,0===It&&Dt(Ye)),e===i&&(37===t.charCodeAt(St)?(e=He,St++):(e=i,0===It&&Dt(Ke)))),e}function pr(){var e,r,n,o,a,s,u,l;if(e=St,t.substr(St,3)===qe?(r=qe,St+=3):(r=i,0===It&&Dt(Ze)),r!==i&&(n=Mr())!==i&&(o=pr())!==i?e=r=Xe(o):(St=e,e=i),e===i)if(e=St,(r=hr())!==i){for(n=[],o=St,(a=Mr())!==i&&(s=sr())!==i&&(u=Mr())!==i&&(l=hr())!==i?o=a=[a,s,u,l]:(St=o,o=i);o!==i;)n.push(o),o=St,(a=Mr())!==i&&(s=sr())!==i&&(u=Mr())!==i&&(l=hr())!==i?o=a=[a,s,u,l]:(St=o,o=i);n!==i?e=r=Qe(r,n):(St=e,e=i)}else St=e,e=i;return e}function hr(){var e,t,r,n,o,a,s,u;if(e=St,(t=dr())!==i){for(r=[],n=St,(o=Mr())!==i&&(a=ur())!==i&&(s=Mr())!==i&&(u=dr())!==i?n=o=[o,a,s,u]:(St=n,n=i);n!==i;)r.push(n),n=St,(o=Mr())!==i&&(a=ur())!==i&&(s=Mr())!==i&&(u=dr())!==i?n=o=[o,a,s,u]:(St=n,n=i);r!==i?e=t=Qe(t,r):(St=e,e=i)}else St=e,e=i;return e===i&&(e=dr()),e}function dr(){var e,t,r,n,o,a,s,u;if(e=St,(t=mr())!==i){for(r=[],n=St,(o=Mr())!==i&&(a=lr())!==i&&(s=Mr())!==i&&(u=mr())!==i?n=o=[o,a,s,u]:(St=n,n=i);n!==i;)r.push(n),n=St,(o=Mr())!==i&&(a=lr())!==i&&(s=Mr())!==i&&(u=mr())!==i?n=o=[o,a,s,u]:(St=n,n=i);r!==i?e=t=Qe(t,r):(St=e,e=i)}else St=e,e=i;return e===i&&(e=mr()),e}function mr(){var e,t,r,n,o,a,s,u;if(e=St,(t=fr())!==i){for(r=[],n=St,(o=Mr())!==i&&(a=cr())!==i&&(s=Mr())!==i&&(u=fr())!==i?n=o=[o,a,s,u]:(St=n,n=i);n!==i;)r.push(n),n=St,(o=Mr())!==i&&(a=cr())!==i&&(s=Mr())!==i&&(u=fr())!==i?n=o=[o,a,s,u]:(St=n,n=i);r!==i?e=t=Qe(t,r):(St=e,e=i)}else St=e,e=i;return e===i&&(e=fr()),e}function fr(){var e,r,n;return e=St,45===t.charCodeAt(St)?(r=We,St++):(r=i,0===It&&Dt(je)),r!==i&&Mr()!==i&&(n=vr())!==i?e=r=et(n):(St=e,e=i),e===i&&(e=vr()),e}function gr(){var e,r,n,o;return e=St,40===t.charCodeAt(St)?(r=f,St++):(r=i,0===It&&Dt(g)),r!==i&&Mr()!==i&&(n=pr())!==i&&Mr()!==i?(41===t.charCodeAt(St)?(o=v,St++):(o=i,0===It&&Dt(y)),o!==i?e=r=u(n):(St=e,e=i)):(St=e,e=i),e}function vr(){var e;return(e=xr())===i&&(e=_r())===i&&(e=yr())===i&&(e=wr())===i&&(e=gr()),e}function yr(){var e;return(e=Ar())!==i&&(e=tt(e)),e}function _r(){var e,r,n,o;return e=St,(r=xr())===i&&(r=yr())===i&&(r=gr()),r!==i?(46===t.charCodeAt(St)?(n=rt,St++):(n=i,0===It&&Dt(nt)),n!==i&&(o=Ar())!==i?e=r=it(r,o):(St=e,e=i)):(St=e,e=i),e}function xr(){var e,r,n,o,a;return e=St,(r=Ar())!==i&&Mr()!==i?(40===t.charCodeAt(St)?(n=f,St++):(n=i,0===It&&Dt(g)),n!==i&&(o=br())!==i?(41===t.charCodeAt(St)?(a=v,St++):(a=i,0===It&&Dt(y)),a!==i?e=r=ot(r,o):(St=e,e=i)):(St=e,e=i)):(St=e,e=i),e}function br(){var e,r,n,o,a,s,u,l,c;if(e=St,(r=Mr())!==i)if((n=Cr())!==i){for(o=[],a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=Cr())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);a!==i;)o.push(a),a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=Cr())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);o!==i&&(a=Mr())!==i?e=r=U(n,o):(St=e,e=i)}else St=e,e=i;else St=e,e=i;return e===i&&(e=St,(r=Mr())!==i&&(r=W()),e=r),e}function Cr(){var e,r,n,o;return e=St,(r=Ar())!==i&&Mr()!==i?(61===t.charCodeAt(St)?(n=A,St++):(n=i,0===It&&Dt(M)),n!==i&&Mr()!==i&&(o=pr())!==i?e=r=se(r,o):(St=e,e=i)):(St=e,e=i),e===i&&(e=St,(r=pr())!==i&&(r=at(r)),e=r),e}function wr(){var e,r,n,o,a,s,u,l,c;if(e=St,(r=kr())!==i&&(r=st(r)),(e=r)===i&&(e=St,(r=Er())!==i&&(r=ut(r)),(e=r)===i&&(e=St,(r=Pr())!==i&&(r=lt(r)),(e=r)===i)))if(e=St,91===t.charCodeAt(St)?(r=te,St++):(r=i,0===It&&Dt(re)),r!==i)if(Mr()!==i)if((n=kr())!==i){for(o=[],a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=kr())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);a!==i;)o.push(a),a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=kr())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);o!==i&&(a=Mr())!==i?(93===t.charCodeAt(St)?(s=ne,St++):(s=i,0===It&&Dt(ie)),s!==i?e=r=ct(n,o):(St=e,e=i)):(St=e,e=i)}else St=e,e=i;else St=e,e=i;else St=e,e=i;return e}function Tr(){var e,r,n,o,a,s,u,l,c;if((e=kr())===i&&(e=Er())===i&&(e=Pr())===i)if(e=St,91===t.charCodeAt(St)?(r=te,St++):(r=i,0===It&&Dt(re)),r!==i)if(Mr()!==i)if((n=kr())!==i){for(o=[],a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=kr())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);a!==i;)o.push(a),a=St,(s=Mr())!==i?(44===t.charCodeAt(St)?(u=z,St++):(u=i,0===It&&Dt(G)),u!==i&&(l=Mr())!==i&&(c=kr())!==i?a=s=[s,u,l,c]:(St=a,a=i)):(St=a,a=i);o!==i&&(a=Mr())!==i?(93===t.charCodeAt(St)?(s=ne,St++):(s=i,0===It&&Dt(ie)),s!==i?e=r=U(n,o):(St=e,e=i)):(St=e,e=i)}else St=e,e=i;else St=e,e=i;else St=e,e=i;return e}function Er(){var e,r,n,o;if(e=St,pt.test(t.charAt(St))?(r=t.charAt(St),St++):(r=i,0===It&&Dt(ht)),r===i&&(r=null),r!==i){if(n=[],dt.test(t.charAt(St))?(o=t.charAt(St),St++):(o=i,0===It&&Dt(mt)),o!==i)for(;o!==i;)n.push(o),dt.test(t.charAt(St))?(o=t.charAt(St),St++):(o=i,0===It&&Dt(mt));else n=i;n!==i?e=r=[r,n]:(St=e,e=i)}else St=e,e=i;return e!==i&&(e=ft(e)),e}function kr(){var e,r,n,o,a,s,u,l,c;if(e=St,pt.test(t.charAt(St))?(r=t.charAt(St),St++):(r=i,0===It&&Dt(ht)),r===i&&(r=null),r!==i){if(n=[],dt.test(t.charAt(St))?(o=t.charAt(St),St++):(o=i,0===It&&Dt(mt)),o!==i)for(;o!==i;)n.push(o),dt.test(t.charAt(St))?(o=t.charAt(St),St++):(o=i,0===It&&Dt(mt));else n=i;if(n!==i){if(o=St,46===t.charCodeAt(St)?(a=rt,St++):(a=i,0===It&&Dt(nt)),a!==i){if(s=[],dt.test(t.charAt(St))?(u=t.charAt(St),St++):(u=i,0===It&&Dt(mt)),u!==i)for(;u!==i;)s.push(u),dt.test(t.charAt(St))?(u=t.charAt(St),St++):(u=i,0===It&&Dt(mt));else s=i;s!==i?o=a=[a,s]:(St=o,o=i)}else St=o,o=i;if(o===i&&(o=null),o!==i){if(a=St,gt.test(t.charAt(St))?(s=t.charAt(St),St++):(s=i,0===It&&Dt(vt)),s!==i)if(pt.test(t.charAt(St))?(u=t.charAt(St),St++):(u=i,0===It&&Dt(ht)),u===i&&(u=null),u!==i){if(l=[],dt.test(t.charAt(St))?(c=t.charAt(St),St++):(c=i,0===It&&Dt(mt)),c!==i)for(;c!==i;)l.push(c),dt.test(t.charAt(St))?(c=t.charAt(St),St++):(c=i,0===It&&Dt(mt));else l=i;l!==i?a=s=[s,u,l]:(St=a,a=i)}else St=a,a=i;else St=a,a=i;a===i&&(a=null),a!==i?e=r=[r,n,o,a]:(St=e,e=i)}else St=e,e=i}else St=e,e=i}else St=e,e=i;return e!==i&&(e=ft(e)),e}function Pr(){var e,r;return e=St,t.substr(St,4)===yt?(r=yt,St+=4):(r=i,0===It&&Dt(_t)),r!==i&&(r=xt()),(e=r)===i&&(e=St,t.substr(St,5)===bt?(r=bt,St+=5):(r=i,0===It&&Dt(Ct)),r!==i&&(r=wt()),e=r),e}function Ar(){var e,r,n,o;if(e=St,Tt.test(t.charAt(St))?(r=t.charAt(St),St++):(r=i,0===It&&Dt(Et)),r!==i){for(n=[],kt.test(t.charAt(St))?(o=t.charAt(St),St++):(o=i,0===It&&Dt(Pt));o!==i;)n.push(o),kt.test(t.charAt(St))?(o=t.charAt(St),St++):(o=i,0===It&&Dt(Pt));n!==i?e=r=[r,n]:(St=e,e=i)}else St=e,e=i;return e!==i&&(e=At(e)),e}function Mr(){var e,r;for(e=[],Mt.test(t.charAt(St))?(r=t.charAt(St),St++):(r=i,0===It&&Dt(Vt));r!==i;)e.push(r),Mt.test(t.charAt(St))?(r=t.charAt(St),St++):(r=i,0===It&&Dt(Vt));return e!==i&&(e=Bt()),e}function Vr(){var e,r;if(e=[],Mt.test(t.charAt(St))?(r=t.charAt(St),St++):(r=i,0===It&&Dt(Vt)),r!==i)for(;r!==i;)e.push(r),Mt.test(t.charAt(St))?(r=t.charAt(St),St++):(r=i,0===It&&Dt(Vt));else e=i;return e!==i&&(e=Bt()),e}function Br(e){if(e instanceof Array){for(var t="",r=0;r<e.length;r++)t+=Br(e[r]);return t}return e||""}function Sr(e,t,r){return t?[e].concat(t.map((function(e){return e[r]}))):[e]}function Fr(e,t){var r=e;return t.forEach((function(e){var t=e[1],n=e[3];r=Nr({type:"operator",operator:t,args:[r,n]})})),r}function Rr(e){var t={args:[],kwargs:{}};return e.forEach((function(e){void 0!==e.name?t.kwargs[e.name]=e.value:t.args.push(e.value)})),t}function Nr(e){return{type:"function",name:"@"+e.operator,args:{args:e.args,kwargs:{}}}}if((r=a())!==i&&St===t.length)return r;throw r!==i&&St<t.length&&Dt({type:"end",description:"end of input"}),zt(null,Nt,Rt<t.length?t.charAt(Rt):null,Rt<t.length?$t(Rt,Rt+1):$t(Rt,Rt))}}}()},{}],10:[function(e,t,r){"use strict";var n=e("../exceptions"),i=e("../utils/utils"),o=e("../intrinsics/intrinsics"),a=function(){function e(){this._variables=new i.Dictionary}return e.prototype.get=function(e){if(!this._variables.has(e))throw new n.RuntimeError("'"+e+"' is undefined.");return this._variables.get(e)},e.prototype.set=function(e,t){this._variables.set(e,t)},e.prototype.evaluateExpression=function(e){var t=this;switch(e.type){case"function":var r=(a=e).arguments.map((function(e){return t.evaluateExpression(e)})),i=o.getIntrinsicFunction(a.functionName);if(!i)throw new n.RuntimeError("function '"+a.functionName+"' is undefined.");return i.javascriptImplementation.apply(i,r);case"field":var a=e,s=this.evaluateExpression(a.value);switch(a.fieldName){case"x":return s[0];case"y":return s[1];case"z":return s[2];case"w":return s[3];case"r":return s[0];case"g":return s[1];case"b":return s[2];case"a":return s[3]}throw new n.RuntimeError("invalid field.");case"constant":return(a=e).value;case"variable":return a=e,this.get(a.variableName)}},e.prototype.evaluateStatement=function(e){switch(e.type){case"assign":var t=e;return this.set(t.variableName,this.evaluateExpression(t.expression)),[];case"condition":return t=e,0!=this.evaluateExpression(t.condition)?this.evaluateStatements(t.trueStatements):this.evaluateStatements(t.falseStatements);case"emit":t=e;var r={};for(var n in t.attributes){var i=this.evaluateExpression(t.attributes[n]);r[n]=i}return[r]}},e.prototype.evaluateStatements=function(e){for(var t=[],r=0,n=e;r<n.length;r++)for(var i=n[r],o=0,a=this.evaluateStatement(i);o<a.length;o++){var s=a[o];t.push(s)}return t},e.prototype.evaluateMark=function(e,t){for(var r in t)this.set(r,t[r]);return this.evaluateStatements(e.statements)},e}();r.Context=a},{"../exceptions":11,"../intrinsics/intrinsics":12,"../utils/utils":26}],11:[function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=function(e){function t(t){e.call(this,t),this.stack=new Error(t).stack}return n(t,e),t}(Error);r.BaseError=i;var o=function(e){function t(t,r,n){e.call(this,t),this.name="ParseError",this.message=t,this.start=r,this.end=n}return n(t,e),t}(i);r.ParseError=o;var a=function(e){function t(t,r,n){e.call(this,t),this.name="CompileError",this.message=t,this.start=r,this.end=n}return n(t,e),t}(i);r.CompileError=a;var s=function(e){function t(t,r,n){e.call(this,t),this.name="RuntimeError",this.message=t,this.start=r,this.end=n}return n(t,e),t}(i);r.RuntimeError=s},{}],12:[function(e,t,r){"use strict";var n=e("../utils/utils"),i=e("../math/math"),o=new n.Dictionary,a=[],s=new n.Dictionary,u=new n.Dictionary;function l(e){return"@"+e.name+":"+e.argTypes.join(",")+":"+e.returnType}function c(e){e.internalName=l(e),o.set(e.internalName,e),a.push(e)}function p(e,t,r){var n={name:e,type:t,value:r};u.set(e,n)}function h(e,t,r,n){var i={name:"cast:"+e+":"+t,argTypes:[e],returnType:t,javascriptImplementation:n};c(i),s.set(e+":"+t,{internalName:i.internalName,rank:r})}function d(e,t,r,n){c({name:e,argTypes:t,returnType:r,javascriptImplementation:n})}function m(e,t,r,n){c({name:"@"+e,argTypes:t,returnType:r,javascriptImplementation:n})}function f(){throw new Error("not implemented")}r.getInternalName=l,r.getIntrinsicFunction=function(e){return o.has(e)||console.log(e),o.get(e)},r.forEachIntrinsicFunction=function(e){a.forEach(e)},r.addIntrinsicFunction=c,r.addConstant=p,r.forEachConstant=function(e){u.forEach(e)},r.forEachTypeConversion=function(e){s.forEach(e)},r.getTypeConversion=function(e,t){return s.get(e+":"+t)};var g=function(e,t,r){return d(e,t,e,r)};m("+",["float","float"],"float",(function(e,t){return e+t})),m("-",["float","float"],"float",(function(e,t){return e-t})),m("*",["float","float"],"float",(function(e,t){return e*t})),m("/",["float","float"],"float",(function(e,t){return e/t})),m("+",["float"],"float",(function(e){return+e})),m("-",["float"],"float",(function(e){return-e})),m("%",["int","int"],"int",(function(e,t){return e%t})),m("%",["float","float"],"float",(function(e,t){return e%t})),m("+",["int","int"],"int",(function(e,t){return e+t})),m("-",["int","int"],"int",(function(e,t){return e-t})),m("*",["int","int"],"int",(function(e,t){return e*t})),m("/",["int","int"],"int",(function(e,t){return e/t})),m("+",["int"],"int",(function(e){return+e})),m("-",["int"],"int",(function(e){return-e})),m("+",["Vector2","Vector2"],"Vector2",(function(e,t){return[e[0]+t[0],e[1]+t[1]]})),m("-",["Vector2","Vector2"],"Vector2",(function(e,t){return[e[0]-t[0],e[1]-t[1]]})),m("*",["Vector2","Vector2"],"Vector2",(function(e,t){return[e[0]*t[0],e[1]*t[1]]})),m("/",["Vector2","Vector2"],"Vector2",(function(e,t){return[e[0]/t[0],e[1]/t[1]]})),m("+",["Vector2"],"Vector2",(function(e){return e})),m("-",["Vector2"],"Vector2",(function(e){return[-e[0],-e[1]]})),m("+",["Vector3","Vector3"],"Vector3",(function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]})),m("-",["Vector3","Vector3"],"Vector3",(function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]})),m("*",["Vector3","Vector3"],"Vector3",(function(e,t){return[e[0]*t[0],e[1]*t[1],e[2]*t[2]]})),m("/",["Vector3","Vector3"],"Vector3",(function(e,t){return[e[0]/t[0],e[1]/t[1],e[2]/t[2]]})),m("+",["Vector3"],"Vector3",(function(e){return e})),m("-",["Vector3"],"Vector3",(function(e){return[-e[0],-e[1],-e[2]]})),m("+",["Vector4","Vector4"],"Vector4",(function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2],e[3]+t[3]]})),m("-",["Vector4","Vector4"],"Vector4",(function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3]]})),m("*",["Vector4","Vector4"],"Vector4",(function(e,t){return[e[0]*t[0],e[1]*t[1],e[2]*t[2],e[3]*t[3]]})),m("/",["Vector4","Vector4"],"Vector4",(function(e,t){return[e[0]/t[0],e[1]/t[1],e[2]/t[2],e[3]/t[3]]})),m("+",["Vector4"],"Vector4",(function(e){return e})),m("-",["Vector4"],"Vector4",(function(e){return[-e[0],-e[1],-e[2],-e[3]]})),m("*",["float","Vector2"],"Vector2",(function(e,t){return[e*t[0],e*t[1]]})),m("*",["Vector2","float"],"Vector2",(function(e,t){return[e[0]*t,e[1]*t]})),m("*",["Vector2","float"],"Vector2",(function(e,t){return[e[0]/t,e[1]/t]})),m("*",["float","Vector3"],"Vector3",(function(e,t){return[e*t[0],e*t[1],e*t[2]]})),m("*",["Vector3","float"],"Vector3",(function(e,t){return[e[0]*t,e[1]*t,e[2]*t]})),m("*",["Vector3","float"],"Vector3",(function(e,t){return[e[0]/t,e[1]/t,e[2]/t]})),m("*",["float","Vector4"],"Vector4",(function(e,t){return[e*t[0],e*t[1],e*t[2],e*t[3]]})),m("*",["Vector4","float"],"Vector4",(function(e,t){return[e[0]*t,e[1]*t,e[2]*t,e[3]*t]})),m("*",["Vector4","float"],"Vector4",(function(e,t){return[e[0]/t,e[1]/t,e[2]/t,e[3]/t]})),m("==",["float","float"],"bool",(function(e,t){return e==t?1:0})),m(">",["float","float"],"bool",(function(e,t){return e>t?1:0})),m("<",["float","float"],"bool",(function(e,t){return e<t?1:0})),m(">=",["float","float"],"bool",(function(e,t){return e>=t?1:0})),m("<=",["float","float"],"bool",(function(e,t){return e<=t?1:0})),m("==",["int","int"],"bool",(function(e,t){return e==t?1:0})),m(">",["int","int"],"bool",(function(e,t){return e>t?1:0})),m("<",["int","int"],"bool",(function(e,t){return e<t?1:0})),m(">=",["int","int"],"bool",(function(e,t){return e>=t?1:0})),m("<=",["int","int"],"bool",(function(e,t){return e<=t?1:0})),m("==",["bool","bool"],"bool",(function(e,t){return e==t?1:0})),m("!",["bool"],"bool",(function(e){return e?0:1})),m("&&",["bool","bool"],"bool",(function(e,t){return e&&t?1:0})),m("||",["bool","bool"],"bool",(function(e,t){return e||t?1:0})),g("Vector2",["float","float"],(function(e,t){return[e,t]})),g("Vector3",["float","float","float"],(function(e,t,r){return[e,t,r]})),g("Vector4",["float","float","float","float"],(function(e,t,r,n){return[e,t,r,n]})),g("Color",["float","float","float","float"],(function(e,t,r,n){return[e,t,r,n]})),g("Quaternion",["float","float","float","float"],(function(e,t,r,n){return[e,t,r,n]})),d("abs",["float"],"float",(function(e){return Math.abs(e)})),d("sqrt",["float"],"float",(function(e){return Math.sqrt(e)})),d("exp",["float"],"float",(function(e){return Math.exp(e)})),d("log",["float"],"float",(function(e){return Math.log(e)})),d("sin",["float"],"float",(function(e){return Math.sin(e)})),d("cos",["float"],"float",(function(e){return Math.cos(e)})),d("tan",["float"],"float",(function(e){return Math.tan(e)})),d("asin",["float"],"float",(function(e){return Math.asin(e)})),d("acos",["float"],"float",(function(e){return Math.acos(e)})),d("atan",["float"],"float",(function(e){return Math.atan(e)})),d("atan2",["float","float"],"float",(function(e,t){return Math.atan2(e,t)})),d("abs",["int"],"int",(function(e){return Math.abs(e)})),d("min",["int","int"],"int",(function(e,t){return Math.min(e,t)})),d("max",["int","int"],"int",(function(e,t){return Math.max(e,t)})),d("min",["float","float"],"float",(function(e,t){return Math.min(e,t)})),d("max",["float","float"],"float",(function(e,t){return Math.max(e,t)})),d("ceil",["float"],"float",(function(e,t){return Math.ceil(e)})),d("floor",["float"],"float",(function(e,t){return Math.floor(e)})),d("mix",["float","float","float"],"float",(function(e,t,r){return e+(t-e)*r})),d("mix",["Vector2","Vector2","float"],"Vector2",null),d("mix",["Vector3","Vector3","float"],"Vector3",null),d("mix",["Vector4","Vector4","float"],"Vector4",null),d("mix",["Color","Color","float"],"Color",null),d("clamp",["float"],"float",(function(e){return Math.max(0,Math.min(1,e))})),d("dot",["Vector2","Vector2"],"float",(function(e,t){return e[0]*t[0]+e[1]*t[1]})),d("dot",["Vector3","Vector3"],"float",(function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]})),d("dot",["Vector4","Vector4"],"float",(function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]})),d("length",["Vector2"],"float",(function(e){return i.Vector2.FromArray(e).normalize().toArray()})),d("length",["Vector3"],"float",(function(e){return i.Vector3.FromArray(e).normalize().toArray()})),d("length",["Vector4"],"float",(function(e){return i.Quaternion.FromArray(e).normalize().toArray()})),d("length",["Quaternion"],"float",(function(e){return i.Quaternion.FromArray(e).normalize().toArray()})),d("normalize",["Vector2"],"Vector2",(function(e){return i.Vector2.FromArray(e).length()})),d("normalize",["Vector3"],"Vector3",(function(e){return i.Vector3.FromArray(e).length()})),d("normalize",["Vector4"],"Vector4",(function(e){return i.Quaternion.FromArray(e).length()})),d("normalize",["Quaternion"],"Quaternion",(function(e){return i.Quaternion.FromArray(e).length()})),d("cross",["Vector3","Vector3"],"Vector3",(function(e,t){return i.Vector3.FromArray(e).cross(i.Vector3.FromArray(t)).toArray()})),d("quat_mul",["Quaternion","Quaternion"],"Quaternion",(function(e,t){return i.Quaternion.FromArray(e).mul(i.Quaternion.FromArray(t)).toArray()})),d("quat_conj",["Quaternion"],"Quaternion",(function(e){return i.Quaternion.FromArray(e).conj().toArray()})),d("quat_slerp",["Quaternion","Quaternion","float"],"Quaternion",(function(e,t,r){return i.Quaternion.Slerp(i.Quaternion.FromArray(e),i.Quaternion.FromArray(t),r).toArray()})),d("quat_rotate",["Quaternion","Vector3"],"Vector3",(function(e,t){return i.Quaternion.FromArray(e).rotate(i.Vector3.FromArray(t)).toArray()})),d("quat_rotation",["Vector3","float"],"Quaternion",(function(e,t){return i.Quaternion.Rotation(i.Vector3.FromArray(e),t).toArray()})),g("Color",["float","float","float","float"],(function(e,t,r,n){return[e,t,r,n]})),g("Color",["float","float","float"],(function(e,t,r){return[e,t,r,1]})),g("Color",["float","float"],(function(e,t){return[e,e,e,t]})),g("Color",["float"],(function(e){return[e,e,e,1]})),d("lab2rgb",["Color"],"Color",(function(e){return e})),d("hcl2rgb",["Color"],"Color",(function(e){return e})),h("bool","int",1,(function(e){return e})),h("int","float",1,(function(e){return e})),d("int",["float"],"int",(function(e){return Math.floor(e)})),d("float",["int"],"float",(function(e){return e})),h("Quaternion","Vector4",0,(function(e){return e})),h("Vector4","Quaternion",0,(function(e){return e})),h("Color","Vector4",0,(function(e){return e})),h("Vector4","Color",0,(function(e){return e})),h("Vector4Array","ColorArray",0,(function(e){return e})),h("ColorArray","Vector4Array",0,(function(e){return e})),h("Vector4Array2D","Image",0,(function(e){return e})),h("Image","Vector4Image",0,(function(e){return e})),p("PI","float",Math.PI),p("SQRT2","float",Math.SQRT2),p("SQRT1_2","float",Math.SQRT1_2),p("RED","Color",[1,0,0,1]),d("array",["FloatArray","float"],"float",f),d("array",["Vector2Array","float"],"Vector2",f),d("array",["Vector3Array","float"],"Vector3",f),d("array",["Vector4Array","float"],"Vector4",f),d("array",["ColorArray","float"],"Color",f),d("image",["Image","Vector2"],"Color",f),d("image",["Vector4Image","Vector2"],"Vector4",f),d("image",["Vector3Image","Vector2"],"Vector3",f),d("image",["Vector2Image","Vector2"],"Vector2",f),d("image",["FloatImage","Vector2"],"float",f)},{"../math/math":18,"../utils/utils":26}],13:[function(e,t,r){"use strict";var n=e("../compiler/parser"),i=e("../utils/utils"),o=new i.Dictionary;function a(e,t){var r=null;o.has(e)?r=o.get(e):(r=new i.Dictionary,o.set(e,r));for(var a=0,s=n.parseFile(t).blocks;a<s.length;a++){var u=s[a];if("function"==u.type){var l=u;r.set(l.name,l)}}}a("P2D",e("./primitives2d").primitives),a("P3D",e("./primitives3d").primitives),r.getModule=function(e){return o.get(e)},r.getModuleFunction=function(e,t){return o.get(e).get(t)},r.forEachModuleFunction=function(e,t){return o.get(e).forEach(t)}},{"../compiler/parser":8,"../utils/utils":26,"./primitives2d":14,"./primitives3d":15}],14:[function(e,t,r){"use strict";r.primitives="\n    mark Triangle(\n        p1: Vector2,\n        p2: Vector2,\n        p3: Vector2,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        emit [\n            { position: p1, color: color },\n            { position: p2, color: color },\n            { position: p3, color: color }\n        ];\n    }\n\n    mark Rectangle(\n        p1: Vector2,\n        p2: Vector2,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        emit [\n            { position: Vector2(p1.x, p1.y), color: color },\n            { position: Vector2(p2.x, p1.y), color: color },\n            { position: Vector2(p2.x, p2.y), color: color }\n        ];\n        emit [\n            { position: Vector2(p1.x, p1.y), color: color },\n            { position: Vector2(p1.x, p2.y), color: color },\n            { position: Vector2(p2.x, p2.y), color: color }\n        ];\n    }\n\n    mark OutlinedRectangle(\n        p1: Vector2,\n        p2: Vector2,\n        width: float = 1,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        Rectangle(p1, Vector2(p1.x + width, p2.y - width), color);\n        Rectangle(Vector2(p1.x, p2.y - width), Vector2(p2.x - width, p2.y), color);\n        Rectangle(Vector2(p1.x + width, p1.y), Vector2(p2.x, p1.y + width), color);\n        Rectangle(Vector2(p2.x - width, p1.y + width), p2, color);\n    }\n\n    mark Hexagon(\n        center: Vector2,\n        radius: float,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        for(i in 0..5) {\n            let a1 = i / 6.0 * PI * 2.0;\n            let a2 = (i + 1) / 6.0 * PI * 2.0;\n            let p1 = Vector2(radius * cos(a1), radius * sin(a1));\n            let p2 = Vector2(radius * cos(a2), radius * sin(a2));\n            emit [\n                { position: center + p1, color: color },\n                { position: center, color: color },\n                { position: center + p2, color: color }\n            ];\n        }\n    }\n\n    mark Circle16(\n        center: Vector2,\n        radius: float,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        for(i in 0..15) {\n            let a1 = i / 16.0 * PI * 2.0;\n            let a2 = (i + 1) / 16.0 * PI * 2.0;\n            let p1 = Vector2(radius * cos(a1), radius * sin(a1));\n            let p2 = Vector2(radius * cos(a2), radius * sin(a2));\n            emit [\n                { position: center + p1, color: color },\n                { position: center, color: color },\n                { position: center + p2, color: color }\n            ];\n        }\n    }\n\n    mark Circle(\n        center: Vector2,\n        radius: float,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        for(i in 0..31) {\n            let a1 = i / 32.0 * PI * 2.0;\n            let a2 = (i + 1) / 32.0 * PI * 2.0;\n            let p1 = Vector2(radius * cos(a1), radius * sin(a1));\n            let p2 = Vector2(radius * cos(a2), radius * sin(a2));\n            emit [\n                { position: center + p1, color: color },\n                { position: center, color: color },\n                { position: center + p2, color: color }\n            ];\n        }\n    }\n\n    mark Line(\n        p1: Vector2,\n        p2: Vector2,\n        width: float = 1,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        let d = normalize(p2 - p1);\n        let t = Vector2(d.y, -d.x) * (width / 2);\n        emit [\n            { position: p1 + t, color: color },\n            { position: p1 - t, color: color },\n            { position: p2 + t, color: color }\n        ];\n        emit [\n            { position: p1 - t, color: color },\n            { position: p2 - t, color: color },\n            { position: p2 + t, color: color }\n        ];\n    }\n\n    mark Sector2(\n        c: Vector2,\n        p1: Vector2,\n        p2: Vector2,\n        color: Color\n    ) {\n        let pc = c + normalize(p1 + p2 - c - c) * length(p1 - c);\n        Triangle(c, p1, pc, color);\n        Triangle(c, pc, p2, color);\n    }\n\n    mark Sector4(\n        c: Vector2,\n        p1: Vector2,\n        p2: Vector2,\n        color: Color\n    ) {\n        let pc = c + normalize(p1 + p2 - c - c) * length(p1 - c);\n        Sector2(c, p1, pc, color);\n        Sector2(c, pc, p2, color);\n    }\n\n    mark Polyline(\n        p: Vector2, p_p: Vector2, p_n: Vector2, p_nn: Vector2,\n        width: float,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        let EPS = 1e-5;\n        let w = width / 2;\n        let d = normalize(p - p_n);\n        let n = Vector2(d.y, -d.x);\n        let m1: Vector2;\n        if(length(p - p_p) < EPS) {\n            m1 = n * w;\n        } else {\n            m1 = normalize(d + normalize(p - p_p)) * w;\n        }\n        let m2: Vector2;\n        if(length(p_n - p_nn) < EPS) {\n            m2 = -n * w;\n        } else {\n            m2 = normalize(normalize(p_n - p_nn) - d) * w;\n        }\n        let c1a: Vector2;\n        let c1b: Vector2;\n        let a1: Vector2;\n        let a2: Vector2;\n        if(dot(m1, n) > 0) {\n            c1a = p + m1;\n            c1b = p + n * w;\n            a2 = c1b;\n            a1 = p - m1 * (w / dot(m1, n));\n        } else {\n            c1a = p + m1;\n            c1b = p - n * w;\n            a2 = p + m1 * (w / dot(m1, n));\n            a1 = c1b;\n        }\n        let c2a: Vector2;\n        let c2b: Vector2;\n        let b1: Vector2;\n        let b2: Vector2;\n        if(dot(m2, n) < 0) {\n            c2a = p_n + m2;\n            c2b = p_n - n * w;\n            b1 = c2b;\n            b2 = p_n + m2 * (w / dot(m2, n));\n        } else {\n            c2a = p_n + m2;\n            c2b = p_n + n * w;\n            b2 = c2b;\n            b1 = p_n - m2 * (w / dot(m2, n));\n        }\n        emit [\n            { position: p, color: color },\n            { position: c1a, color: color },\n            { position: c1b, color: color }\n        ];\n        emit [\n            { position: p_n, color: color },\n            { position: c2a, color: color },\n            { position: c2b, color: color }\n        ];\n        emit [\n            { position: p, color: color },\n            { position: a1, color: color },\n            { position: b1, color: color }\n        ];\n        emit [\n            { position: p, color: color },\n            { position: b1, color: color },\n            { position: p_n, color: color }\n        ];\n        emit [\n            { position: p, color: color },\n            { position: a2, color: color },\n            { position: b2, color: color }\n        ];\n        emit [\n            { position: p, color: color },\n            { position: b2, color: color },\n            { position: p_n, color: color }\n        ];\n    }\n\n    mark Wedge(\n        p1: Vector2 = [ 0, 0 ],\n        theta1: float = 0,\n        theta2: float = 0,\n        length: float = 10,\n        width: float = 1,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        let dTheta = (theta2 - theta1) / 60;\n        let dL = length / 60;\n        for(i in 0..59) {\n            let dThetaA = i * dTheta;\n            let dThetaB = (i + 1) * dTheta;\n            let thetaA = theta1 + dThetaA;\n            let thetaB = theta1 + dThetaB;\n            let thetaCenterA = theta1 + dThetaA / 2;\n            let thetaCenterB = theta1 + dThetaB / 2;\n            let dlA = dL * i;\n            let dlB = dL * (i + 1);\n            if(dThetaA > 1e-5 || dThetaA < -1e-5) {\n                dlA = dlA / dThetaA * 2 * sin(dThetaA / 2);\n            }\n            if(dThetaB > 1e-5 || dThetaB < -1e-5) {\n                dlB = dlB / dThetaB * 2 * sin(dThetaB / 2);\n            }\n            let pAdvA = Vector2(-sin(thetaCenterA), cos(thetaCenterA)) * dlA;\n            let pAdvB = Vector2(-sin(thetaCenterB), cos(thetaCenterB)) * dlB;\n            let pA = p1 + pAdvA;\n            let pB = p1 + pAdvB;\n\n            let dpA = Vector2(cos(thetaA), sin(thetaA)) * width * 0.5;\n            let dpB = Vector2(cos(thetaB), sin(thetaB)) * width * 0.5;\n\n            Triangle(pA + dpA, pB + dpB, pB - dpB, color);\n            Triangle(pA + dpA, pB - dpB, pA - dpA, color);\n        }\n    }\n"},{}],15:[function(e,t,r){"use strict";r.primitives="\n    mark Triangle(\n        p1: Vector3,\n        p2: Vector3,\n        p3: Vector3,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        let normal = normalize(cross(p2 - p1, p3 - p1));\n        emit [\n            { position: p1, color: color, normal: normal },\n            { position: p2, color: color, normal: normal },\n            { position: p3, color: color, normal: normal }\n        ];\n    }\n\n    mark Tetrahedron(\n        p1: Vector3,\n        p2: Vector3,\n        p3: Vector3,\n        p4: Vector3\n    ) {\n        Triangle(p3, p4, p1);\n        Triangle(p1, p4, p2);\n        Triangle(p1, p2, p3);\n        Triangle(p2, p3, p4);\n    }\n\n    mark Cube(\n        center: Vector3,\n        radius: float,\n        color: Color\n    ) {\n        let p000 = Vector3(center.x - radius, center.y - radius, center.z - radius);\n        let p001 = Vector3(center.x - radius, center.y - radius, center.z + radius);\n        let p010 = Vector3(center.x - radius, center.y + radius, center.z - radius);\n        let p011 = Vector3(center.x - radius, center.y + radius, center.z + radius);\n        let p100 = Vector3(center.x + radius, center.y - radius, center.z - radius);\n        let p101 = Vector3(center.x + radius, center.y - radius, center.z + radius);\n        let p110 = Vector3(center.x + radius, center.y + radius, center.z - radius);\n        let p111 = Vector3(center.x + radius, center.y + radius, center.z + radius);\n        let nx = Vector3(1, 0, 0);\n        let ny = Vector3(0, 1, 0);\n        let nz = Vector3(0, 0, 1);\n        emit [ { position: p000, color: color, normal: nz }, { position: p110, color: color, normal: nz }, { position: p100, color: color, normal: nz } ];\n        emit [ { position: p000, color: color, normal: nz }, { position: p010, color: color, normal: nz }, { position: p110, color: color, normal: nz } ];\n        emit [ { position: p001, color: color, normal: nz }, { position: p101, color: color, normal: nz }, { position: p111, color: color, normal: nz } ];\n        emit [ { position: p001, color: color, normal: nz }, { position: p111, color: color, normal: nz }, { position: p011, color: color, normal: nz } ];\n        emit [ { position: p000, color: color, normal: ny }, { position: p100, color: color, normal: ny }, { position: p101, color: color, normal: ny } ];\n        emit [ { position: p000, color: color, normal: ny }, { position: p101, color: color, normal: ny }, { position: p001, color: color, normal: ny } ];\n        emit [ { position: p010, color: color, normal: ny }, { position: p111, color: color, normal: ny }, { position: p110, color: color, normal: ny } ];\n        emit [ { position: p010, color: color, normal: ny }, { position: p011, color: color, normal: ny }, { position: p111, color: color, normal: ny } ];\n        emit [ { position: p000, color: color, normal: nx }, { position: p001, color: color, normal: nx }, { position: p011, color: color, normal: nx } ];\n        emit [ { position: p000, color: color, normal: nx }, { position: p011, color: color, normal: nx }, { position: p010, color: color, normal: nx } ];\n        emit [ { position: p100, color: color, normal: nx }, { position: p101, color: color, normal: nx }, { position: p111, color: color, normal: nx } ];\n        emit [ { position: p100, color: color, normal: nx }, { position: p111, color: color, normal: nx }, { position: p110, color: color, normal: nx } ];\n    }\n"},{}],16:[function(e,t,r){"use strict";var n=e("../binding/binding"),i=e("../exceptions"),o=e("../utils/utils"),a=e("../scale/scale"),s=[{shift:-2,suffix:"_pp"},{shift:-1,suffix:"_p"},{shift:1,suffix:"_n"},{shift:2,suffix:"_nn"}],u=function(){function e(e,t,r){for(var i in this._spec=e,this._shader=t,this._data=[],this._platform=r,this._bindings=new o.Dictionary,this._shiftBindings=new o.Dictionary,this._platformMark=null,this._shouldUploadData=!0,this._instanceFunctions=null,this._spec.input)if(this._spec.input.hasOwnProperty(i)){var a=this._spec.input[i];null!=a.default&&this._bindings.set(i,new n.Binding(a.type,a.default))}for(var u in this._spec.input)if(this._spec.input.hasOwnProperty(u))for(var l=0,c=s;l<c.length;l++){var p=c[l],h=p.shift,d=p.suffix;this._spec.input.hasOwnProperty(u+d)&&this._shiftBindings.set(u+d,new n.ShiftBinding(u,h))}}return Object.defineProperty(e.prototype,"spec",{get:function(){return this._spec},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shader",{get:function(){return this._shader},enumerable:!0,configurable:!0}),e.prototype.attr=function(e,t){if(void 0===t){if(!this._bindings.has(e))throw new i.RuntimeError("attr '"+e+" is undefined.");var r=this._bindings.get(e);return r instanceof n.Binding?r.value:r}if(!this._spec.input.hasOwnProperty(e))throw new i.RuntimeError("attr '"+e+" is undefined.");if(t instanceof a.ScaleBinding)this._platformMark&&this._bindings.get(e)!=t&&(this._platformMark=null),this._bindings.set(e,t);else{var o=new n.Binding(this._spec.input[e].type,t);this._platformMark&&(this._platformMark.isUniform(e)&&o.bindingType!=n.BindingType.FUNCTION?(o.bindingType==n.BindingType.VALUE&&this._platformMark.updateUniform(e,o.specValue),o.bindingType==n.BindingType.TEXTURE&&this._platformMark.updateTexture(e,o.textureValue)):this._platformMark=null),this._bindings.set(e,o)}return this},e.prototype.data=function(e){return void 0===e?this._data:(this._data=e.slice(),this._shouldUploadData=!0,this)},e.prototype.instance=function(e,t){if(void 0===e&&void 0===t)return this._instanceFunctions;this._instanceFunctions={datum:e,attrs:t}},e.prototype.prepareSpecification=function(){var e={input:o.shallowClone(this._spec.input),output:this._spec.output,statements:this._spec.statements.slice(),variables:o.shallowClone(this._spec.variables),repeatBegin:this._spec.repeatBegin,repeatEnd:this._spec.repeatEnd},t=this._bindings.clone(),r=this._shiftBindings.clone();return this._bindings.forEach((function(i,o){if(i instanceof a.ScaleBinding){var u=i.getAttributes(),l={};u.forEach((function(r){var i=o+r.bindedName;t.set(i,new n.Binding(r.type,r.binding)),l[r.bindedName]={type:"variable",valueType:r.type,variableName:i},e.input[i]={type:r.type,default:null}})),e.variables[o]=e.input[o].type,e.statements.splice(0,0,{type:"assign",variableName:o,expression:i.getExpression(l),valueType:e.input[o].type});for(var c=function(a,s){if(e.input.hasOwnProperty(o+a)){e.variables[o+a]=e.input[o].type;var l={};u.forEach((function(i){var u=o+i.bindedName;if(t.get(u).bindingType==n.BindingType.FUNCTION){var c=u+a;r.set(c,new n.ShiftBinding(u,s)),l[i.bindedName]={type:"variable",valueType:i.type,variableName:c},e.input[c]={type:i.type,default:null}}else l[i.bindedName]={type:"variable",valueType:i.type,variableName:u}})),e.statements.splice(0,0,{type:"assign",variableName:o+a,expression:i.getExpression(l),valueType:e.input[o].type})}},p=0,h=s;p<h.length;p++){var d=h[p];c(g=d.suffix,d.shift)}delete e.input[o],t.delete(o);for(var m=0,f=s;m<f.length;m++){var g=f[m].suffix;r.has(o+g)&&(delete e.input[o+g],r.delete(o+g))}}})),[e,t,r]},e.prototype.uploadScaleUniforms=function(){var e=this;this._bindings.forEach((function(t,r){t instanceof a.ScaleBinding&&t.getAttributes().forEach((function(t){t.binding instanceof n.TextureBinding?e._platformMark.updateTexture(r+t.bindedName,t.binding):e._platformMark.updateUniform(r+t.bindedName,t.binding)}))}))},e.prototype.prepare=function(){var e=this;if(!this._platformMark){var t=this.prepareSpecification(),r=t[0],n=t[1],i=t[2];this._platformMark=this._platform.compile(this,r,this._shader,n,i),this._shouldUploadData=!0}if(this._shouldUploadData){if(null==this._instanceFunctions)this._platformMarkData=this._platformMark.uploadData([this._data]);else{var o=[];this._data.forEach((function(t,r){var n=e._instanceFunctions.datum(t,r,e._data);o.push(n)})),this._platformMarkData=this._platformMark.uploadData(o)}this._shouldUploadData=!1}return this},e.prototype.render=function(){var e=this;return this.prepare(),null==this._instanceFunctions?this._platformMark.render(this._platformMarkData,(function(){e.uploadScaleUniforms()})):this._platformMark.render(this._platformMarkData,(function(t){var r=e._data[t];if(e._instanceFunctions.attrs){var i=e._instanceFunctions.attrs(r,t,e._data);if(null!=i)for(var o in i)i.hasOwnProperty(o)&&e._platformMark.updateUniform(o,n.getBindingValue(i[o]))}e.uploadScaleUniforms()})),this},e}();r.Mark=u},{"../binding/binding":3,"../exceptions":11,"../scale/scale":20,"../utils/utils":26}],17:[function(e,t,r){"use strict";var n,i=e("../compiler/compiler"),o=e("../compiler/declare"),a=e("./mark"),s=e("../platform/platform");!function(e){e.create=function(e,t,r){if(t instanceof s.Platform){var i=n.basic();return e instanceof o.CustomMark?new a.Mark(e.compile(),i,t):new a.Mark(e,i,t)}return i=t,e instanceof o.CustomMark?new a.Mark(e.compile(),i,r):new a.Mark(e,i,r)},e.custom=function(){return new o.CustomMark},e.compile=function(e){return i.compileString(e)},e.circle=function(t){return void 0===t&&(t=32),e.compile("\n            mark Circle(\n                center: Vector2 = [ 0, 0 ],\n                radius: float = 1,\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                for(i in 0.."+(t-1)+") {\n                    let a1 = i / "+t.toFixed(1)+" * PI * 2.0;\n                    let a2 = (i + 1) / "+t.toFixed(1)+" * PI * 2.0;\n                    let p1 = Vector2(radius * cos(a1), radius * sin(a1));\n                    let p2 = Vector2(radius * cos(a2), radius * sin(a2));\n                    emit [\n                        { position: center + p1, color: color },\n                        { position: center, color: color },\n                        { position: center + p2, color: color }\n                    ];\n                }\n            }\n        ").Circle},e.rect=function(){return e.compile("\n            mark Rectangle(\n                p1: Vector2 = [ 0, 0 ],\n                p2: Vector2 = [ 0, 0 ],\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                emit [\n                    { position: Vector2(p1.x, p1.y), color: color },\n                    { position: Vector2(p2.x, p1.y), color: color },\n                    { position: Vector2(p2.x, p2.y), color: color }\n                ];\n                emit [\n                    { position: Vector2(p1.x, p1.y), color: color },\n                    { position: Vector2(p1.x, p2.y), color: color },\n                    { position: Vector2(p2.x, p2.y), color: color }\n                ];\n            }\n        ").Rectangle},e.line=function(){return e.compile("\n            mark Line(\n                p1: Vector2 = [ 0, 0 ],\n                p2: Vector2 = [ 0, 0 ],\n                width: float = 1,\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                let d = normalize(p2 - p1);\n                let t = Vector2(d.y, -d.x) * (width / 2);\n                emit [\n                    { position: p1 + t, color: color },\n                    { position: p1 - t, color: color },\n                    { position: p2 + t, color: color }\n                ];\n                emit [\n                    { position: p1 - t, color: color },\n                    { position: p2 - t, color: color },\n                    { position: p2 + t, color: color }\n                ];\n            }\n        ").Line},e.wedge=function(t){return void 0===t&&(t=60),e.compile("\n            import { Triangle } from P2D;\n\n            mark Wedge(\n                p1: Vector2 = [ 0, 0 ],\n                theta1: float = 0,\n                theta2: float = 0,\n                length: float = 10,\n                width: float = 1,\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                let dTheta = (theta2 - theta1) / 60;\n                let dL = length / 60;\n                for(i in 0..59) {\n                    let dThetaA = i * dTheta;\n                    let dThetaB = (i + 1) * dTheta;\n                    let thetaA = theta1 + dThetaA;\n                    let thetaB = theta1 + dThetaB;\n                    let thetaCenterA = theta1 + dThetaA / 2;\n                    let thetaCenterB = theta1 + dThetaB / 2;\n                    let dlA = dL * i;\n                    let dlB = dL * (i + 1);\n                    if(dThetaA > 1e-5 || dThetaA < -1e-5) {\n                        dlA = dlA / dThetaA * 2 * sin(dThetaA / 2);\n                    }\n                    if(dThetaB > 1e-5 || dThetaB < -1e-5) {\n                        dlB = dlB / dThetaB * 2 * sin(dThetaB / 2);\n                    }\n                    let pAdvA = Vector2(-sin(thetaCenterA), cos(thetaCenterA)) * dlA;\n                    let pAdvB = Vector2(-sin(thetaCenterB), cos(thetaCenterB)) * dlB;\n                    let pA = p1 + pAdvA;\n                    let pB = p1 + pAdvB;\n\n                    let dpA = Vector2(cos(thetaA), sin(thetaA)) * width * 0.5;\n                    let dpB = Vector2(cos(thetaB), sin(thetaB)) * width * 0.5;\n\n                    Triangle(pA + dpA, pB + dpB, pB - dpB, color);\n                    Triangle(pA + dpA, pB - dpB, pA - dpA, color);\n                }\n            }\n        ").Wedge},e.polyline=function(){var t=e.compile("\n            import { Triangle } from P2D;\n\n            mark Sector2(\n                c: Vector2,\n                p1: Vector2,\n                p2: Vector2,\n                color: Color\n            ) {\n                let pc = c + normalize(p1 + p2 - c - c) * length(p1 - c);\n                Triangle(c, p1, pc, color);\n                Triangle(c, pc, p2, color);\n            }\n\n            mark Sector4(\n                c: Vector2,\n                p1: Vector2,\n                p2: Vector2,\n                color: Color\n            ) {\n                let pc = c + normalize(p1 + p2 - c - c) * length(p1 - c);\n                Sector2(c, p1, pc, color);\n                Sector2(c, pc, p2, color);\n            }\n\n            mark PolylineRound(\n                p: Vector2, p_p: Vector2, p_n: Vector2, p_nn: Vector2,\n                width: float = 1,\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                let EPS = 1e-5;\n                let w = width / 2;\n                let d = normalize(p - p_n);\n                let n = Vector2(d.y, -d.x);\n                let m1: Vector2;\n                if(length(p - p_p) < EPS) {\n                    m1 = n * w;\n                } else {\n                    m1 = normalize(d + normalize(p - p_p)) * w;\n                }\n                let m2: Vector2;\n                if(length(p_n - p_nn) < EPS) {\n                    m2 = -n * w;\n                } else {\n                    m2 = normalize(normalize(p_n - p_nn) - d) * w;\n                }\n                let c1a: Vector2;\n                let c1b: Vector2;\n                let a1: Vector2;\n                let a2: Vector2;\n                if(dot(m1, n) > 0) {\n                    c1a = p + m1;\n                    c1b = p + n * w;\n                    a2 = c1b;\n                    a1 = p - m1 * (w / dot(m1, n));\n                } else {\n                    c1a = p + m1;\n                    c1b = p - n * w;\n                    a2 = p + m1 * (w / dot(m1, n));\n                    a1 = c1b;\n                }\n                let c2a: Vector2;\n                let c2b: Vector2;\n                let b1: Vector2;\n                let b2: Vector2;\n                if(dot(m2, n) < 0) {\n                    c2a = p_n + m2;\n                    c2b = p_n - n * w;\n                    b1 = c2b;\n                    b2 = p_n + m2 * (w / dot(m2, n));\n                } else {\n                    c2a = p_n + m2;\n                    c2b = p_n + n * w;\n                    b2 = c2b;\n                    b1 = p_n - m2 * (w / dot(m2, n));\n                }\n                Sector4(p, c1a, c1b, color);\n                Sector4(p_n, c2a, c2b, color);\n                Triangle(p, a1, b1, color);\n                Triangle(p, b1, p_n, color);\n                Triangle(p, a2, b2, color);\n                Triangle(p, b2, p_n, color);\n            }\n        ").PolylineRound;return t.repeatBegin=1,t.repeatEnd=1,t}}(r.mark||(r.mark={})),function(e){e.compile=function(e){return i.compileString(e)},e.basic=function(){return e.compile("\n            shader Default(\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                emit { color: color };\n            }\n        ").Default},e.lighting=function(){return e.compile("\n            shader Default(\n                color: Color = [ 0, 0, 0, 1 ],\n                normal: Vector3,\n                position: Vector3\n            ) {\n                let lighting = normalize(position);\n                let NdotL = abs(dot(normal, lighting));\n                let s = NdotL * 0.5 + 0.5;\n                emit { color: Color(s * color.r, s * color.g, s * color.b, color.a) };\n            }\n        ").Default}}(n=r.shader||(r.shader={}))},{"../compiler/compiler":6,"../compiler/declare":7,"../platform/platform":19,"./mark":16}],18:[function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=function(){};r.MathType=i;var o=function(e){function t(t,r){void 0===t&&(t=0),void 0===r&&(r=0),e.call(this),this.x=t,this.y=r}return n(t,e),t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.scale=function(e){return new t(this.x*e,this.y*e)},t.prototype.dot=function(e){return this.x*e.x+this.y*e.y},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return new a(this.x/e,this.y/e)},t.prototype.toArray=function(){return[this.x,this.y]},t.FromArray=function(e){return new t(e[0],e[1])},t}(i);r.Vector2=o;var a=function(e){function t(t,r,n){void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),e.call(this),this.x=t,this.y=r,this.z=n}return n(t,e),t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y,this.z*e.z)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y,this.z/e.z)},t.prototype.scale=function(e){return new t(this.x*e,this.y*e,this.z*e)},t.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return new t(this.x/e,this.y/e,this.z/e)},t.prototype.toArray=function(){return[this.x,this.y,this.z]},t.FromArray=function(e){return new t(e[0],e[1],e[2])},t}(i);r.Vector3=a;var s=function(e){function t(t,r,n,i){void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0),e.call(this),this.x=t,this.y=r,this.z=n,this.w=i}return n(t,e),t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.conj=function(){return new t(-this.x,-this.y,-this.z,this.w)},t.prototype.mul=function(e){return new t(e.x*this.w+this.x*e.w+this.y*e.z-this.z*e.y,e.y*this.w+this.y*e.w+this.z*e.x-this.x*e.z,e.z*this.w+this.z*e.w+this.x*e.y-this.y*e.x,this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z)},t.prototype.rotate=function(e){var r=new t(e.x,e.y,e.z,0),n=this.mul(r).mul(this.conj());return new a(n.x,n.y,n.z)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.w*this.w)},t.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.w*this.w);return new t(this.x/e,this.y/e,this.z/e,this.w/e)},t.prototype.slerp=function(e,r){return t.Slerp(this,e,r)},t.Slerp=function(e,r,n){var i=e.x*r.x+e.y*r.y+e.z*r.z+e.w*r.w;i>1&&(i=1),i<-1&&(i=-1);var o,a,s=Math.acos(i);if(Math.abs(s)<1e-10)o=1-n,a=n;else{var u=Math.sin(s);o=Math.sin((1-n)*s)/u,a=Math.sin(n*s)/u}return new t(e.x*o+r.x*a,e.y*o+r.y*a,e.z*o+r.z*a,e.w*o+r.w*a)},t.Rotation=function(e,r){var n=e.normalize().scale(Math.sin(r/2));return new t(n.x,n.y,n.z,Math.cos(r/2))},t.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},t.FromArray=function(e){return new t(e[0],e[1],e[2],e[3])},t}(i);r.Quaternion=s;var u=function(e,t){void 0===e&&(e=new a(0,0,0)),void 0===t&&(t=new s(0,0,0,1)),this.position=e,this.rotation=t};r.Pose=u},{}],19:[function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../utils/utils"),o=function(){};r.PlatformMarkData=o;var a=function(){};r.PlatformMark=a;var s=function(){};r.Viewport=s;var u=function(e){function t(t,r){e.call(this),this.width=t,this.height=r}return n(t,e),t}(s);r.Viewport2D=u;var l=function(e){function t(t,r,n){e.call(this),this.width=t,this.height=r,this.fov=n}return n(t,e),t}(s);r.Viewport3D=l;var c=function(){};r.Platform=c;var p=new i.Dictionary;r.registerPlatformConstructor=function(e,t){p.set(e,t)},r.platform=function(e){console.log("log in stardust");for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return p.get(e).apply(void 0,t)}},{"../utils/utils":26}],20:[function(e,t,r){"use strict";var n=function(){function e(e,t,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];this._scale=e,this._returnType=t,this._argTypes=r,this._args=n}return e.prototype.getReturnType=function(){return this._returnType},e.prototype.getAttributes=function(){for(var t=this,r=[],n=0,i=this._scale.getAttributes();n<i.length;n++){var o=i[n];r.push({scaleBinding:this,bindedName:"s"+o.name,name:o.name,type:o.type,binding:o.binding})}return this._args.forEach((function(n,i){if(n instanceof e)for(var o=0,a=n.getAttributes();o<a.length;o++){var s=a[o];r.push({scaleBinding:t,bindedName:"a"+i+s.bindedName,name:s.name,type:s.type,binding:s.binding})}else r.push({scaleBinding:t,bindedName:"a"+i,name:"a"+i,type:t._argTypes[i],binding:n})})),r},e.prototype.getExpression=function(t){for(var r={},n=0,i=this._scale.getAttributes();n<i.length;n++){var o=i[n];r[o.name]=t["s"+o.name]}var a,s=this._args.map((function(r,n){if(r instanceof e){for(var i={},o=0,a=r.getAttributes();o<a.length;o++){var s=a[o];i[s.bindedName]=t["a"+n+s.bindedName]}return r.getExpression(i)}return t["a"+n]}));return(a=this._scale).getExpression.apply(a,[r].concat(s))},e}();r.ScaleBinding=n},{}],21:[function(e,t,r){"use strict";var n=e("../utils/utils"),i=e("../compiler/compiler"),o=e("../compiler/parser"),a=e("./scale"),s=e("../spec/construct");!function(e){function t(){var e=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];return new(a.ScaleBinding.bind.apply(a.ScaleBinding,[void 0].concat([e,"float",["float","float"]],t)))};return e.getAttributes=function(){return[]},e.getExpression=function(e,t,r){return s.add(t,r)},e}function r(){var e=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];return new(a.ScaleBinding.bind.apply(a.ScaleBinding,[void 0].concat([e,"float",["float","float"]],t)))};return e.getAttributes=function(){return[]},e.getExpression=function(e,t,r){return s.sub(t,r)},e}function u(){var e=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];return new(a.ScaleBinding.bind.apply(a.ScaleBinding,[void 0].concat([e,"float",["float","float"]],t)))};return e.getAttributes=function(){return[]},e.getExpression=function(e,t,r){return s.mul(t,r)},e}function l(){var e=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];return new(a.ScaleBinding.bind.apply(a.ScaleBinding,[void 0].concat([e,"float",["float","float"]],t)))};return e.getAttributes=function(){return[]},e.getExpression=function(e,t,r){return s.div(t,r)},e}function c(){var e=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];return new(a.ScaleBinding.bind.apply(a.ScaleBinding,[void 0].concat([e,"Vector2",["float","float"]],t)))};return e.getAttributes=function(){return[]},e.getExpression=function(e,t,r){return s.func("Vector2","Vector2",t,r)},e}e.linear=function(e){void 0===e&&(e="float");var t=function(){for(var r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];return new(a.ScaleBinding.bind.apply(a.ScaleBinding,[void 0].concat([t,e,["float"]],r)))},r=[0,1],n=[0,1];return t.domain=function(e){return null==e?r:(r[0]=e[0],r[1]=e[1],t)},t.range=function(e){return null==e?n:(n[0]=e[0],n[1]=e[1],t)},t.getAttributes=function(){return[{name:"d0",type:e,binding:r[0]},{name:"d1",type:e,binding:r[1]},{name:"r0",type:e,binding:n[0]},{name:"r1",type:e,binding:n[1]}]},t.getExpression=function(e,t){return s.mix(e.r0,e.r1,s.div(s.sub(t,e.d0),s.sub(e.d1,e.d0)))},t},e.log=function(e){void 0===e&&(e="float");var t=function(){for(var r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];return new(a.ScaleBinding.bind.apply(a.ScaleBinding,[void 0].concat([t,e,["float"]],r)))},r=[0,1],n=[0,1];return t.domain=function(e){return null==e?r:(r[0]=e[0],r[1]=e[1],t)},t.range=function(e){return null==e?n:(n[0]=e[0],n[1]=e[1],t)},t.getAttributes=function(){return[{name:"d0",type:e,binding:r[0]},{name:"d1",type:e,binding:r[1]},{name:"r0",type:e,binding:n[0]},{name:"r1",type:e,binding:n[1]}]},t.getExpression=function(e,t){return s.mix(e.r0,e.r1,s.div(s.log(s.div(t,e.d0)),s.log(s.div(e.d1,e.d0))))},t},e.addScale=t,e.subScale=r,e.mulScale=u,e.divScale=l,e.vector2Scale=c,e.add=function(e,r){return t()(e,r)},e.sub=function(e,t){return r()(e,t)},e.mul=function(e,t){return u()(e,t)},e.div=function(e,t){return l()(e,t)},e.interpolate=function(e){void 0===e&&(e="float");var t,r=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return new(a.ScaleBinding.bind.apply(a.ScaleBinding,[void 0].concat([r,e,[e,e]],t)))};return r.t=function(e){return null==e?t:(t=e,r)},r.getAttributes=function(){return[{name:"t",type:"float",binding:t}]},r.getExpression=function(e,t,r){return s.mix(t,r,e.t)},r},e.Vector2=function(e,t){return c()(e,t)},e.custom=function(e){var t=o.parseExpression(e),r=function(){for(var e=[],o=0;o<arguments.length;o++)e[o-0]=arguments[o];var u=new n.Dictionary;s.forEach((function(e,t){u.set(t,{type:"constant",valueType:e.type,value:null})})),u.set("value",{type:"constant",valueType:"float",value:null});var l=i.compileExpression(t,u);return new(a.ScaleBinding.bind.apply(a.ScaleBinding,[void 0].concat([r,l.valueType,["float"]],e)))},s=new n.Dictionary;return r.attr=function(e,t,n){return null==t&&null==n?s.get(e).value:"string"==typeof t?(s.set(e,{type:t,value:n}),r):(s.set(e,{type:"float",value:t}),r)},r.getAttributes=function(){var e=[];return s.forEach((function(t,r){e.push({name:r,type:t.type,binding:t.value})})),e},r.getExpression=function(e,r){var o=new n.Dictionary;for(var a in e)e.hasOwnProperty(a)&&o.set(a,e[a]);return o.set("value",r),i.compileExpression(t,o)},r}}(r.scale||(r.scale={}))},{"../compiler/compiler":6,"../compiler/parser":8,"../spec/construct":22,"../utils/utils":26,"./scale":20}],22:[function(e,t,r){"use strict";var n=e("../intrinsics/intrinsics");function i(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return{type:"function",functionName:n.getInternalName({name:e,argTypes:r.map((function(e){return e.valueType})),returnType:t}),arguments:r,valueType:t}}function o(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return{type:"function",functionName:n.getInternalName({name:"@"+e,argTypes:r.map((function(e){return e.valueType})),returnType:t}),valueType:t,arguments:r}}r.func=i,r.op=o,r.cast=function(e,t){return{type:"function",functionName:n.getInternalName({name:"cast:"+e.valueType+":"+t,argTypes:[e.valueType],returnType:t}),valueType:t,arguments:[e]}},r.variable=function(e,t){return{type:"variable",variableName:e,valueType:t}},r.constant=function(e,t){return{type:"constant",value:e,valueType:t}},r.mix=function(e,t,r){return i("mix",e.valueType,e,t,r)},r.exp=function(e){return i("exp","float",e)},r.log=function(e){return i("log","float",e)},r.add=function(e,t){return o("+",e.valueType,e,t)},r.sub=function(e,t){return o("-",e.valueType,e,t)},r.mul=function(e,t){return o("*",e.valueType,e,t)},r.div=function(e,t){return o("/",e.valueType,e,t)},r.equals=function(e,t){return o("==","bool",e,t)},r.greaterThan=function(e,t){return o(">","bool",e,t)},r.lessThan=function(e,t){return o("<","bool",e,t)},r.greaterThanOrEquals=function(e,t){return o(">=","bool",e,t)},r.lessThanOrEquals=function(e,t){return o("<=","bool",e,t)}},{"../intrinsics/intrinsics":12}],23:[function(e,t,r){"use strict";r.types={float:{name:"float",size:4,primitive:"float",primitiveCount:1},int:{name:"int",size:4,primitive:"int",primitiveCount:1},Vector2:{name:"Vector2",size:8,primitive:"float",primitiveCount:2},Vector3:{name:"Vector3",size:12,primitive:"float",primitiveCount:3},Quaternion:{name:"Quaternion",size:16,primitive:"float",primitiveCount:4},Color:{name:"Color",size:16,primitive:"float",primitiveCount:4}}},{}],24:[function(e,t,r){"use strict";var n=e("../spec/construct"),i=e("../utils/utils");r.flattenEmits=function(e){var t=i.attemptName("s3idx",(function(t){return!e.variables.hasOwnProperty(t)&&!e.input.hasOwnProperty(t)})),r=i.attemptName("s3idx_i",(function(t){return!e.variables.hasOwnProperty(t)&&!e.input.hasOwnProperty(t)})),o=i.attemptName("s3emitidx",(function(t){return!e.variables.hasOwnProperty(t)&&!e.input.hasOwnProperty(t)})),a={input:{},output:e.output,variables:e.variables,statements:[],repeatBegin:e.repeatBegin,repeatEnd:e.repeatEnd};for(var s in e.input)e.input.hasOwnProperty(s)&&(a.input[s]=e.input[s]);a.input[t]={type:"float",default:0},a.variables[r]="int",a.variables[o]="int",a.statements.push({type:"assign",variableName:r,expression:n.cast(n.variable(t,"float"),"int")}),a.statements.push({type:"assign",variableName:o,expression:n.constant(0,"int")});var u=function(e){for(var t=[],i=0,a=0;a<e.length;a++)switch(e[a].type){case"emit":t.push({type:"condition",condition:n.equals(n.variable(r,"int"),n.variable(o,"int")),trueStatements:[e[a]],falseStatements:[]}),t.push({type:"assign",variableName:o,expression:n.add(n.variable(o,"int"),n.constant(1,"int"))}),i+=1;break;case"for":var s=e[a],l=u(s.statements),c=l[0],p=l[1],h=[];h.push({type:"assign",variableName:s.variableName,expression:n.add(n.div(n.sub(n.variable(r,"int"),n.variable(o,"int")),n.constant(p,"int")),n.constant(s.rangeMin,"int"))}),h.push({type:"assign",variableName:o,expression:n.add(n.variable(o,"int"),n.mul(n.constant(p,"int"),n.sub(n.variable(s.variableName,"int"),n.constant(s.rangeMin,"int"))))}),(h=h.concat(c)).push({type:"assign",variableName:o,expression:n.add(n.variable(o,"int"),n.mul(n.constant(p,"int"),n.sub(n.constant(s.rangeMax,"int"),n.variable(s.variableName,"int"))))}),t.push({type:"condition",condition:n.op("&&","bool",n.greaterThanOrEquals(n.variable(r,"int"),n.variable(o,"int")),n.lessThan(n.variable(r,"int"),n.add(n.variable(o,"int"),n.constant(p*(s.rangeMax-s.rangeMin+1),"int")))),trueStatements:h,falseStatements:[{type:"assign",variableName:o,expression:n.add(n.variable(o,"int"),n.constant((s.rangeMax-s.rangeMin+1)*p,"int"))}]}),i+=(s.rangeMax-s.rangeMin+1)*p;break;case"condition":var d=e[a],m=u(d.trueStatements),f=m[0],g=m[1],v=u(d.falseStatements),y=v[0],_=v[1];t.push({type:"condition",condition:d.condition,trueStatements:f,falseStatements:y}),i=Math.max(g,_);break;default:t.push(e[a])}return[t,i]},l=u(e.statements),c=l[0],p=l[1];return a.statements=a.statements.concat(c),{specification:a,count:p,indexVariable:t}}},{"../spec/construct":22,"../utils/utils":26}],25:[function(e,t,r){"use strict";var n=e("./flattener");r.flattenEmits=n.flattenEmits},{"./flattener":24}],26:[function(e,t,r){"use strict";var n=function(){function e(){this._dict={}}return e.prototype.set=function(e,t){this._dict[e]=t},e.prototype.has=function(e){return this._dict.hasOwnProperty(e)},e.prototype.delete=function(e){delete this._dict[e]},e.prototype.get=function(e){return this._dict.hasOwnProperty(e)?this._dict[e]:void 0},e.prototype.forEach=function(e){for(var t in this._dict)this._dict.hasOwnProperty(t)&&e(this._dict[t],t)},e.prototype.clone=function(){var t=new e;return this.forEach((function(e,r){t.set(r,e)})),t},e}();r.Dictionary=n,r.shallowClone=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},r.attemptName=function(e,t){if(t(e))return e;for(var r=1;;r++){var n=e+r.toString();if(t(n))return n}},r.timeTask=function(e,t){var r=(new Date).getTime();t();var n=(new Date).getTime();console.log(e+": "+((n-r)/1e3).toFixed(3)+"s")}},{}],27:[function(e,t,r){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}r.version="0.1.1",n(e("./core/utils/utils")),n(e("./core/math/math")),n(e("./core/color/color")),n(e("./core/mark/mark")),n(e("./core/mark/marks")),n(e("./core/binding/binding")),n(e("./core/spec/spec")),n(e("./core/intrinsics/intrinsics")),n(e("./core/exceptions")),n(e("./core/compiler/parser")),n(e("./core/compiler/compiler")),n(e("./core/compiler/declare")),n(e("./core/transform/transforms")),n(e("./core/evaluator/evaluator")),n(e("./core/platform/platform")),n(e("./core/scale/scale"));var i=e("./core/scale/scales");r.scale=i.scale},{"./core/binding/binding":3,"./core/color/color":5,"./core/compiler/compiler":6,"./core/compiler/declare":7,"./core/compiler/parser":8,"./core/evaluator/evaluator":10,"./core/exceptions":11,"./core/intrinsics/intrinsics":12,"./core/mark/mark":16,"./core/mark/marks":17,"./core/math/math":18,"./core/platform/platform":19,"./core/scale/scale":20,"./core/scale/scales":21,"./core/spec/spec":23,"./core/transform/transforms":25,"./core/utils/utils":26}],28:[function(e,t,r){"use strict";var n=e("stardust-core"),i=e("earcut");r.isotype=function(e){var t=n.mark.custom();t.input("position","Vector2","[ 0, 0 ]"),t.input("size","float","1"),t.input("color","Color","[ 0, 0, 0, 1 ]");for(var r=function(e){var t=(new DOMParser).parseFromString(e,"image/svg+xml");function r(e,t){if(e instanceof Element&&e.tagName&&e.tagName.toLowerCase()==t)return[e];for(var n=[],i=0;i<e.children.length;i++)n=n.concat(r(e.children.item(i),t));return n}var n=r(t,"svg")[0],o=r(t,"polygon"),a=[];o.forEach((function(e){var t=e.getAttribute("points").split(/[, \t]/).map((function(e){return e.trim()})).filter((function(e){return""!=e})).map((function(e){return parseFloat(e)})),r=i(t),n="black";e.style.fill&&""!=e.style.fill&&(n=e.style.fill);for(var o=0;o<r.length;o+=3){var s=r[o+0],u=r[o+1],l=r[o+2],c={p1:[t[2*s],t[2*s+1]],p2:[t[2*u],t[2*u+1]],p3:[t[2*l],t[2*l+1]],color:n};a.push(c)}}));var s=function(e){return null==e||""==e?0:e.match(/px$/)||e.match(/em$/)?parseFloat(e.substr(0,e.length-2)):parseFloat(e)};return{x:s(n.getAttribute("x")),y:s(n.getAttribute("y")),width:s(n.getAttribute("width")),height:s(n.getAttribute("height")),triangles:a}}(e),o=r.x+r.width/2,a=r.y+r.height/2,s=0,u=r.triangles;s<u.length;s++){var l=u[s];t.add("P2D.Triangle").attr("p1","position + Vector2("+(l.p1[0]-o)+", "+(l.p1[1]-a)+") * size").attr("p2","position + Vector2("+(l.p2[0]-o)+", "+(l.p2[1]-a)+") * size").attr("p3","position + Vector2("+(l.p3[0]-o)+", "+(l.p3[1]-a)+") * size").attr("color","color")}return t.compile()}},{earcut:29,"stardust-core":27}],29:[function(e,t,r){"use strict";function n(e,t,r){r=r||2;var n,s,u,l,c,d,f,g=t&&t.length,v=g?t[0]*r:e.length,y=i(e,0,v,r,!0),_=[];if(!y)return _;if(g&&(y=function(e,t,r,n){var a,s,u,l,c,d=[];for(a=0,s=t.length;a<s;a++)u=t[a]*n,l=a<s-1?t[a+1]*n:e.length,(c=i(e,u,l,n,!1))===c.next&&(c.steiner=!0),d.push(m(c));for(d.sort(p),a=0;a<d.length;a++)h(d[a],r),r=o(r,r.next);return r}(e,t,y,r)),e.length>80*r){n=u=e[0],s=l=e[1];for(var x=r;x<v;x+=r)(c=e[x])<n&&(n=c),(d=e[x+1])<s&&(s=d),c>u&&(u=c),d>l&&(l=d);f=Math.max(u-n,l-s)}return a(y,_,r,n,s,f),_}function i(e,t,r,n,i){var o,a;if(i===E(e,t,r,n)>0)for(o=t;o<r;o+=n)a=C(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=C(o,e[o],e[o+1],a);return a&&y(a,a.next)&&(w(a),a=a.next),a}function o(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!y(n,n.next)&&0!==v(n.prev,n,n.next))n=n.next;else{if(w(n),(n=t=n.prev)===n.next)return null;r=!0}}while(r||n!==t);return t}function a(e,t,r,n,i,p,h){if(e){!h&&p&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=d(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,o,a,s,u,l=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(u=l;s>0||u>0&&n;)0===s?(i=n,n=n.nextZ,u--):0!==u&&n?r.z<=n.z?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--):(i=r,r=r.nextZ,s--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,l*=2}while(a>1)}(i)}(e,n,i,p);for(var m,f,g=e;e.prev!==e.next;)if(m=e.prev,f=e.next,p?u(e,n,i,p):s(e))t.push(m.i/r),t.push(e.i/r),t.push(f.i/r),w(e),e=f.next,g=f.next;else if((e=f)===g){h?1===h?a(e=l(e,t,r),t,r,n,i,p,2):2===h&&c(e,t,r,n,i,p):a(o(e),t,r,n,i,p,1);break}}}function s(e){var t=e.prev,r=e,n=e.next;if(v(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(f(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&v(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(e,t,r,n){var i=e.prev,o=e,a=e.next;if(v(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,p=d(s,u,t,r,n),h=d(l,c,t,r,n),m=e.nextZ;m&&m.z<=h;){if(m!==e.prev&&m!==e.next&&f(i.x,i.y,o.x,o.y,a.x,a.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(m=e.prevZ;m&&m.z>=p;){if(m!==e.prev&&m!==e.next&&f(i.x,i.y,o.x,o.y,a.x,a.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;m=m.prevZ}return!0}function l(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!y(i,o)&&_(i,n,n.next,o)&&x(i,o)&&x(o,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(o.i/r),w(n),w(n.next),n=e=o),n=n.next}while(n!==e);return n}function c(e,t,r,n,i,s){var u=e;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&g(u,l)){var c=b(u,l);return u=o(u,u.next),c=o(c,c.next),a(u,t,r,n,i,s),void a(c,t,r,n,i,s)}l=l.next}u=u.next}while(u!==e)}function p(e,t){return e.x-t.x}function h(e,t){if(t=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===a)return r.prev;var u,l=r,c=r.x,p=r.y,h=1/0;for(n=r.next;n!==l;)i>=n.x&&n.x>=c&&f(o<p?i:a,o,c,p,o<p?a:i,o,n.x,n.y)&&((u=Math.abs(o-n.y)/(i-n.x))<h||u===h&&n.x>r.x)&&x(n,e)&&(r=n,h=u),n=n.next;return r}(e,t)){var r=b(t,e);o(r,r.next)}}function d(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)/i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)/i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function m(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function f(e,t,r,n,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(n-s)-(r-a)*(t-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function g(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&_(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&x(e,t)&&x(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function v(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function _(e,t,r,n){return!!(y(e,t)&&y(r,n)||y(e,n)&&y(r,t))||v(e,t,r)>0!=v(e,t,n)>0&&v(r,n,e)>0!=v(r,n,t)>0}function x(e,t){return v(e.prev,e,e.next)<0?v(e,t,e.next)>=0&&v(e,e.prev,t)>=0:v(e,t,e.prev)<0||v(e,e.next,t)<0}function b(e,t){var r=new T(e.i,e.x,e.y),n=new T(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function C(e,t,r,n){var i=new T(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function w(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}t.exports=n,n.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(E(e,0,o,r));if(i)for(var s=0,u=t.length;s<u;s++){var l=t[s]*r,c=s<u-1?t[s+1]*r:e.length;a-=Math.abs(E(e,l,c,r))}var p=0;for(s=0;s<n.length;s+=3){var h=n[s]*r,d=n[s+1]*r,m=n[s+2]*r;p+=Math.abs((e[h]-e[m])*(e[d+1]-e[h+1])-(e[h]-e[d])*(e[m+1]-e[h+1]))}return 0===a&&0===p?0:Math.abs((p-a)/a)},n.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}},{}],30:[function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("./types"),o=e("./intrinsics"),a=e("stardust-core"),s=function(){function e(){this._lines=[],this._currentIndent="",this._blocks=new a.Dictionary}return e.prototype.addNamedBlock=function(e,t){this._blocks.has(e)?this._blocks.set(e,this._blocks.get(e)+"\n"+t):this._blocks.set(e,t)},e.prototype.addLine=function(e){this._lines.push(this._currentIndent+e)},e.prototype.indent=function(){this._currentIndent+="    "},e.prototype.unindent=function(){this._currentIndent=this._currentIndent.slice(0,this._currentIndent.length-4)},e.prototype.getCode=function(){var e=this;return this._lines.map((function(t){return"@"==t[0]&&e._blocks.has(t.substr(1))?e._blocks.get(t.substr(1)):t})).join("\n")},e}();r.LinesGenerator=s;var u=function(e){function t(){e.call(this)}return n(t,e),t.prototype.addAdditionalCode=function(e){this.addNamedBlock("additionalCode",e)},t.prototype.addDeclaration=function(e,t,r){void 0===r&&(r=null),null==r?this.addLine(i.convertTypeName(t)+" "+e+";"):this.addLine(r+" "+i.convertTypeName(t)+" "+e+";")},t.prototype.addArrayDeclaration=function(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=null),"null"==n?this.addLine(i.convertTypeName(t)+"["+r+"] "+e+";"):this.addLine(n+" "+i.convertTypeName(t)+"["+r+"] "+e+";")},t.prototype.addUniform=function(e,t){this.addLine("uniform "+i.convertTypeName(t)+" "+e+";"),"Vector2Array"!=t&&"FloatArray"!=t&&"Vector3Array"!=t&&"Vector4Array"!=t&&"ColorArray"!=t||this.addLine("uniform int "+e+"_length;"),"Vector2Image"!=t&&"FloatImage"!=t&&"Vector3Image"!=t&&"Vector4Image"!=t&&"Image"!=t||(this.addLine("uniform int "+e+"_width;"),this.addLine("uniform int "+e+"_height;"))},t.prototype.addAttribute=function(e,t){this.addLine("attribute "+i.convertTypeName(t)+" "+e+";")},t.prototype.addVarying=function(e,t){this.addLine("varying "+i.convertTypeName(t)+" "+e+";")},t.prototype.addIn=function(e,t){this.addLine("in "+i.convertTypeName(t)+" "+e+";")},t.prototype.addOut=function(e,t){this.addLine("out "+i.convertTypeName(t)+" "+e+";")},t.prototype.generateExpression=function(e){var t=this;switch(e.type){case"constant":var r=e;return i.convertConstant(r.valueType,r.value);case"variable":return e.variableName;case"function":var n=e,a=n.arguments.map((function(e){return t.generateExpression(e)})),s=o.generateIntrinsicFunction(n.functionName,a),u=s.code,l=s.additionalCode;return null!=l&&this.addAdditionalCode(l),u;case"field":var c=e;return this.generateExpression(c.value)+"."+c.fieldName}},t.prototype.addStatement=function(e){switch(e.type){case"assign":var t=e,r=this.generateExpression(t.expression);this.addLine(t.variableName+" = "+r+";");break;case"condition":var n=e;n.trueStatements.length>0&&n.falseStatements.length>0?(this.addLine("if("+this.generateExpression(n.condition)+") {"),this.indent(),this.addStatements(n.trueStatements),this.unindent(),this.addLine("} else {"),this.indent(),this.addStatements(n.falseStatements),this.unindent(),this.addLine("}")):n.trueStatements.length>0?(this.addLine("if("+this.generateExpression(n.condition)+") {"),this.indent(),this.addStatements(n.trueStatements),this.unindent(),this.addLine("}")):n.falseStatements.length>0&&(this.addLine("if(!"+this.generateExpression(n.condition)+") {"),this.indent(),this.addStatements(n.trueStatements),this.unindent(),this.addLine("}"));break;case"for":var i=e;this.addLine("for(int "+i.variableName+" = "+i.rangeMin+"; "+i.variableName+" <= "+i.rangeMax+"; "+i.variableName+"++) {"),this.indent(),this.addStatements(i.statements),this.unindent(),this.addLine("}");break;case"emit":var o=e;this.addEmitStatement(o)}},t.prototype.addStatements=function(e){var t=this;e.forEach((function(e){return t.addStatement(e)}))},t.prototype.addEmitStatement=function(e){this.addLine("// Emit Statement")},t}(s);r.ShaderGenerator=u;var l=function(){function e(e,t,r){var n=this;this._spec=e,this._shader=t,this._asUniform=r,this._names={};var i=function(e){for(var t in e)e.hasOwnProperty(t)&&(n._names[t]=!0)};i(e.input),i(e.output),i(e.variables),i(t.input),i(t.output)}return e.prototype.getUnusedName=function(e){for(var t=0;;){var r="s3"+e+t.toString();if(!0!==this._names[r])return this._names[r]=!0,r;t+=1}},e.prototype.fragmentPassthru=function(e){return this._spec.input.hasOwnProperty(e)&&!this._spec.output.hasOwnProperty(e)},e}();r.ProgramGenerator=l},{"./intrinsics":31,"./types":32,"stardust-core":27}],31:[function(e,t,r){"use strict";var n=e("stardust-core"),i=e("stardust-core"),o=new i.Dictionary,a=new i.Dictionary;function s(e,t,r,i){var a=n.getInternalName({name:e,argTypes:t,returnType:r});o.set(a,i)}function u(e,t,r,i,o){if(s(e,t,r,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return i+"("+e.join(", ")+")"})),o){var u=n.getInternalName({name:e,argTypes:t,returnType:r});a.set(u,o)}}function l(e,t,r,n){s("@"+e,t,r,n)}function c(e,t,r){s("cast:"+e+":"+t,[e],t,r)}for(var p=0,h=["float","int","Vector2","Vector3","Vector4","Color"];p<h.length;p++)l("+",[v=h[p],v],v,(function(e,t){return"("+e+") + ("+t+")"})),l("-",[v,v],v,(function(e,t){return"("+e+") - ("+t+")"})),l("*",[v,v],v,(function(e,t){return"("+e+") * ("+t+")"})),l("/",[v,v],v,(function(e,t){return"("+e+") / ("+t+")"})),"Color"!=v&&(l("+",[v],v,(function(e,t){return""+e})),l("-",[v],v,(function(e,t){return"-("+e+")"})));l("*",["float","Vector2"],"Vector2",(function(e,t){return"("+e+") * ("+t+")"})),l("*",["float","Vector3"],"Vector3",(function(e,t){return"("+e+") * ("+t+")"})),l("*",["float","Vector4"],"Vector4",(function(e,t){return"("+e+") * ("+t+")"})),l("*",["Vector2","float"],"Vector2",(function(e,t){return"("+e+") * ("+t+")"})),l("*",["Vector3","float"],"Vector3",(function(e,t){return"("+e+") * ("+t+")"})),l("*",["Vector4","float"],"Vector4",(function(e,t){return"("+e+") * ("+t+")"})),l("/",["Vector2","float"],"Vector2",(function(e,t){return"("+e+") / ("+t+")"})),l("/",["Vector3","float"],"Vector3",(function(e,t){return"("+e+") / ("+t+")"})),l("/",["Vector4","float"],"Vector4",(function(e,t){return"("+e+") / ("+t+")"})),l("%",["float","float"],"float",(function(e,t){return"mod("+e+", "+t+")"}));for(var d=0,m=["float","int","bool"];d<m.length;d++)l("==",[v=m[d],v],"bool",(function(e,t){return"("+e+") == ("+t+")"}));for(var f=0,g=["float","int"];f<g.length;f++){var v;l(">",[v=g[f],v],"bool",(function(e,t){return"("+e+") > ("+t+")"})),l("<",[v,v],"bool",(function(e,t){return"("+e+") < ("+t+")"})),l(">=",[v,v],"bool",(function(e,t){return"("+e+") >= ("+t+")"})),l("<=",[v,v],"bool",(function(e,t){return"("+e+") <= ("+t+")"}))}l("!",["bool"],"bool",(function(e){return"!("+e+")"})),l("&&",["bool","bool"],"bool",(function(e,t){return"("+e+") && ("+t+")"})),l("||",["bool","bool"],"bool",(function(e,t){return"("+e+") || ("+t+")"})),u("Vector2",["float","float"],"Vector2","vec2"),u("Vector3",["float","float","float"],"Vector3","vec3"),u("Vector4",["float","float","float","float"],"Vector4","vec4"),u("Color",["float","float","float","float"],"Color","vec4"),u("Quaternion",["float","float","float","float"],"Quaternion","vec4"),u("normalize",["Vector2"],"Vector2","normalize"),u("normalize",["Vector3"],"Vector3","normalize"),u("normalize",["Vector4"],"Vector4","normalize"),u("normalize",["Quaternion"],"Vector4","normalize"),u("dot",["Vector2","Vector2"],"float","dot"),u("dot",["Vector3","Vector3"],"float","dot"),u("dot",["Vector4","Vector4"],"float","dot"),u("length",["Vector2"],"float","length"),u("length",["Vector3"],"float","length"),u("length",["Vector4"],"float","length"),u("length",["Quaternion"],"float","length"),u("cross",["Vector3","Vector3"],"Vector3","cross"),u("quat_mul",["Quaternion","Quaternion"],"Quaternion","s3_quat_mul","\n    vec4 s3_quat_mul(vec4 q1, vec4 q2) {\n        return vec4(\n            q1.w * q2.xyz + q2.w * q1.xyz + cross(q1.xyz, q2.xyz),\n            q1.w * q2.w - dot(q1.xyz, q2.xyz)\n        );\n    }\n"),u("quat_rotate",["Quaternion","Vector3"],"Vector3","s3_quat_rotate","\n    vec3 s3_quat_rotate(vec4 q, vec3 v) {\n        float d = dot(q.xyz, v);\n        vec3 c = cross(q.xyz, v);\n        return q.w * q.w * v + (q.w + q.w) * c + d * q.xyz - cross(c, q.xyz);\n    }\n");var y="\n    float s3_lab2rgb_curve(float v) {\n        float p = pow(v, 3.0);\n        if(p > 0.008856) {\n            return p;\n        } else {\n            return (v - 16.0 / 116.0) / 7.787;\n        }\n    }\n    float s3_lab2rgb_curve2(float v) {\n        if(v > 0.0031308) {\n            return 1.055 * pow(v , (1.0 / 2.4)) - 0.055;\n        } else {\n            return 12.92 * v;\n        }\n    }\n    vec4 s3_lab2rgb(vec4 lab) {\n        float var_Y = (lab.x + 0.160) / 1.160;\n        float var_X = lab.y / 5.0 + var_Y;\n        float var_Z = var_Y - lab.z / 2.0;\n\n        var_X = s3_lab2rgb_curve(var_X) * 0.95047;\n        var_Y = s3_lab2rgb_curve(var_Y);\n        var_Z = s3_lab2rgb_curve(var_Z) * 1.08883;\n\n        float var_R = var_X *  3.2406 + var_Y * -1.5372 + var_Z * -0.4986;\n        float var_G = var_X * -0.9689 + var_Y *  1.8758 + var_Z *  0.0415;\n        float var_B = var_X *  0.0557 + var_Y * -0.2040 + var_Z *  1.0570;\n\n        var_R = s3_lab2rgb_curve2(var_R);\n        var_G = s3_lab2rgb_curve2(var_G);\n        var_B = s3_lab2rgb_curve2(var_B);\n\n        return vec4(var_R, var_G, var_B, lab.a);\n    }\n    vec4 s3_hcl2rgb(vec4 hcl) {\n        vec4 lab = vec4(hcl.z, hcl.y * cos(hcl.x), hcl.y * sin(hcl.x), hcl.a);\n        return s3_lab2rgb(lab);\n    }\n";u("lab2rgb",["Color"],"Color","s3_lab2rgb",y),u("hcl2rgb",["Color"],"Color","s3_hcl2rgb",y),u("abs",["float"],"float","abs"),u("sqrt",["float"],"float","sqrt"),u("exp",["float"],"float","exp"),u("log",["float"],"float","log"),u("sin",["float"],"float","sin"),u("cos",["float"],"float","cos"),u("tan",["float"],"float","tan"),u("asin",["float"],"float","asin"),u("acos",["float"],"float","acos"),u("atan",["float"],"float","atan"),u("atan2",["float","float"],"float","atan2"),u("abs",["int"],"int","abs"),u("min",["float","float"],"float","min"),u("max",["float","float"],"float","max"),u("ceil",["float"],"float","ceil"),u("floor",["float"],"float","floor"),u("mix",["float","float","float"],"float","mix"),u("mix",["Vector2","Vector2","float"],"Vector2","mix"),u("mix",["Vector3","Vector3","float"],"Vector3","mix"),u("mix",["Vector4","Vector4","float"],"Vector4","mix"),u("mix",["Color","Color","float"],"Color","mix"),s("clamp",["float"],"float",(function(e){return"clamp("+e+", 0, 1)"})),c("float","int",(function(e){return"int("+e+")"})),c("int","float",(function(e){return"float("+e+")"})),s("array",["FloatArray","float"],"float",(function(e,t){return"texture2D("+e+", vec2(("+t+" + 0.5) / float("+e+"_length), 0.5)).x"})),s("array",["Vector2Array","float"],"Vector2",(function(e,t){return"texture2D("+e+", vec2(("+t+" + 0.5) / float("+e+"_length), 0.5)).xy"})),s("array",["Vector3Array","float"],"Vector3",(function(e,t){return"texture2D("+e+", vec2(("+t+" + 0.5) / float("+e+"_length), 0.5)).xyz"})),s("array",["Vector4Array","float"],"Vector4",(function(e,t){return"texture2D("+e+", vec2(("+t+" + 0.5) / float("+e+"_length), 0.5)).xyzw"})),s("array",["ColorArray","float"],"Color",(function(e,t){return"texture2D("+e+", vec2(("+t+" + 0.5) / float("+e+"_length), 0.5)).rgba"})),s("image",["FloatImage","Vector2"],"float",(function(e,t){return"texture2D("+e+", ("+t+" + 0.5) / vec2("+e+"_width, "+e+"_height))).x"})),s("image",["Vector2Image","Vector2"],"Vector2",(function(e,t){return"texture2D("+e+", ("+t+" + 0.5) / vec2("+e+"_width, "+e+"_height))).xy"})),s("image",["Vector3Image","Vector2"],"Vector3",(function(e,t){return"texture2D("+e+", ("+t+" + 0.5) / vec2("+e+"_width, "+e+"_height))).xyz"})),s("image",["Vector4Image","Vector2"],"Vector4",(function(e,t){return"texture2D("+e+", ("+t+" + 0.5) / vec2("+e+"_width, "+e+"_height))).xyzw"})),s("image",["ColorImage","Vector2"],"Color",(function(e,t){return"texture2D("+e+", ("+t+" + 0.5) / vec2("+e+"_width, "+e+"_height))).rgba"})),r.generateIntrinsicFunction=function(e,t){if(o.has(e))return a.has(e)?{code:o.get(e).apply(void 0,t),additionalCode:a.get(e)}:{code:o.get(e).apply(void 0,t),additionalCode:null};throw new Error("intrinsic function "+e+" is not defined.")}},{"stardust-core":27}],32:[function(e,t,r){"use strict";var n={float:"float",int:"int",bool:"bool",Vector2:"vec2",Vector3:"vec3",Vector4:"vec4",Matrix3:"mat3",Matrix4:"mat4",Quaternion:"vec4",Color:"vec4",FloatArray:"sampler2D",Vector2Array:"sampler2D",Vector3Array:"sampler2D",Vector4Array:"sampler2D"};r.convertTypeName=function(e){return n[e]},r.convertConstant=function(e,t){return"float"==e?t.toFixed(5):"int"==e?t.toString():"bool"==e?0!=t?"true":"false":"Vector2"==e?"vec2("+t.join(", ")+")":"Vector3"==e?"vec3("+t.join(", ")+")":"Vector4"==e||"Quaternion"==e||"Color"==e?"vec4("+t.join(", ")+")":void 0}},{}],33:[function(e,t,r){"use strict";r.version="0.1.1";var n=e("./webgl/webgl");r.WebGLPlatform=n.WebGLPlatform,r.WebGLCanvasPlatform2D=n.WebGLCanvasPlatform2D,r.WebGLCanvasPlatform3D=n.WebGLCanvasPlatform3D,r.WebGLCanvasPlatformWebVR=n.WebGLCanvasPlatformWebVR;var i=e("stardust-core"),o=e("./webgl/webgl");i.registerPlatformConstructor("webgl-2d",(function(e,t,r){return void 0===t&&(t=600),void 0===r&&(r=400),new o.WebGLCanvasPlatform2D(e,t,r)})),i.registerPlatformConstructor("webgl-3d",(function(e,t,r){return void 0===t&&(t=600),void 0===r&&(r=400),new o.WebGLCanvasPlatform3D(e,t,r)})),i.registerPlatformConstructor("webgl-webvr",(function(e,t,r){return void 0===t&&(t=600),void 0===r&&(r=400),new o.WebGLCanvasPlatformWebVR(e,t,r)}))},{"./webgl/webgl":35,"stardust-core":27}],34:[function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../glsl/glsl"),o=e("stardust-core");!function(e){e[e.NORMAL=0]="NORMAL",e[e.PICK=1]="PICK",e[e.FRAGMENT=2]="FRAGMENT"}(r.GenerateMode||(r.GenerateMode={}));var a=r.GenerateMode;!function(e){e[e.VIEW_2D=0]="VIEW_2D",e[e.VIEW_3D=1]="VIEW_3D",e[e.VIEW_WEBVR=2]="VIEW_WEBVR"}(r.ViewType||(r.ViewType={}));var s=r.ViewType,u=function(e){function t(t){e.call(this),this._parent=t}return n(t,e),t.prototype.addEmitStatement=function(e){for(var t in e.attributes)this.addLine(this._parent._voutMapping.get(t)+" = "+this.generateExpression(e.attributes[t])+";");this._parent._mode==a.PICK&&this.addLine("out_pick_index = vec4(s3_pick_index.rgb, s3_pick_index_alpha);");var r=this._parent._voutMapping.get("position");switch(this._parent._spec.output.position.type){case"Vector2":this.addLine("gl_Position = s3_render_vertex(vec3("+r+", 0.0));");break;case"Vector3":this.addLine("gl_Position = s3_render_vertex("+r+");");break;case"Vector4":this.addLine("gl_Position = s3_render_vertex("+r+".xyz);")}},t}(i.ShaderGenerator);r.GLSLVertexShaderGenerator=u;var l=function(e){function t(t){e.call(this),this._parent=t}return n(t,e),t.prototype.addEmitStatement=function(e){this.addLine("gl_FragColor = "+this.generateExpression(e.attributes.color)+";")},t}(i.ShaderGenerator);r.GLSLFragmentShaderGenerator=l;var c=function(e){function t(t,r,n,i,o){void 0===o&&(o=a.NORMAL),e.call(this,t,r,n),this._mode=o,this._viewType=i,this._vertex=new u(this),this._fragment=new l(this),this.compile()}return n(t,e),t.prototype.compile=function(){var e=this,t=this._spec,r=this._shader,n=this._asUniform;switch(this._voutMapping=new o.Dictionary,this._foutMapping=new o.Dictionary,this._vertex.addLine("precision highp float;"),this._fragment.addLine("precision highp float;"),this._mode==a.PICK&&(this._vertex.addAttribute("s3_pick_index","Vector4"),this._vertex.addUniform("s3_pick_index_alpha","float")),this._viewType){case s.VIEW_2D:this._vertex.addUniform("s3_view_params","Vector4"),this._vertex.addAdditionalCode("\n                    vec4 s3_render_vertex(vec3 p) {\n                        return vec4(p.xy * s3_view_params.xy + s3_view_params.zw, 0.0, 1.0);\n                    }\n                ");break;case s.VIEW_3D:this._vertex.addUniform("s3_view_params","Vector4"),this._vertex.addUniform("s3_view_position","Vector3"),this._vertex.addUniform("s3_view_rotation","Vector4"),this._vertex.addAdditionalCode("\n                    vec4 s3_render_vertex(vec3 p) {\n                        // Get position in view coordinates:\n                        //   v = quaternion_inverse_rotate(rotation, p - position)\n                        vec3 v = p - s3_view_position;\n                        float d = dot(s3_view_rotation.xyz, v);\n                        vec3 c = cross(s3_view_rotation.xyz, v);\n                        v = s3_view_rotation.w * s3_view_rotation.w * v - (s3_view_rotation.w + s3_view_rotation.w) * c + d * s3_view_rotation.xyz - cross(c, s3_view_rotation.xyz);\n                        // Compute projection.\n                        vec4 r;\n                        r.xy = v.xy * s3_view_params.xy;\n                        r.z = v.z * s3_view_params.z + s3_view_params.w;\n                        r.w = -v.z;\n                        return r;\n                    }\n                ");break;case s.VIEW_WEBVR:this._vertex.addUniform("s3_projection_matrix","Matrix4"),this._vertex.addUniform("s3_view_matrix","Matrix4"),this._vertex.addUniform("s3_view_position","Vector3"),this._vertex.addUniform("s3_view_rotation","Vector4"),this._vertex.addAdditionalCode("\n                    vec4 s3_render_vertex(vec3 p) {\n                        vec3 v = p - s3_view_position;\n                        float d = dot(s3_view_rotation.xyz, v);\n                        vec3 c = cross(s3_view_rotation.xyz, v);\n                        v = s3_view_rotation.w * s3_view_rotation.w * v - (s3_view_rotation.w + s3_view_rotation.w) * c + d * s3_view_rotation.xyz - cross(c, s3_view_rotation.xyz);\n                        return s3_projection_matrix * s3_view_matrix * vec4(v, 1);\n                    }\n                ")}for(var i in t.input)t.input.hasOwnProperty(i)&&(n(i)?this._vertex.addUniform(i,t.input[i].type):this._vertex.addAttribute(i,t.input[i].type));for(var u in this._vertex.addLine("@additionalCode"),t.output)if(t.output.hasOwnProperty(u)){var l=this.getUnusedName(u);this._voutMapping.set(u,l),this._vertex.addVarying(l,t.output[u].type)}var c=[];for(var p in r.input)if(r.input.hasOwnProperty(p))if(this.fragmentPassthru(p)){var h=this.getUnusedName(p);c.push([h,p]),this._vertex.addVarying(h,r.input[p].type),this._fragment.addVarying(h,r.input[p].type)}else h=this._voutMapping.get(p),this._fragment.addVarying(h,r.input[p].type);for(var d in this._mode==a.PICK&&this._vertex.addVarying("out_pick_index","Vector4"),this._vertex.addLine("void main() {"),this._vertex.indent(),t.variables)if(t.variables.hasOwnProperty(d)){var m=t.variables[d];this._vertex.addDeclaration(d,m)}if(this._vertex.addStatements(t.statements),this._vertex.unindent(),this._vertex.addLine("}"),this._vertexCode=this._vertex.getCode(),this._mode==a.PICK)this._fragmentCode="\n                precision highp float;\n                varying vec4 out_pick_index;\n                void main() {\n                    gl_FragColor = out_pick_index;\n                }\n            ";else{for(var f in r.output)r.output.hasOwnProperty(f)&&(l=this.getUnusedName(f),this._foutMapping.set(f,l),this._fragment.addDeclaration(l,r.output[f].type));for(var g in this._fragment.addLine("void main() {"),this._fragment.indent(),r.variables)r.variables.hasOwnProperty(g)&&(m=r.variables[g],this._fragment.addDeclaration(g,m));var v=function(t){r.input.hasOwnProperty(t)&&(y.fragmentPassthru(t)?c.forEach((function(r){var n=r[0];r[1]==t&&e._fragment.addLine(t+" = "+n+";")})):(y._fragment.addDeclaration(t,r.input[t].type),y._fragment.addLine(t+" = "+y._voutMapping.get(t)+";")))},y=this;for(var _ in r.input)v(_);this._fragment.addStatements(r.statements),this._fragment.unindent(),this._fragment.addLine("}"),this._fragmentCode=this._fragment.getCode()}},t.prototype.getVertexCode=function(){return this._vertexCode},t.prototype.getFragmentCode=function(){return this._fragmentCode},t}(i.ProgramGenerator);r.Generator=c},{"../glsl/glsl":30,"stardust-core":27}],35:[function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("stardust-core"),o=e("stardust-core"),a=e("stardust-core"),s=e("./generator"),u=e("stardust-core"),l=e("stardust-core"),c=e("./webglutils"),p=function(){function e(e,t,r,n,i,o){this._GL=e;var u=new s.Generator(t,r,n,i,o);this._program=c.compileProgram(this._GL,u.getVertexCode(),u.getFragmentCode()),this._uniformLocations=new a.Dictionary,this._attribLocations=new a.Dictionary,this._textures=new a.Dictionary,this._currentTextureUnit=0}return e.prototype.use=function(){this._GL.useProgram(this._program)},e.prototype.setUniform=function(e,t,r){var n=this.getUniformLocation(e);if(null!=n){var i=this._GL;if("float"==t.primitive){var o=r;switch(t.primitiveCount){case 1:i.uniform1f(n,r);break;case 2:i.uniform2f(n,o[0],o[1]);break;case 3:i.uniform3f(n,o[0],o[1],o[2]);break;case 4:i.uniform4f(n,o[0],o[1],o[2],o[3])}}if("int"==t.primitive)switch(o=r,t.primitiveCount){case 1:i.uniform1i(n,r);break;case 2:i.uniform2i(n,o[0],o[1]);break;case 3:i.uniform3i(n,o[0],o[1],o[2]);break;case 4:i.uniform4i(n,o[0],o[1],o[2],o[3])}}},e.prototype.setTexture=function(e,t){var r=this._GL;if(!this._textures.has(e)){var n=r.createTexture(),o=this._currentTextureUnit++;this._textures.set(e,{data:null,texture:n,unit:o}),r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.bindTexture(r.TEXTURE_2D,null),this.use(),this.setUniform(e,i.types.int,o)}var a=this._textures.get(e),s=t.getTextureData();a.data!=s&&(a.data=s,r.bindTexture(r.TEXTURE_2D,a.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,s.width,s.height,0,r.RGBA,r.FLOAT,s.data),r.bindTexture(r.TEXTURE_2D,null),this.use(),1==s.dimensions&&this.setUniform(e+"_length",i.types.int,s.width),2==s.dimensions&&(this.setUniform(e+"_width",i.types.int,s.width),this.setUniform(e+"_height",i.types.int,s.height)))},e.prototype.bindTextures=function(){var e=this._GL;this._textures.forEach((function(t){e.activeTexture(e.TEXTURE0+t.unit),e.bindTexture(e.TEXTURE_2D,t.texture)}))},e.prototype.unbindTextures=function(){var e=this._GL;this._textures.forEach((function(t){e.activeTexture(e.TEXTURE0+t.unit),e.bindTexture(e.TEXTURE_2D,null)}))},e.prototype.getUniformLocation=function(e){if(this._uniformLocations.has(e))return this._uniformLocations.get(e);var t=this._GL.getUniformLocation(this._program,e);return this._uniformLocations.set(e,t),t},e.prototype.getAttribLocation=function(e){if(this._attribLocations.has(e))return this._attribLocations.get(e);var t=this._GL.getAttribLocation(this._program,e);return t<0&&(t=null),this._attribLocations.set(e,t),t},e}(),h=function(e){function t(){e.apply(this,arguments)}return n(t,e),t}(i.PlatformMarkData);r.WebGLPlatformMarkData=h;var d=function(e){function t(t,r,n,i,a,u,l){var c=this;e.call(this),this._platform=t,this._GL=r,this._mark=n,this._bindings=u,this._shiftBindings=l,this._spec=i,this._shader=a;var h=o.flattenEmits(i);this._specFlattened=h.specification,this._flattenedVertexIndexVariable=h.indexVariable,this._flattenedVertexCount=h.count,this._program=new p(r,this._specFlattened,this._shader,(function(e){return c.isUniform(e)}),this._platform.viewInfo.type,s.GenerateMode.NORMAL),this._programPick=new p(r,this._specFlattened,this._shader,(function(e){return c.isUniform(e)}),this._platform.viewInfo.type,s.GenerateMode.PICK),this.initializeUniforms()}return n(t,e),t.prototype.initializeUniforms=function(){for(var e in this._specFlattened.input)if(this.isUniform(e)){var t=this._bindings.get(e);t.bindingType==i.BindingType.VALUE&&this.updateUniform(e,t.specValue),t.bindingType==i.BindingType.TEXTURE&&this.updateTexture(e,t.textureValue)}},t.prototype.initializeBuffers=function(){var e=this,t=this._GL,r=new h;return r.buffers=new a.Dictionary,this._bindings.forEach((function(n,i){e.isUniform(i)||null!=e._program.getAttribLocation(i)&&r.buffers.set(i,t.createBuffer())})),r.buffers.set(this._flattenedVertexIndexVariable,t.createBuffer()),this._programPick&&r.buffers.set("s3_pick_index",t.createBuffer()),r.ranges=[],r},t.prototype.isUniform=function(e){if(e==this._flattenedVertexIndexVariable)return!1;if(null==this._bindings.get(e)){if(null==this._shiftBindings.get(e))throw new u.RuntimeError("attribute "+e+" is not specified.");return this._bindings.get(this._shiftBindings.get(e).name).bindingType!=i.BindingType.FUNCTION}return this._bindings.get(e).bindingType!=i.BindingType.FUNCTION},t.prototype.updateUniform=function(e,t){var r=this._bindings.get(e).valueType;this._program.use(),this._program.setUniform(e,r,t),this._programPick&&(this._programPick.use(),this._programPick.setUniform(e,r,t))},t.prototype.updateTexture=function(e,t){this._program.setTexture(e,t),this._programPick&&this._programPick.setTexture(e,t)},t.prototype.uploadData=function(e){var t=this.initializeBuffers();t.ranges=[];var r=this._spec.repeatBegin||0,n=this._spec.repeatEnd||0,i=this._GL,o=(this._bindings,this._flattenedVertexCount),a=0;e.forEach((function(e){var i=e.length;if(0!=i){var s=a,u=a+=i+r+n;t.ranges.push([s*o,u*o])}else t.ranges.push(null)})),this._bindings.forEach((function(s,u){var l=t.buffers.get(u);if(null!=l){var c=s.valueType,p=new Float32Array(c.primitiveCount*a*o),h=0,d=c.primitiveCount*o;e.forEach((function(e){if(0!=e.length){for(var t=0;t<r;t++)s.fillBinary([e[0]],o,p.subarray(h,h+d)),h+=d;for(s.fillBinary(e,o,p.subarray(h,h+e.length*d)),h+=e.length*d,t=0;t<n;t++)s.fillBinary([e[e.length-1]],o,p.subarray(h,h+d)),h+=d}})),i.bindBuffer(i.ARRAY_BUFFER,l),i.bufferData(i.ARRAY_BUFFER,p,i.STATIC_DRAW)}}));for(var s=new Float32Array(a*o),u=0;u<a*o;u++)s[u]=u%o;if(i.bindBuffer(i.ARRAY_BUFFER,t.buffers.get(this._flattenedVertexIndexVariable)),i.bufferData(i.ARRAY_BUFFER,s,i.STATIC_DRAW),this._programPick){var l=new Float32Array(a*o*4);for(u=0;u<a*o;u++){var c=Math.floor(u/o);l[4*u+0]=(255&c)/255,l[4*u+1]=((65280&c)>>8)/255,l[4*u+2]=((16711680&c)>>16)/255,l[4*u+3]=((4278190080&c)>>24)/255}i.bindBuffer(i.ARRAY_BUFFER,t.buffers.get("s3_pick_index")),i.bufferData(i.ARRAY_BUFFER,l,i.STATIC_DRAW)}return t},t.prototype.renderBase=function(e,t,r){var n=this;if(e.ranges.length>0){var i=this._GL,o=this._specFlattened,a=this._bindings,u=this._program;t==s.GenerateMode.PICK&&(u=this._programPick),u.use();var l=0,c=0;for(var p in this._shiftBindings.forEach((function(e,t){e.offset>c&&(c=e.offset),e.offset<l&&(l=e.offset)})),o.input)if(null!=(m=u.getAttribLocation(p)))if(this._shiftBindings.has(p)){var h=this._shiftBindings.get(p);i.bindBuffer(i.ARRAY_BUFFER,e.buffers.get(h.name)),i.enableVertexAttribArray(m);var d=a.get(h.name).valueType;i.vertexAttribPointer(m,d.primitiveCount,"float"==d.primitive?i.FLOAT:i.INT,!1,0,d.size*(h.offset-l)*this._flattenedVertexCount)}else i.bindBuffer(i.ARRAY_BUFFER,e.buffers.get(p)),i.enableVertexAttribArray(m),p==this._flattenedVertexIndexVariable?i.vertexAttribPointer(m,1,i.FLOAT,!1,0,4*-l*this._flattenedVertexCount):(d=a.get(p).valueType,i.vertexAttribPointer(m,d.primitiveCount,"float"==d.primitive?i.FLOAT:i.INT,!1,0,d.size*-l*this._flattenedVertexCount));if(t==s.GenerateMode.PICK){var m=u.getAttribLocation("s3_pick_index");i.bindBuffer(i.ARRAY_BUFFER,e.buffers.get("s3_pick_index")),i.enableVertexAttribArray(m),i.vertexAttribPointer(m,4,i.FLOAT,!1,0,0)}var f=this._platform.viewInfo,g=this._platform.pose;switch(f.type){case s.ViewType.VIEW_2D:i.uniform4f(u.getUniformLocation("s3_view_params"),2/f.width,-2/f.height,-1,1);break;case s.ViewType.VIEW_3D:i.uniform4f(u.getUniformLocation("s3_view_params"),1/Math.tan(f.fovY/2)/f.aspectRatio,1/Math.tan(f.fovY/2),(f.near+f.far)/(f.near-f.far),2*f.near*f.far/(f.near-f.far)),g?(i.uniform4f(u.getUniformLocation("s3_view_rotation"),g.rotation.x,g.rotation.y,g.rotation.z,g.rotation.w),i.uniform3f(u.getUniformLocation("s3_view_position"),g.position.x,g.position.y,g.position.z)):(i.uniform4f(u.getUniformLocation("s3_view_rotation"),0,0,0,1),i.uniform3f(u.getUniformLocation("s3_view_position"),0,0,0));break;case s.ViewType.VIEW_WEBVR:i.uniformMatrix4fv(u.getUniformLocation("s3_view_matrix"),!1,f.viewMatrix),i.uniformMatrix4fv(u.getUniformLocation("s3_projection_matrix"),!1,f.projectionMatrix),g?(i.uniform4f(u.getUniformLocation("s3_view_rotation"),g.rotation.x,g.rotation.y,g.rotation.z,g.rotation.w),i.uniform3f(u.getUniformLocation("s3_view_position"),g.position.x,g.position.y,g.position.z)):(i.uniform4f(u.getUniformLocation("s3_view_rotation"),0,0,0,1),i.uniform3f(u.getUniformLocation("s3_view_position"),0,0,0))}for(var v in t==s.GenerateMode.PICK&&i.uniform1f(u.getUniformLocation("s3_pick_index_alpha"),this._pickIndex/255),u.bindTextures(),e.ranges.forEach((function(e,t){r&&r(t),null!=e&&(u.use(),u.bindTextures(),i.drawArrays(i.TRIANGLES,e[0],e[1]-e[0]-(c-l)*n._flattenedVertexCount))})),u.unbindTextures(),o.input)null!=(m=u.getAttribLocation(v))&&i.disableVertexAttribArray(m);t==s.GenerateMode.PICK&&(m=u.getAttribLocation("s3_pick_index"),i.disableVertexAttribArray(m))}},t.prototype.setPickIndex=function(e){this._pickIndex=e},t.prototype.render=function(e,t){this._platform.renderMode==s.GenerateMode.PICK&&this.setPickIndex(this._platform.assignPickIndex(this._mark)),this.renderBase(e,this._platform.renderMode,t)},t}(i.PlatformMark);r.WebGLPlatformMark=d;var m=function(e){function t(t){e.call(this),this._GL=t,this.set2DView(500,500),this.setPose(new l.Pose),this._renderMode=s.GenerateMode.NORMAL,this._pickFramebuffer=null}return n(t,e),Object.defineProperty(t.prototype,"viewInfo",{get:function(){return this._viewInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pose",{get:function(){return this._pose},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderMode",{get:function(){return this._renderMode},enumerable:!0,configurable:!0}),t.prototype.getPickFramebuffer=function(e,t){if(null==this._pickFramebuffer||e!=this._pickFramebufferWidth||t!=this._pickFramebufferHeight){var r=this._GL;this._pickFramebuffer=r.createFramebuffer(),this._pickFramebufferWidth=e,this._pickFramebufferHeight=t,r.bindFramebuffer(r.FRAMEBUFFER,this._pickFramebuffer),this._pickFramebufferTexture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this._pickFramebufferTexture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e,t,0,r.RGBA,r.UNSIGNED_BYTE,null),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this._pickFramebufferTexture,0),r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null)}return this._pickFramebuffer},t.prototype.beginPicking=function(e,t){this._renderMode=s.GenerateMode.PICK;var r=this._GL,n=this.getPickFramebuffer(e,t);r.bindFramebuffer(r.FRAMEBUFFER,n),r.clearColor(1,1,1,1),r.clear(r.COLOR_BUFFER_BIT),r.disable(r.BLEND),this._pickMarks=[]},t.prototype.assignPickIndex=function(e){var t=this._pickMarks.indexOf(e);if(t>=0)return t;var r=this._pickMarks.length;return this._pickMarks.push(e),r},t.prototype.endPicking=function(){var e=this._GL;e.bindFramebuffer(e.FRAMEBUFFER,null),e.enable(e.BLEND),this._renderMode=s.GenerateMode.NORMAL},t.prototype.getPickingPixel=function(e,t){if(null==this._pickMarks||e<0||t<0||e>=this._pickFramebufferWidth||t>=this._pickFramebufferHeight)return null;var r=this._GL,n=this._pickFramebuffer;r.bindFramebuffer(r.FRAMEBUFFER,n);var i=new Uint8Array(4);r.readPixels(e,this._pickFramebufferHeight-1-t,1,1,r.RGBA,r.UNSIGNED_BYTE,i),r.bindFramebuffer(r.FRAMEBUFFER,null);var o=i[0]+(i[1]<<8)+(i[2]<<16);return o>=16777215?null:[this._pickMarks[i[3]],o]},t.prototype.set2DView=function(e,t){this._viewInfo={type:s.ViewType.VIEW_2D,width:e,height:t}},t.prototype.set3DView=function(e,t,r,n){void 0===r&&(r=.1),void 0===n&&(n=1e3),this._viewInfo={type:s.ViewType.VIEW_3D,fovY:e,aspectRatio:t,near:r,far:n}},t.prototype.setWebVRView=function(e,t){this._viewInfo={type:s.ViewType.VIEW_WEBVR,viewMatrix:e,projectionMatrix:t}},t.prototype.setPose=function(e){this._pose=e},t.prototype.compile=function(e,t,r,n,i){return new d(this,this._GL,e,t,r,n,i)},t}(i.Platform);r.WebGLPlatform=m;var f=function(e){function t(t,r,n){void 0===r&&(r=600),void 0===n&&(n=400);var i=t.getContext("webgl")||t.getContext("experimental-webgl");try{i.getExtension("OES_texture_float"),i.getExtension("OES_texture_float_linear")}catch(e){}e.call(this,i),this._canvas=t,i.clearColor(1,1,1,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.disable(i.DEPTH_TEST),i.enable(i.BLEND),i.disable(i.CULL_FACE),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),this._pixelRatio=2,this.resize(r,n)}return n(t,e),Object.defineProperty(t.prototype,"pixelRatio",{get:function(){return this._pixelRatio},set:function(e){this._pixelRatio=e,this.resize(this._width,this._height)},enumerable:!0,configurable:!0}),t.prototype.resize=function(e,t){this._width=e,this._height=t,this._canvas.style.width=e+"px",this._canvas.style.height=t+"px",this._canvas.width=e*this._pixelRatio,this._canvas.height=t*this._pixelRatio,this.set2DView(e,t),this.setPose(new l.Pose),this._GL.viewport(0,0,this._canvas.width,this._canvas.height)},t.prototype.clear=function(e){e&&this._GL.clearColor(e[0],e[1],e[2],null!=e[3]?e[3]:1),this._GL.clear(this._GL.COLOR_BUFFER_BIT|this._GL.DEPTH_BUFFER_BIT)},t}(m);r.WebGLCanvasPlatform2D=f;var g=function(e){function t(t,r,n){void 0===r&&(r=600),void 0===n&&(n=400);var i=t.getContext("webgl")||t.getContext("experimental-webgl");e.call(this,i),this._canvas=t,i.clearColor(1,1,1,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.DEPTH_TEST),i.enable(i.BLEND),i.disable(i.CULL_FACE),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),this._pixelRatio=2,e.prototype.set3DView.call(this,Math.PI/4,r/n,.1,1e3),this.resize(r,n)}return n(t,e),Object.defineProperty(t.prototype,"pixelRatio",{get:function(){return this._pixelRatio},set:function(e){this._pixelRatio=e,this.resize(this._width,this._height)},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,r){this._width=t,this._height=r,this._canvas.style.width=t+"px",this._canvas.style.height=r+"px",this._canvas.width=t*this._pixelRatio,this._canvas.height=r*this._pixelRatio,this._GL.viewport(0,0,this._canvas.width,this._canvas.height),e.prototype.set3DView.call(this,this._viewInfo.fovY,this._width/this._height,this._viewInfo.near,this._viewInfo.far)},t.prototype.set3DView=function(t,r,n){void 0===r&&(r=.1),void 0===n&&(n=1e3),e.prototype.set3DView.call(this,t,this._width/this._height,r,n)},t.prototype.setMVPMatrix=function(e){throw new u.RuntimeError("not implemented")},t.prototype.clear=function(e){e&&this._GL.clearColor(e[0],e[1],e[2],null!=e[3]?e[3]:1),this._GL.clear(this._GL.COLOR_BUFFER_BIT|this._GL.DEPTH_BUFFER_BIT)},t}(m);r.WebGLCanvasPlatform3D=g;var v=function(e){function t(t,r,n){void 0===r&&(r=600),void 0===n&&(n=400);var i=t.getContext("webgl")||t.getContext("experimental-webgl");e.call(this,i),this._canvas=t,i.clearColor(1,1,1,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.DEPTH_TEST),i.enable(i.BLEND),i.disable(i.CULL_FACE),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),this._pixelRatio=2,this.resize(r,n),this.setWebVRView([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return n(t,e),Object.defineProperty(t.prototype,"pixelRatio",{get:function(){return this._pixelRatio},set:function(e){this._pixelRatio=e,this.resize(this._width,this._height)},enumerable:!0,configurable:!0}),t.prototype.resize=function(e,t){this._width=e,this._height=t,this._canvas.width=e*this._pixelRatio,this._canvas.height=t*this._pixelRatio},t.prototype.set3DView=function(t,r,n){void 0===r&&(r=.1),void 0===n&&(n=1e3),e.prototype.set3DView.call(this,t,this._width/this._height,r,n)},t.prototype.setWebVRView=function(t,r){e.prototype.setWebVRView.call(this,t,r)},t.prototype.clear=function(e){e&&this._GL.clearColor(e[0],e[1],e[2],null!=e[3]?e[3]:1),this._GL.clear(this._GL.COLOR_BUFFER_BIT|this._GL.DEPTH_BUFFER_BIT)},t}(m);r.WebGLCanvasPlatformWebVR=v},{"./generator":34,"./webglutils":36,"stardust-core":27}],36:[function(e,t,r){"use strict";var n=e("stardust-core");r.compileProgram=function(e,t,r){var i=e.createShader(e.VERTEX_SHADER);e.shaderSource(i,t),e.compileShader(i);var o=e.getShaderParameter(i,e.COMPILE_STATUS);if(!o)throw console.log("Vertex shader code is:",t),new n.RuntimeError("could not compile vertex shader: "+e.getShaderInfoLog(i));var a=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(a,r),e.compileShader(a),!(o=e.getShaderParameter(a,e.COMPILE_STATUS)))throw console.log("Fragment shader code is:",r),new n.RuntimeError("could not compile fragment shader: "+e.getShaderInfoLog(a));var s=e.createProgram();if(e.attachShader(s,i),e.attachShader(s,a),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw new n.RuntimeError("could not link shader: "+e.getProgramInfoLog(s));return s}},{"stardust-core":27}]},{},[1])(1)}])}));