!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),a=n(2);e.default=class{constructor(t,e,n){this.$_style={},this.$_mousedownCallbackSet=new Set,this.$_mouseupCallbackSet=new Set,this.$_mouseoverCallbackSet=new Set,this.$_mouseoutCallbackSet=new Set,this.$_mousemoveCallbackSet=new Set,this.$_clickCallbackSet=new Set,this.$_attributes={},this.$_core=t,this.type=n;const r=this.$_core.$_configs;this.$_style=JSON.parse(JSON.stringify(r[this.type.toLowerCase()].style)),"style"in e&&Object.entries(e.style).forEach(([t,e])=>{const n=e,r=t;n!==Object(n)?this.$_style[r]=n:this.$_style[r]={...this.$_style[r],...n}});const a=this.$_core.$_renderer[this.type.toLowerCase()+"Manager"];this.$_changeRenderAttribute=a.changeAttribute.bind(a),Object.keys(this.$_style).forEach(t=>{this[t]=this.generateElementStyleGetterSetter(t)})}on(t,e){var n;if("drag"!==t.slice(0,4)||"drag"===t.slice(0,4)&&"Node"===this.type){const r=`$_${t}CallbackSet`;null===(n=this[r])||void 0===n||n.add(e||a.EMPTY_FUNCTION),this[r]&&this.$_core.$_interactionManager.increaseMouseEventCallbackCountBy(1)}}off(t,e){var n;if("drag"!==t.slice(0,4)||"drag"===t.slice(0,4)&&"Node"===this.type){const r=`$_${t}CallbackSet`;null===(n=this[r])||void 0===n||n.delete(e||a.EMPTY_FUNCTION),this[r]&&this.$_core.$_interactionManager.decreaseMouseEventCallbackCountBy(1)}}attr(t,e){if(2===arguments.length)this.$_attributes[t]=e;else{if(1===arguments.length)return this.$_attributes[t];if(0===arguments.length)return JSON.parse(JSON.stringify(this.$_attributes))}}generateElementStyleGetterSetter(t){return e=>(void 0!==e&&(e===Object(e)?this.$_style[t]=r.override(this.$_style[t],e):this.$_style[t]=e,this.$_changeRenderAttribute(this,t)),this.$_style[t])}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.override=e.transformGraphPosition=void 0,e.transformGraphPosition=function(t,e,n,r){const a=JSON.parse(JSON.stringify(t)),o=a.nodes.map(t=>t.x),i=a.nodes.map(t=>t.y),s=Math.min(...o),u=Math.max(...o),c=Math.min(...i),l=Math.max(...i),p=(s+u)/2,d=(c+l)/2;return a.nodes.forEach(t=>{t.x=(t.x-p)/(u-s)*e+n,t.y=(t.y-d)/(l-c)*e+r}),a},e.override=function t(e,n){if(e!==Object(e))return n!==Object(n)?n:JSON.parse(JSON.stringify(n));const r=JSON.parse(JSON.stringify(e));for(const e in n)e in r&&n[e]===Object(n[e])?r[e]=t(r[e],n[e]):r[e]=n[e];return r}},function(t,e,n){"use strict";n.r(e),n.d(e,"EMPTY_FUNCTION",(function(){return r}));const r=()=>{}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(4),a=n(5),o=n(7),i=n(8),s=n(9),u=n(12),c=n(1),l=n(2),p=n(13),d=n(14);class h{constructor(t){if(this.$_id2node=new Map,this.$_ends2link=new r.default,this.$_sourceId2links=new Map,this.$_targetId2links=new Map,this.$_configs=JSON.parse(JSON.stringify(i)),this.$_transform={x:0,y:0,k:1},this.$_lazyUpdate=!1,this.$_data={nodes:[],links:[]},!("container"in t)||"DIV"!==t.container.tagName)throw Error("Container should be specified as a div element!");this.$_container=t.container,this.$_configs=c.override(this.$_configs,t),delete this.$_configs.container,console.log("lyhlyh11"),p.logJs();const e=document.getElementById("main-canvas"),n=d.platform("webgl-2d",e,this.$_configs.width,this.$_configs.height);console.log("init platform");for(var a=[],o=0;o<96;o++)for(var s=0;s<50;s++){var l=o/95*2-1,h=s/49*2-1,m=Math.sqrt(l*l+h*h),f=m*Math.exp(-m*m*5),g=h/m*f,y=-l/m*f;a.push({x:l+2*g,y:h+2*y})}let v=new d.mark.circle(16);console.log("init mark");var _=d.mark.create(v,n),x=d.mark.create(v,n),b=d.scale.linear().domain([-1,1]).range([10,950]),C=d.scale.linear().domain([-1,1]).range([10,490]);_.attr("center",d.scale.Vector2(b(t=>t.x),C(t=>t.y))),_.attr("radius",2),_.attr("color",[0,0,0,.4]),x.attr("center",d.scale.Vector2(b(t=>t.x),C(t=>t.y))),x.attr("radius",4),x.attr("color",[255,0,0,1]),_.data(a),console.log("init data"),_.render(),console.log("init render"),n.endPicking(),e.onmousemove=t=>{let r=e.getBoundingClientRect();var o=t.clientX-r.left,i=t.clientY-r.top,s=n.getPickingPixel(2*o,2*i);s&&(n.clear(),_.render(),x.attr("color",[1,0,0,1]),x.data([a[s[1]]]),x.render(),console.log("log in render"))},this.$_interactionManager=new u.InteractionManager(this)}backgroundColor(t){return t&&(this.$_configs.backgroundColor=t,this.$_renderer.setBackgroundColor(t)),this.$_configs.backgroundColor}data(t){if(void 0===t)return this.$_data;this.$_data={...this.$_data,...t},this.$_id2node=new Map,this.$_ends2link=new r.default,this.$_sourceId2links=new Map,this.$_targetId2links=new Map,this.$_renderer.clearData(),this.addNodes(this.$_data.nodes),this.addLinks(this.$_data.links)}addNode(t){return this.addNodes([t])[0]}addLink(t){return this.addLinks([t])[0]}addNodes(t){const e=t.map(t=>{t.id=t.id.toString();return new a.default(this,t)});return this.$_renderer.addNodes(e),e}addLinks(t){const e=new Array(t.length);for(let n=0;n<t.length;n++){const r=t[n];r.source=r.source.toString(),r.target=r.target.toString();const a=new o.default(this,r);e[n]=a}return this.$_renderer.addLinks(e),e}getNodeById(t){return this.$_id2node.get(t)}getLinkByEnds(t,e){return this.$_ends2link.get([t,e])}nodes(){return[...this.$_id2node.values()]}links(){return[...this.$_ends2link.values()]}wipe(){this.$_data=void 0,this.$_id2node=new Map,this.$_ends2link=new r.default,this.$_sourceId2links=new Map,this.$_targetId2links=new Map,this.$_renderer.clearData()}dispose(){this.wipe(),this.$_renderer.dispose(),this.$_canvas.remove()}loadDataset(t){return t in s?s[t]:(console.error("NetV does not have build-in dataset: "+t),{nodes:[],links:[]})}getElementByPosition(t){const e=this.$_renderer.getIdByPosition(t);if(e){if("string"==typeof e){return{type:"node",element:this.getNodeById(e)}}if(Array.isArray(e)){return{type:"link",element:this.getLinkByEnds(e[0],e[1])}}}}draw(){this.$_renderer.draw()}transition(t,e,n){const r=a=>{if(a>=t.length-1)return;const o=Math.max(.06*e[a],1),i={...t[a]},s=t[a+1].x-t[a].x,u=t[a+1].y-t[a].y,c=t[a+1].k-t[a].k,l=t[a].x,p=t[a].y,d=t[a].k,h=t=>t*t;let m=1;const f=setInterval(()=>{i.x=l+s*h(m/o),i.y=p+u*h(m/o),i.k=d+c*h(m/o),this.transform(i),this.draw(),n&&n({transform:i}),m+=1,m>=o&&(clearInterval(f),r(a+1))},1/.06)};r(0)}centerOn(t){const e=t.position();return this.$_interactionManager.centerPosition(e)}panBy(t,e){return this.$_interactionManager.panBy(t,e)}zoomBy(t,e){return this.$_interactionManager.zoomBy(t,e)}transform(t){return void 0===t||(this.$_transform=t,this.$_renderer.setTransform(this.$_transform)),this.$_transform}on(t,e){"zoom"===t.toLowerCase()?this.$_interactionManager.onZoom(e||l.EMPTY_FUNCTION):"pan"===t.toLowerCase()?this.$_interactionManager.onPan(e||l.EMPTY_FUNCTION):"mousedown"===t.toLowerCase()?this.$_interactionManager.onMousedown(e||l.EMPTY_FUNCTION):"mouseup"===t.toLowerCase()?this.$_interactionManager.onMouseup(e||l.EMPTY_FUNCTION):"click"===t.toLowerCase()&&this.$_interactionManager.onClick(e||l.EMPTY_FUNCTION)}off(t,e){"zoom"===t.toLowerCase()?this.$_interactionManager.offZoom(e||l.EMPTY_FUNCTION):"pan"===t.toLowerCase()?this.$_interactionManager.offPan(e||l.EMPTY_FUNCTION):"mousedown"===t.toLowerCase()?this.$_interactionManager.offMousedown(e||l.EMPTY_FUNCTION):"mouseup"===t.toLowerCase()?this.$_interactionManager.offMouseup(e||l.EMPTY_FUNCTION):"click"===t.toLowerCase()&&this.$_interactionManager.offClick(e||l.EMPTY_FUNCTION)}}e.default=h,h.Utils=c,window.NetV=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=String.fromCharCode(7),a=t=>t instanceof Array&&2===t.length&&t.every(t=>null!=t);e.default=class{constructor(t){this.map=new Map,t instanceof Array&&t.forEach(t=>{let[e,n]=t;this.set(e,n)})}get size(){return this.map.size}delete(t){if(a(t)){const e=t.join(r),n=t[1]+r+t[0];let a=this.map;a.delete(e),a.delete(n)}}set(t,e){if(a(t)){const n=t.join(r),a=t[1]+r+t[0];let o=this.map;o.has(a)?o.set(a,e):o.set(n,e)}return this}get(t){if(a(t)){const e=t.join(r),n=t[1]+r+t[0];return this.map.get(e)||this.map.get(n)}}has(t){if(a(t)){const e=t.join(r),n=t[1]+r+t[0];return this.map.has(e)||this.map.has(n)}return!1}forEach(t){this.map.forEach((e,n)=>{let a=n.split(r);t(e,a,this)})}entries(){return[...this.map.entries()].map(t=>[t[0].split(r),t[1]])}keys(){return[...this.map.keys()].map(t=>t.split(r))}values(){return[...this.map.values()]}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(6),a=n(0);class o extends a.default{constructor(t,e){super(t,e,"Node"),this.$_position={x:0,y:0},this.$_dragstartCallbackSet=new Set,this.$_draggingCallbackSet=new Set,this.$_dragendCallbackSet=new Set,this.$_elementReservedKeys=new Set(["id","x","y","style"]);for(const t in e)this.$_elementReservedKeys.has(t)||(this.$_attributes[t]=e[t]);const n={x:this.$_position.x,y:this.$_position.y,...e};this.$_setId(n.id),this.$_position={x:n.x,y:n.y}}id(){return this.$_id}neighborNodes(){let t=this.$_core.$_sourceId2links.get(this.$_id);t||(t=new Set);let e=this.$_core.$_targetId2links.get(this.$_id);e||(e=new Set);const n=new Set([...[...t].map(t=>t.$_target),...[...e].map(t=>t.$_source)]);return Array.from(n)}neighborLinks(){let t=this.$_core.$_sourceId2links.get(this.$_id);t||(t=new Set);let e=this.$_core.$_targetId2links.get(this.$_id);e||(e=new Set);const n=new Set([...t,...e]);return Array.from(n)}x(t){return arguments.length>0&&this.position({x:t}),this.$_position.x}y(t){return arguments.length>0&&this.position({y:t}),this.$_position.y}position(t){let e={};if(arguments.length>0&&("x"in t||"y"in t)){if("x"in t&&(this.$_position.x=t.x),"y"in t&&(this.$_position.y=t.y),this.$_core.$_renderer.shouldLazyUpdate)return this.$_position;e={source:this.$_core.$_sourceId2links.get(this.$_id),target:this.$_core.$_targetId2links.get(this.$_id)},Object.entries(e).forEach(t=>{const e=t[0],n=t[1];if(n){this.$_core.$_renderer.increaseModifiedElementsCountBy(n.size);for(const t of n)this.$_core.$_renderer.linkManager.changeAttribute(t,e)}}),this.$_core.$_renderer.increaseModifiedElementsCountBy(1),this.$_core.$_renderer.nodeManager.changeAttribute(this,"position")}return this.$_position}$_setId(t){if(!r.isValidId(t))throw new Error("Invalid ID "+t);if(this.$_core.$_id2node.has(t))throw new Error(`Duplicate node (${t}) is not allowed.`);if(r.isValidId(this.$_id))throw new Error("Can not change the id of an exist node.");this.$_core.$_id2node.set(t,this),this.$_id=t}}e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isValidId=void 0,e.isValidId=function(t){return void 0!==t&&"string"==typeof t&&t.length>0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0);class a extends r.default{constructor(t,e){super(t,e,"Link"),this.$_elementReservedKeys=new Set(["source","target","style"]);for(const t in e)this.$_elementReservedKeys.has(t)||(this.$_attributes[t]=e[t]);const n=this.$_core.getNodeById(e.source),r=this.$_core.getNodeById(e.target);this.sourceTarget({source:n,target:r})}source(t){return 1===arguments.length&&this.sourceTarget({source:t,target:this.$_target}),this.$_source}target(t){return 1===arguments.length&&this.sourceTarget({source:this.$_source,target:t}),this.$_target}sourceTarget(t){var e,n;if(arguments.length>0){const r=this.$_source,a=this.$_target,o=t.source,i=t.target,s=o.$_id,u=i.$_id;if(o===i)throw new Error(`Self loop (${s} <=> ${u}) is not allowed.`);if(this.$_core.$_ends2link.has([s,u]))throw new Error(`Multiple link (${s} <=> ${u}) is not allowd.`);r&&a&&(this.$_core.$_ends2link.delete([r.$_id,a.$_id]),null===(e=this.$_core.$_sourceId2links.get(r.$_id))||void 0===e||e.delete(this),null===(n=this.$_core.$_targetId2links.get(a.$_id))||void 0===n||n.delete(this)),this.$_source=o,this.$_target=i,this.$_core.$_ends2link.set([s,u],this),this.$_core.$_sourceId2links.has(s)?this.$_core.$_sourceId2links.get(s).add(this):this.$_core.$_sourceId2links.set(s,new Set([this])),this.$_core.$_targetId2links.has(u)?this.$_core.$_targetId2links.get(u).add(this):this.$_core.$_targetId2links.set(u,new Set([this]))}return{source:this.$_source,target:this.$_target}}}e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.link=e.node=e.linkLimit=e.nodeLimit=e.enablePanZoom=e.backgroundColor=e.height=e.width=void 0,e.width=800,e.height=600,e.backgroundColor={r:1,g:1,b:1,a:1},e.enablePanZoom=!0,e.nodeLimit=1e3,e.linkLimit=2e4,e.node={style:{shape:"circle",offset:{x:0,y:0},fill:{r:.2,g:.6,b:.2,a:1},strokeColor:{r:.9,g:.9,b:.9,a:.6},strokeWidth:2,r:10,width:5,height:5,innerWidth:5,innerHeight:5,rotate:0,vertexAlpha:{x:0,y:-4},vertexBeta:{x:-2*Math.sqrt(3),y:2},vertexGamma:{x:2*Math.sqrt(3),y:2}}},e.link={style:{shape:"line",strokeColor:{r:.4,g:.6,b:.8,a:.5},strokeWidth:2,curveness:.2,dashInterval:5}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.patents=e.miserables=void 0;const r=n(10);Object.defineProperty(e,"miserables",{enumerable:!0,get:function(){return r.miserables}});const a=n(11);Object.defineProperty(e,"patents",{enumerable:!0,get:function(){return a.patents}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.miserables=void 0,e.miserables={nodes:[{id:"Myriel",x:293.47145117553623,y:356.4335718104138,group:1},{id:"Napoleon",x:253.9025088618656,y:374.3058116536445,group:1},{id:"Mlle.Baptistine",x:350.92724989918077,y:332.3325539999943,group:1},{id:"Mme.Magloire",x:356.0916156539997,y:352.7885799116015,group:1},{id:"CountessdeLo",x:254.29291520989335,y:357.3175734076417,group:1},{id:"Geborand",x:257.857293626201,y:335.85427628358957,group:1},{id:"Champtercier",x:259.6255563825028,y:383.83027469832814,group:1},{id:"Cravatte",x:249.8596459829139,y:346.18225516832496,group:1},{id:"Count",x:269.96793951350924,y:390.6800842321571,group:1},{id:"OldMan",x:246.73952311277665,y:364.59357494432066,group:1},{id:"Labarre",x:443.516583315026,y:358.29204789477683,group:2},{id:"Valjean",x:442.16894757641506,y:320.8315532160861,group:2},{id:"Marguerite",x:413.3816851007931,y:240.04091559296504,group:3},{id:"Mme.deR",x:427.2361715950254,y:355.10211589979514,group:2},{id:"Isabeau",x:405.85082858191834,y:330.5201512205085,group:2},{id:"Gervais",x:405.2113121906881,y:316.29125359396136,group:2},{id:"Tholomyes",x:422.4125307781646,y:126.07649449775806,group:3},{id:"Listolier",x:363.1729422677979,y:102.77890368289785,group:3},{id:"Fameuil",x:381.7947103094028,y:66.58133724043948,group:3},{id:"Blacheville",x:383.1792676740261,y:94.80320315500154,group:3},{id:"Favourite",x:361.893731644285,y:70.38696381384074,group:3},{id:"Dahlia",x:398.75350988351653,y:77.09700751527119,group:3},{id:"Zephine",x:349.0495914601376,y:88.80888613372713,group:3},{id:"Fantine",x:398.01411438702473,y:173.76444196945977,group:3},{id:"Mme.Thenardier",x:471.2516533386725,y:262.218701666645,group:4},{id:"Thenardier",x:504.81672085603066,y:283.04638900481723,group:4},{id:"Cosette",x:472.3346941487192,y:228.68779443303478,group:5},{id:"Javert",x:460.05257689332836,y:295.5578154268904,group:4},{id:"Fauchelevent",x:385.43935764589986,y:302.12824588622857,group:0},{id:"Bamatabois",x:393.19041590383597,y:345.4971667690817,group:2},{id:"Perpetue",x:367.53833132893976,y:194.5556482306271,group:3},{id:"Simplice",x:401.3622252354655,y:242.9982847994576,group:2},{id:"Scaufflaire",x:414.67072799627573,y:344.0547720945736,group:2},{id:"Woman1",x:421.4167414392426,y:293.31120219129394,group:2},{id:"Judge",x:420.04392007841335,y:401.03233609152744,group:2},{id:"Champmathieu",x:377.79524254621833,y:383.8105787115102,group:2},{id:"Brevet",x:401.9529844469992,y:388.8684782987411,group:2},{id:"Chenildieu",x:400.6685707133538,y:413.49417790523466,group:2},{id:"Cochepaille",x:379.04969704462354,y:404.26974059233163,group:2},{id:"Pontmercy",x:553.1137401750198,y:244.92830027360765,group:4},{id:"Boulatruelle",x:490.1571086086932,y:249.2101923835803,group:6},{id:"Eponine",x:549.7584267571892,y:302.9031065228431,group:4},{id:"Anzelma",x:515.3807399395134,y:257.0179688983911,group:4},{id:"Woman2",x:433.6608665340514,y:265.8174673886634,group:5},{id:"MotherInnocent",x:403.02536257416523,y:289.03312200121326,group:0},{id:"Gribier",x:341.80973227456775,y:294.212396148023,group:0},{id:"Jondrette",x:565.1965303422186,y:470.65950349375856,group:7},{id:"Mme.Burgon",x:569.1896269242101,y:426.66185053824563,group:7},{id:"Gavroche",x:572.1619393936826,y:364.22606766497563,group:8},{id:"Gillenormand",x:524.5914505208005,y:257.4012214828336,group:5},{id:"Magnon",x:492.548393202341,y:222.5966351328885,group:5},{id:"Mlle.Gillenormand",x:514.3692655023644,y:229.09670062389281,group:5},{id:"Mme.Pontmercy",x:549.3250508171474,y:196.14056833084936,group:5},{id:"Mlle.Vaubois",x:517.8593572394071,y:186.2488309111565,group:5},{id:"Lt.Gillenormand",x:543.274961139455,y:223.68184285180976,group:5},{id:"Marius",x:574.2576699056139,y:283.85211708310334,group:8},{id:"BaronessT",x:573.7140909650625,y:245.59311909245818,group:5},{id:"Mabeuf",x:628.5432532486191,y:314.22078408627164,group:8},{id:"Enjolras",x:588.2395498093626,y:342.0594469923279,group:8},{id:"Combeferre",x:637.7370664614637,y:351.69235762788395,group:8},{id:"Prouvaire",x:650.8833522869903,y:386.83918103509916,group:8},{id:"Feuilly",x:626.8556606438109,y:365.9084164593141,group:8},{id:"Courfeyrac",x:628.3448989975013,y:336.7666454119022,group:8},{id:"Bahorel",x:656.7717772764985,y:362.5885882509189,group:8},{id:"Bossuet",x:599.0185765743107,y:363.8286723407053,group:8},{id:"Joly",x:656.6182923735408,y:343.2375733559165,group:8},{id:"Grantaire",x:638.4375855314988,y:402.4387250378995,group:8},{id:"MotherPlutarch",x:664.556723861883,y:298.0336964526786,group:9},{id:"Gueulemer",x:508.16450525817805,y:330.4502907444367,group:4},{id:"Babet",x:492.56005279882095,y:325.9834092848427,group:4},{id:"Claquesous",x:510.93855506250077,y:309.2869380697328,group:4},{id:"Montparnasse",x:502.7190894173557,y:350.9275183133438,group:4},{id:"Toussaint",x:445.1254802056807,y:266.46242665022004,group:5},{id:"Child1",x:588.0351552386961,y:410.2195555961996,group:10},{id:"Child2",x:559.2777814782705,y:408.3533184893569,group:10},{id:"Brujon",x:537.1787383904656,y:337.86922775917947,group:4},{id:"Mme.Hucheloup",x:626.3775850466164,y:384.35202066894516,group:8}],links:[{source:"Napoleon",target:"Myriel",value:1},{source:"Mlle.Baptistine",target:"Myriel",value:8},{source:"Mme.Magloire",target:"Myriel",value:10},{source:"Mme.Magloire",target:"Mlle.Baptistine",value:6},{source:"CountessdeLo",target:"Myriel",value:1},{source:"Geborand",target:"Myriel",value:1},{source:"Champtercier",target:"Myriel",value:1},{source:"Cravatte",target:"Myriel",value:1},{source:"Count",target:"Myriel",value:2},{source:"OldMan",target:"Myriel",value:1},{source:"Valjean",target:"Labarre",value:1},{source:"Valjean",target:"Mme.Magloire",value:3},{source:"Valjean",target:"Mlle.Baptistine",value:3},{source:"Valjean",target:"Myriel",value:5},{source:"Marguerite",target:"Valjean",value:1},{source:"Mme.deR",target:"Valjean",value:1},{source:"Isabeau",target:"Valjean",value:1},{source:"Gervais",target:"Valjean",value:1},{source:"Listolier",target:"Tholomyes",value:4},{source:"Fameuil",target:"Tholomyes",value:4},{source:"Fameuil",target:"Listolier",value:4},{source:"Blacheville",target:"Tholomyes",value:4},{source:"Blacheville",target:"Listolier",value:4},{source:"Blacheville",target:"Fameuil",value:4},{source:"Favourite",target:"Tholomyes",value:3},{source:"Favourite",target:"Listolier",value:3},{source:"Favourite",target:"Fameuil",value:3},{source:"Favourite",target:"Blacheville",value:4},{source:"Dahlia",target:"Tholomyes",value:3},{source:"Dahlia",target:"Listolier",value:3},{source:"Dahlia",target:"Fameuil",value:3},{source:"Dahlia",target:"Blacheville",value:3},{source:"Dahlia",target:"Favourite",value:5},{source:"Zephine",target:"Tholomyes",value:3},{source:"Zephine",target:"Listolier",value:3},{source:"Zephine",target:"Fameuil",value:3},{source:"Zephine",target:"Blacheville",value:3},{source:"Zephine",target:"Favourite",value:4},{source:"Zephine",target:"Dahlia",value:4},{source:"Fantine",target:"Tholomyes",value:3},{source:"Fantine",target:"Listolier",value:3},{source:"Fantine",target:"Fameuil",value:3},{source:"Fantine",target:"Blacheville",value:3},{source:"Fantine",target:"Favourite",value:4},{source:"Fantine",target:"Dahlia",value:4},{source:"Fantine",target:"Zephine",value:4},{source:"Fantine",target:"Marguerite",value:2},{source:"Fantine",target:"Valjean",value:9},{source:"Mme.Thenardier",target:"Fantine",value:2},{source:"Mme.Thenardier",target:"Valjean",value:7},{source:"Thenardier",target:"Mme.Thenardier",value:13},{source:"Thenardier",target:"Fantine",value:1},{source:"Thenardier",target:"Valjean",value:12},{source:"Cosette",target:"Mme.Thenardier",value:4},{source:"Cosette",target:"Valjean",value:31},{source:"Cosette",target:"Tholomyes",value:1},{source:"Cosette",target:"Thenardier",value:1},{source:"Javert",target:"Valjean",value:17},{source:"Javert",target:"Fantine",value:5},{source:"Javert",target:"Thenardier",value:5},{source:"Javert",target:"Mme.Thenardier",value:1},{source:"Javert",target:"Cosette",value:1},{source:"Fauchelevent",target:"Valjean",value:8},{source:"Fauchelevent",target:"Javert",value:1},{source:"Bamatabois",target:"Fantine",value:1},{source:"Bamatabois",target:"Javert",value:1},{source:"Bamatabois",target:"Valjean",value:2},{source:"Perpetue",target:"Fantine",value:1},{source:"Simplice",target:"Perpetue",value:2},{source:"Simplice",target:"Valjean",value:3},{source:"Simplice",target:"Fantine",value:2},{source:"Simplice",target:"Javert",value:1},{source:"Scaufflaire",target:"Valjean",value:1},{source:"Woman1",target:"Valjean",value:2},{source:"Woman1",target:"Javert",value:1},{source:"Judge",target:"Valjean",value:3},{source:"Judge",target:"Bamatabois",value:2},{source:"Champmathieu",target:"Valjean",value:3},{source:"Champmathieu",target:"Judge",value:3},{source:"Champmathieu",target:"Bamatabois",value:2},{source:"Brevet",target:"Judge",value:2},{source:"Brevet",target:"Champmathieu",value:2},{source:"Brevet",target:"Valjean",value:2},{source:"Brevet",target:"Bamatabois",value:1},{source:"Chenildieu",target:"Judge",value:2},{source:"Chenildieu",target:"Champmathieu",value:2},{source:"Chenildieu",target:"Brevet",value:2},{source:"Chenildieu",target:"Valjean",value:2},{source:"Chenildieu",target:"Bamatabois",value:1},{source:"Cochepaille",target:"Judge",value:2},{source:"Cochepaille",target:"Champmathieu",value:2},{source:"Cochepaille",target:"Brevet",value:2},{source:"Cochepaille",target:"Chenildieu",value:2},{source:"Cochepaille",target:"Valjean",value:2},{source:"Cochepaille",target:"Bamatabois",value:1},{source:"Pontmercy",target:"Thenardier",value:1},{source:"Boulatruelle",target:"Thenardier",value:1},{source:"Eponine",target:"Mme.Thenardier",value:2},{source:"Eponine",target:"Thenardier",value:3},{source:"Anzelma",target:"Eponine",value:2},{source:"Anzelma",target:"Thenardier",value:2},{source:"Anzelma",target:"Mme.Thenardier",value:1},{source:"Woman2",target:"Valjean",value:3},{source:"Woman2",target:"Cosette",value:1},{source:"Woman2",target:"Javert",value:1},{source:"MotherInnocent",target:"Fauchelevent",value:3},{source:"MotherInnocent",target:"Valjean",value:1},{source:"Gribier",target:"Fauchelevent",value:2},{source:"Mme.Burgon",target:"Jondrette",value:1},{source:"Gavroche",target:"Mme.Burgon",value:2},{source:"Gavroche",target:"Thenardier",value:1},{source:"Gavroche",target:"Javert",value:1},{source:"Gavroche",target:"Valjean",value:1},{source:"Gillenormand",target:"Cosette",value:3},{source:"Gillenormand",target:"Valjean",value:2},{source:"Magnon",target:"Gillenormand",value:1},{source:"Magnon",target:"Mme.Thenardier",value:1},{source:"Mlle.Gillenormand",target:"Gillenormand",value:9},{source:"Mlle.Gillenormand",target:"Cosette",value:2},{source:"Mlle.Gillenormand",target:"Valjean",value:2},{source:"Mme.Pontmercy",target:"Mlle.Gillenormand",value:1},{source:"Mme.Pontmercy",target:"Pontmercy",value:1},{source:"Mlle.Vaubois",target:"Mlle.Gillenormand",value:1},{source:"Lt.Gillenormand",target:"Mlle.Gillenormand",value:2},{source:"Lt.Gillenormand",target:"Gillenormand",value:1},{source:"Lt.Gillenormand",target:"Cosette",value:1},{source:"Marius",target:"Mlle.Gillenormand",value:6},{source:"Marius",target:"Gillenormand",value:12},{source:"Marius",target:"Pontmercy",value:1},{source:"Marius",target:"Lt.Gillenormand",value:1},{source:"Marius",target:"Cosette",value:21},{source:"Marius",target:"Valjean",value:19},{source:"Marius",target:"Tholomyes",value:1},{source:"Marius",target:"Thenardier",value:2},{source:"Marius",target:"Eponine",value:5},{source:"Marius",target:"Gavroche",value:4},{source:"BaronessT",target:"Gillenormand",value:1},{source:"BaronessT",target:"Marius",value:1},{source:"Mabeuf",target:"Marius",value:1},{source:"Mabeuf",target:"Eponine",value:1},{source:"Mabeuf",target:"Gavroche",value:1},{source:"Enjolras",target:"Marius",value:7},{source:"Enjolras",target:"Gavroche",value:7},{source:"Enjolras",target:"Javert",value:6},{source:"Enjolras",target:"Mabeuf",value:1},{source:"Enjolras",target:"Valjean",value:4},{source:"Combeferre",target:"Enjolras",value:15},{source:"Combeferre",target:"Marius",value:5},{source:"Combeferre",target:"Gavroche",value:6},{source:"Combeferre",target:"Mabeuf",value:2},{source:"Prouvaire",target:"Gavroche",value:1},{source:"Prouvaire",target:"Enjolras",value:4},{source:"Prouvaire",target:"Combeferre",value:2},{source:"Feuilly",target:"Gavroche",value:2},{source:"Feuilly",target:"Enjolras",value:6},{source:"Feuilly",target:"Prouvaire",value:2},{source:"Feuilly",target:"Combeferre",value:5},{source:"Feuilly",target:"Mabeuf",value:1},{source:"Feuilly",target:"Marius",value:1},{source:"Courfeyrac",target:"Marius",value:9},{source:"Courfeyrac",target:"Enjolras",value:17},{source:"Courfeyrac",target:"Combeferre",value:13},{source:"Courfeyrac",target:"Gavroche",value:7},{source:"Courfeyrac",target:"Mabeuf",value:2},{source:"Courfeyrac",target:"Eponine",value:1},{source:"Courfeyrac",target:"Feuilly",value:6},{source:"Courfeyrac",target:"Prouvaire",value:3},{source:"Bahorel",target:"Combeferre",value:5},{source:"Bahorel",target:"Gavroche",value:5},{source:"Bahorel",target:"Courfeyrac",value:6},{source:"Bahorel",target:"Mabeuf",value:2},{source:"Bahorel",target:"Enjolras",value:4},{source:"Bahorel",target:"Feuilly",value:3},{source:"Bahorel",target:"Prouvaire",value:2},{source:"Bahorel",target:"Marius",value:1},{source:"Bossuet",target:"Marius",value:5},{source:"Bossuet",target:"Courfeyrac",value:12},{source:"Bossuet",target:"Gavroche",value:5},{source:"Bossuet",target:"Bahorel",value:4},{source:"Bossuet",target:"Enjolras",value:10},{source:"Bossuet",target:"Feuilly",value:6},{source:"Bossuet",target:"Prouvaire",value:2},{source:"Bossuet",target:"Combeferre",value:9},{source:"Bossuet",target:"Mabeuf",value:1},{source:"Bossuet",target:"Valjean",value:1},{source:"Joly",target:"Bahorel",value:5},{source:"Joly",target:"Bossuet",value:7},{source:"Joly",target:"Gavroche",value:3},{source:"Joly",target:"Courfeyrac",value:5},{source:"Joly",target:"Enjolras",value:5},{source:"Joly",target:"Feuilly",value:5},{source:"Joly",target:"Prouvaire",value:2},{source:"Joly",target:"Combeferre",value:5},{source:"Joly",target:"Mabeuf",value:1},{source:"Joly",target:"Marius",value:2},{source:"Grantaire",target:"Bossuet",value:3},{source:"Grantaire",target:"Enjolras",value:3},{source:"Grantaire",target:"Combeferre",value:1},{source:"Grantaire",target:"Courfeyrac",value:2},{source:"Grantaire",target:"Joly",value:2},{source:"Grantaire",target:"Gavroche",value:1},{source:"Grantaire",target:"Bahorel",value:1},{source:"Grantaire",target:"Feuilly",value:1},{source:"Grantaire",target:"Prouvaire",value:1},{source:"MotherPlutarch",target:"Mabeuf",value:3},{source:"Gueulemer",target:"Thenardier",value:5},{source:"Gueulemer",target:"Valjean",value:1},{source:"Gueulemer",target:"Mme.Thenardier",value:1},{source:"Gueulemer",target:"Javert",value:1},{source:"Gueulemer",target:"Gavroche",value:1},{source:"Gueulemer",target:"Eponine",value:1},{source:"Babet",target:"Thenardier",value:6},{source:"Babet",target:"Gueulemer",value:6},{source:"Babet",target:"Valjean",value:1},{source:"Babet",target:"Mme.Thenardier",value:1},{source:"Babet",target:"Javert",value:2},{source:"Babet",target:"Gavroche",value:1},{source:"Babet",target:"Eponine",value:1},{source:"Claquesous",target:"Thenardier",value:4},{source:"Claquesous",target:"Babet",value:4},{source:"Claquesous",target:"Gueulemer",value:4},{source:"Claquesous",target:"Valjean",value:1},{source:"Claquesous",target:"Mme.Thenardier",value:1},{source:"Claquesous",target:"Javert",value:1},{source:"Claquesous",target:"Eponine",value:1},{source:"Claquesous",target:"Enjolras",value:1},{source:"Montparnasse",target:"Javert",value:1},{source:"Montparnasse",target:"Babet",value:2},{source:"Montparnasse",target:"Gueulemer",value:2},{source:"Montparnasse",target:"Claquesous",value:2},{source:"Montparnasse",target:"Valjean",value:1},{source:"Montparnasse",target:"Gavroche",value:1},{source:"Montparnasse",target:"Eponine",value:1},{source:"Montparnasse",target:"Thenardier",value:1},{source:"Toussaint",target:"Cosette",value:2},{source:"Toussaint",target:"Javert",value:1},{source:"Toussaint",target:"Valjean",value:1},{source:"Child1",target:"Gavroche",value:2},{source:"Child2",target:"Gavroche",value:2},{source:"Child2",target:"Child1",value:3},{source:"Brujon",target:"Babet",value:3},{source:"Brujon",target:"Gueulemer",value:3},{source:"Brujon",target:"Thenardier",value:3},{source:"Brujon",target:"Gavroche",value:1},{source:"Brujon",target:"Eponine",value:1},{source:"Brujon",target:"Claquesous",value:1},{source:"Brujon",target:"Montparnasse",value:1},{source:"Mme.Hucheloup",target:"Bossuet",value:1},{source:"Mme.Hucheloup",target:"Joly",value:1},{source:"Mme.Hucheloup",target:"Grantaire",value:1},{source:"Mme.Hucheloup",target:"Bahorel",value:1},{source:"Mme.Hucheloup",target:"Courfeyrac",value:1},{source:"Mme.Hucheloup",target:"Gavroche",value:1},{source:"Mme.Hucheloup",target:"Enjolras",value:1}]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.patents=void 0,e.patents={nodes:[{type:"patent",id:"6516227",name:"Rechargeable spinal cord stimulator system",numCitations:1363,x:-146.50722772206416,y:237.7898848864182},{type:"patent",id:"6535909",name:"System and method for record and playback of collaborative Web browsing session",numCitations:1438,x:301.0880840740178,y:78.3544919158754},{type:"patent",id:"6549908",name:"Methods and apparatus for interpreting user selections in the context of a relation distributed as a set of orthogonalized sub-relations",numCitations:1268,x:-13.814856590741202,y:-183.5501679350274},{type:"patent",id:"6553563",name:"Development tool, method, and system for client server applications",numCitations:1351,x:-.5224312790142777,y:-247.1495779627279},{type:"patent",id:"6558320",name:"Handheld personal data assistant (PDA) with a medical device and method of using the same",numCitations:1514,x:-204.64071894654788,y:71.57055284512312},{type:"patent",id:"6558351",name:"Closed loop system for controlling insulin infusion",numCitations:1369,x:-212.97816000219387,y:14.71564053417009},{type:"patent",id:"6560461",name:"Authorized location reporting paging system",numCitations:1479,x:-250.43543062905093,y:-191.43720062406038},{type:"patent",id:"6563174",name:"Thin film transistor and matrix display device",numCitations:3284,x:-12.588249503652401,y:-3.606638925074952},{type:"patent",id:"6565509",name:"Analyte monitoring device and methods of use",numCitations:1333,x:-105.25511612362045,y:157.11713360602621},{type:"patent",id:"6571282",name:"Block-based communication in a communication services patterns environment",numCitations:1467,x:139.669746748281,y:253.01406501471942},{type:"patent",id:"6574635",name:"Application instantiation based upon attributes and values stored in a meta data repository, including tiering of application layers objects and components",numCitations:1368,x:11.002027627782116,y:-234.9180529832358},{type:"patent",id:"6577726",name:"Computer telephony integration hotelling method and system",numCitations:1270,x:-87.19153245841262,y:-173.97644755929284},{type:"patent",id:"6587835",name:"Shopping assistance with handheld computing device",numCitations:1471,x:-279.2865813378465,y:110.1587912501507},{type:"patent",id:"6601087",name:"Instant document sharing",numCitations:1397,x:210.94821350137184,y:92.53188786911404},{type:"patent",id:"6602252",name:"Combined dissecting, cauterizing, and stapling device",numCitations:1503,x:147.94977165043258,y:170.08888855631307},{type:"patent",id:"6604117",name:"Method of maintaining a network of partially replicated database system",numCitations:1261,x:-.888555802742035,y:-218.23048820307227},{type:"patent",id:"6604128",name:"Method and system for distributing objects over a network",numCitations:1261,x:-56.73872742120841,y:-243.3483841066443},{type:"patent",id:"6606744",name:"Providing collaborative installation management in a network-based supply chain environment",numCitations:1271,x:153.9948251850397,y:231.46579888120272},{type:"patent",id:"6609150",name:"Web client-server system and method for incompatible page markup and presentation languages",numCitations:1336,x:13.182867607321255,y:-184.8342643188157},{type:"patent",id:"6621834",name:"System and method for voice transmission over network protocols",numCitations:1265,x:85.08228149344369,y:105.43464571232896},{type:"patent",id:"6641533",name:"Handheld personal data assistant (PDA) with a medical device and method of using the same",numCitations:1431,x:-218.09766118001224,y:39.85760035797989},{type:"patent",id:"6644532",name:"Surgical stapling apparatus",numCitations:1267,x:304.6630925316294,y:-29.709611573491397},{type:"patent",id:"6654032",name:"Instant sharing of documents on a remote server",numCitations:1413,x:159.30050355296015,y:108.98389585627005},{type:"patent",id:"6656193",name:"Device for attachment of buttress material to a surgical fastening device",numCitations:1279,x:116.90914153158597,y:-78.76626936858557},{type:"patent",id:"6665648",name:"State models for monitoring process",numCitations:1288,x:-19.75185273935374,y:-126.65338912269928},{type:"patent",id:"6665655",name:"Implicit rating of retrieved information in an information search system",numCitations:1294,x:-205.5103612199467,y:-62.615175772923976},{type:"patent",id:"6684438",name:"Method of using cache to determine the visibility to a remote database client of a plurality of database transactions",numCitations:1265,x:-70.89621190805329,y:-211.65898126469475},{type:"patent",id:"6690387",name:"Touch-screen image scrolling system and method",numCitations:1361,x:-96.0833335861014,y:257.188666044209},{type:"patent",id:"6693232",name:"Inbred corn line LH295",numCitations:1585,x:225.21362396634333,y:-181.7023120873901},{type:"patent",id:"6698643",name:"Expanding parallel jaw device for use with an electromechanical driver device",numCitations:1355,x:116.93380088200308,y:220.21419705439607},{type:"patent",id:"6711565",name:"Method, apparatus, and system for previewing search results",numCitations:1388,x:-37.50448129076735,y:-273.41169584791356},{type:"patent",id:"6716233",name:"Electromechanical driver and remote surgical instrument attachment having computer assisted control capabilities",numCitations:1244,x:99.98744927740107,y:212.59527229962606},{type:"patent",id:"6718361",name:"Method and apparatus for reliable and scalable distribution of data files in distributed networks",numCitations:1349,x:-214.4706454200155,y:179.76445383311545},{type:"patent",id:"6724399",name:"Methods and apparatus for enabling keyboard accelerators in applications implemented via a browser",numCitations:1271,x:-3.865437098036597,y:-168.04665075977616},{type:"patent",id:"6727522",name:"Transistor and semiconductor device",numCitations:3301,x:45.493009086533476,y:-18.399336761865555},{type:"patent",id:"6728702",name:"System and method to implement an integrated search center supporting a full-text search and query on a database",numCitations:1290,x:-50.77651269647964,y:-265.6439416642619},{type:"patent",id:"6728960",name:"Techniques for managing multiple threads in a browser environment",numCitations:1287,x:-31.86098260027274,y:-177.09627925166075},{type:"patent",id:"6732095",name:"Method and apparatus for mapping between XML and relational representations",numCitations:1318,x:-45.17430826877544,y:-152.23938355298804},{type:"patent",id:"6732100",name:"Database access method and system for user role defined access",numCitations:1347,x:-59.210136806292674,y:-174.83877990849572},{type:"patent",id:"6732111",name:"Method, apparatus, system, and program product for attaching files and other objects to a partially replicated database",numCitations:1294,x:-90.7397050479451,y:-244.71990328774314},{type:"patent",id:"6754681",name:"Partially replicated distributed database with multiple levels of remote clients",numCitations:1269,x:-79.58083870312655,y:-228.1724054173842},{type:"patent",id:"6763351",name:"Method, apparatus, and system for attaching search results",numCitations:1487,x:-25.243474733492743,y:-263.25740794021067},{type:"patent",id:"6763501",name:"Remote document serving",numCitations:1319,x:158.3253837620942,y:93.49546231516919},{type:"patent",id:"6768904",name:"Data communication method using mobile terminal",numCitations:1256,x:-307.97606158133414,y:18.769756679797396},{type:"patent",id:"6782383",name:"System and method to implement a persistent and dismissible search center frame",numCitations:1282,x:-12.976177557835852,y:-272.9194404073791},{type:"patent",id:"6783524",name:"Robotic surgical tool with ultrasound cauterizing and cutting instrument",numCitations:1505,x:43.38231098694066,y:279.08217801147714},{type:"patent",id:"6786382",name:"Surgical stapling instrument incorporating an articulation joint for a firing bar track",numCitations:1371,x:134.94078164502835,y:-65.10082373566381},{type:"patent",id:"6804330",name:"Method and system for accessing CRM data via voice",numCitations:1348,x:41.445251723842865,y:-236.9915648109865},{type:"patent",id:"6809653",name:"Telemetered characteristic monitor system and method of using the same",numCitations:1250,x:-192.3665947756808,y:85.20039713859154},{type:"patent",id:"6826565",name:"Method and apparatus for serving files to browsing clients",numCitations:1253,x:-187.202078612142,y:-205.8028067140975},{type:"patent",id:"6826582",name:"Method and system for using file systems for content management",numCitations:1262,x:-173.39071713434592,y:-84.74810645391052},{type:"patent",id:"6826745",name:"System and method for smart scripting call centers and configuration thereof",numCitations:1290,x:-76.78126433121005,y:-189.22148175125054},{type:"patent",id:"6829655",name:"Method and system for server synchronization with a computing device via a companion device",numCitations:1292,x:54.15067210701869,y:-193.55954311545358},{type:"patent",id:"6830174",name:"Medical instrument",numCitations:1345,x:241.6836563040002,y:178.8101554942473},{type:"patent",id:"6842748",name:"Usage based strength between related information in an information retrieval system",numCitations:1273,x:-255.7671401763918,y:-89.30941490160309},{type:"patent",id:"6843403",name:"Surgical clamping, cutting and stapling device",numCitations:1278,x:80.62267888317515,y:204.67249292957572},{type:"patent",id:"6850252",name:"Intelligent electronic appliance system and method",numCitations:1784,x:-269.0939625716982,y:80.79152540917103},{type:"patent",id:"6850895",name:"Assignment manager",numCitations:1429,x:-104.71523172899978,y:-237.67489051495383},{type:"patent",id:"6850949",name:"System and method for generating a dynamic interface via a communications network",numCitations:1276,x:170.8948478666423,y:-157.1623996387279},{type:"patent",id:"6852915",name:"Inbred corn line LH283BtMON810",numCitations:1584,x:214.2878252666797,y:-221.65064590625735},{type:"patent",id:"6905057",name:"Surgical stapling instrument incorporating a firing mechanism having a linked rack transmission",numCitations:1398,x:204.244314091743,y:-78.10023672232607},{type:"patent",id:"6959852",name:"Surgical stapling instrument with multistroke firing incorporating an anti-backup mechanism",numCitations:1279,x:214.47741140236582,y:-56.291587636591125},{type:"patent",id:"6964363",name:"Surgical stapling instrument having articulation joint support plates for supporting a firing bar",numCitations:1330,x:171.89247270898028,y:-97.41002462550293},{type:"patent",id:"6978921",name:"Surgical stapling instrument incorporating an E-beam firing mechanism",numCitations:1271,x:220.9998003804044,y:-71.42078135636545},{type:"patent",id:"6981628",name:"Surgical instrument with a lateral-moving articulation control",numCitations:1588,x:155.12209667738722,y:-93.69628751460294},{type:"patent",id:"7000818",name:"Surgical stapling instrument having separate distinct closing and firing systems",numCitations:1422,x:227.01768845379692,y:7.024056611463051},{type:"patent",id:"7025743",name:"External infusion device with remote programming, bolus estimator and/or vibration alarm capabilities",numCitations:1348,x:-139.33487275744275,y:46.52061115334398},{type:"patent",id:"7049190",name:"Method for forming ZnO film, method for forming ZnO semiconductor layer, method for fabricating semiconductor device, and semiconductor device",numCitations:3234,x:-289.10918833611,y:-97.96776938549537},{type:"patent",id:"7055731",name:"Surgical stapling instrument incorporating a tapered firing bar for increased flexibility around the articulation joint",numCitations:1325,x:230.49518386439988,y:-59.64224567858248},{type:"patent",id:"7061014",name:"Natural-superlattice homologous single crystal thin film, method for preparation thereof, and device using said single crystal thin film",numCitations:3339,x:-5.800882044901439,y:68.52641595031525},{type:"patent",id:"7064346",name:"Transistor and semiconductor device",numCitations:3268,x:-3.4003031519913716,y:25.981356836043688},{type:"patent",id:"7105868",name:"High-electron mobility transistor with zinc oxide",numCitations:3233,x:-17.835785749785817,y:199.91883720210305},{type:"patent",id:"7111769",name:"Surgical instrument incorporating an articulation mechanism having rotation about the longitudinal axis",numCitations:1278,x:151.22579832524045,y:-37.17099074749013},{type:"patent",id:"7147138",name:"Surgical stapling instrument having an electroactive polymer actuated buttress deployment mechanism",numCitations:1428,x:189.086143238575,y:-73.69130392683924},{type:"patent",id:"7159750",name:"Surgical stapling device",numCitations:1258,x:-41.29995186519443,y:292.8462674537822},{type:"patent",id:"7211825",name:"Indium oxide-based thin film transistors and circuits",numCitations:3245,x:-312.3839057221477,y:-5.614541567133007},{type:"patent",id:"7246734",name:"Rotary hydraulic pump actuated multi-stroke surgical instrument",numCitations:1288,x:200.44563380086515,y:-63.18865588076886},{type:"patent",id:"7282782",name:"Combined binary oxide semiconductor device",numCitations:3273,x:-125.8309041477986,y:-31.277877893580488},{type:"patent",id:"7297977",name:"Semiconductor device",numCitations:3318,x:-128.28288629696726,y:-55.26147557803329},{type:"patent",id:"7323356",name:"LnCuO(S,Se,Te)monocrystalline thin film, its manufacturing method, and optical device or electronic device using the monocrystalline thin film",numCitations:3251,x:-18.59755305395574,y:88.95531610838968},{type:"patent",id:"7340411",name:"System and method for generating, capturing, and managing customer lead information over a computer network",numCitations:1282,x:171.1408315591698,y:-202.24883708044808},{type:"patent",id:"7380695",name:"Surgical stapling instrument having a single lockout mechanism for prevention of firing",numCitations:1386,x:186.25833530110194,y:-21.66321873245209},{type:"patent",id:"7380696",name:"Articulating surgical stapling instrument incorporating a two-piece E-beam firing mechanism",numCitations:1388,x:207.9029593903179,y:-8.531533737621885},{type:"patent",id:"7385224",name:"Thin film transistor having an etching protection film and manufacturing method thereof",numCitations:3224,x:-209.82230482555335,y:-138.5100409900293},{type:"patent",id:"7402506",name:"Methods of making thin film transistors comprising zinc-oxide-based semiconductor materials and transistors made thereby",numCitations:3258,x:205.02475667447774,y:185.67878066443038},{type:"patent",id:"7404508",name:"Surgical stapling and cutting device",numCitations:1517,x:142.8534886173237,y:1.3325885281748553},{type:"patent",id:"7411209",name:"Field-effect transistor and method for manufacturing the same",numCitations:3255,x:98.46207221183528,y:123.03084775370279},{type:"patent",id:"7453065",name:"Sensor and image pickup device",numCitations:3230,x:-.16573743942671854,y:141.28922935299022},{type:"patent",id:"7453087",name:"Thin-film transistor and thin-film diode having amorphous-oxide semiconductor layer",numCitations:3242,x:64.92619908272222,y:181.84593665090443},{type:"patent",id:"7462862",name:"Transistor using an isovalent semiconductor oxide as the active channel layer",numCitations:3244,x:-69.61679142848251,y:-17.951431766711924},{type:"patent",id:"7464846",name:"Surgical instrument having a removable battery",numCitations:1287,x:181.84194955991686,y:-6.130356644541759},{type:"patent",id:"7468304",name:"Method of fabricating oxide semiconductor device",numCitations:3240,x:43.14447422876499,y:84.30857449883901},{type:"patent",id:"7501293",name:"Semiconductor device in which zinc oxide is used as a semiconductor material and method for manufacturing the semiconductor device",numCitations:3216,x:100.75984495619763,y:263.93928117765387},{type:"patent",id:"7506791",name:"Surgical stapling instrument with mechanical mechanism for limiting maximum tissue compression",numCitations:1257,x:162.8994374938383,y:-13.50766436461125},{type:"patent",id:"7620655",name:"Method, device and computer program product for identifying visitors of websites",numCitations:1243,x:273.7453257058471,y:-134.11969716806783},{type:"patent",id:"7632985",name:"Soybean event MON89788 and methods for detection thereof",numCitations:1477,x:25.156412731130995,y:232.6383745363165},{type:"patent",id:"7663607",name:"Multipoint touchscreen",numCitations:2217,x:148.31729075714412,y:-252.1205411729562},{type:"patent",id:"7674650",name:"Semiconductor device and manufacturing method thereof",numCitations:3439,x:265.20775273511885,y:97.08753175649879},{type:"patent",id:"7732819",name:"Semiconductor device and manufacturing method thereof",numCitations:3288,x:241.27432475696145,y:92.57917159661595},{type:"patent",id:"8053184",name:"Soybean event MON89788 and methods for detection thereof",numCitations:1249,x:12.74173927451986,y:223.33050946853854},{type:"inventor",id:"4082602-2",name:"Adam Heller",numPatents:278,x:-78.97918367878395,y:175.83458551945697},{type:"inventor",id:"6551276-11",name:"Adrian Gut",numPatents:14,x:-126.49163896882082,y:77.05392542894437},{type:"inventor",id:"6551276-3",name:"Alan Haubach",numPatents:15,x:-133.54480618517556,y:13.73644337954243},{type:"inventor",id:"6732095-1",name:"Alex Warshavsky",numPatents:38,x:-41.43006091014681,y:-115.69468137064817},{type:"inventor",id:"4082097-1",name:"Alfred E. Mann",numPatents:73,x:-166.25127823417688,y:64.21424556623339},{type:"inventor",id:"7402506-2",name:"Andrea C. Scuderi",numPatents:2,x:232.021013564944,y:201.54360553214553},{type:"inventor",id:"6295530-1",name:"Andrew M. Ritchie",numPatents:3,x:-180.13270109380883,y:-175.89335875039285},{type:"inventor",id:"5944791-1",name:"Andrew W. Scherpbier",numPatents:8,x:89.03596788702271,y:73.41966601562058},{type:"inventor",id:"6665648-4",name:"Andrzej P. Mazur",numPatents:1,x:-17.75957738133269,y:-90.04327884141138},{type:"inventor",id:"6577726-4",name:"Anil K. Annadata",numPatents:19,x:-90.27237726758581,y:-142.1198155312784},{type:"inventor",id:"6336137-3",name:"Anil Mukundan",numPatents:24,x:44.97570003882059,y:-173.1912630521635},{type:"inventor",id:"6829655-3",name:"Anupam Singhal",numPatents:12,x:68.03341497080808,y:-159.6164090183031},{type:"inventor",id:"5276262-2",name:"Arthur L. Johnson",numPatents:9,x:185.5095664352228,y:-228.8419915898405},{type:"inventor",id:"7082832-4",name:"Ayanori Endo",numPatents:5,x:116.09261573010951,y:149.17176081875573},{type:"inventor",id:"6370584-1",name:"Azer Bestavros",numPatents:8,x:-240.41292415194087,y:197.40201072984638},{type:"inventor",id:"5722997-2",name:"Behrad Aria",numPatents:75,x:-76.88639579899268,y:140.59743480285144},{type:"inventor",id:"4972224-1",name:"Bennie Thompson",numPatents:46,x:129.80735052389812,y:-4.481972559839983},{type:"inventor",id:"7620655-2",name:"Björn Sperling",numPatents:1,x:265.69802466021343,y:-163.1748759268247},{type:"inventor",id:"6551276-12",name:"Bob Murtfeldt",numPatents:14,x:-104.57602641605023,y:43.21929386017491},{type:"inventor",id:"6809653-9",name:"Brad T. Hite",numPatents:4,x:-178.740694429597,y:114.56430107100311},{type:"inventor",id:"6665648-5",name:"Brian Groves",numPatents:3,x:-4.063703727593559,y:-93.24666021615177},{type:"inventor",id:"7000818-3",name:"Brian J. Hemmelgarn",numPatents:2,x:251.87825271692208,y:28.28980319526008},{type:"inventor",id:"6658577-1",name:"Brian Q. Huppi",numPatents:94,x:123.19631987835258,y:-269.5549552777111},{type:"inventor",id:"5465895-1",name:"Bryan D. Knodel",numPatents:147,x:249.27159352509696,y:149.8942269653444},{type:"inventor",id:"5948006-1",name:"Carla M. Mann",numPatents:30,x:-148.41153476987805,y:268.2102368533701},{type:"inventor",id:"6558351-8",name:"Cary D. Talbot",numPatents:51,x:-242.1201373960085,y:1.0809105861722483},{type:"inventor",id:"5176644-1",name:"Chad Srisathapat",numPatents:28,x:-106.59780325645289,y:56.72415996247363},{type:"inventor",id:"6732095-2",name:"Chandrakant Ramkrishna Bhavsar",numPatents:7,x:-56.44692423602858,y:-114.38936355952521},{type:"inventor",id:"6804330-5",name:"Chris Haven",numPatents:8,x:76.58996926607027,y:-233.59376421774968},{type:"inventor",id:"5859916-3",name:"Christopher A. Julian",numPatents:35,x:32.49529202915526,y:307.85587157329917},{type:"inventor",id:"5963953-3",name:"Christopher Stauber",numPatents:3,x:38.876499177308936,y:-254.6853371485407},{type:"inventor",id:"6593834-2",name:"Chunong Qiu",numPatents:30,x:-299.51357073275767,y:28.693586133179505},{type:"inventor",id:"5703357-3",name:"Cindy Xing Qiu",numPatents:37,x:-307.60494602088494,y:-36.09974297692554},{type:"inventor",id:"5382232-1",name:"Cliff Hague",numPatents:25,x:-158.94889170792217,y:75.57366125967091},{type:"inventor",id:"6535909-1",name:"David Bradley Rust",numPatents:10,x:293.89378266881215,y:108.24045592690449},{type:"inventor",id:"5713911-1",name:"David C. Racenet",numPatents:117,x:-70.73199996729076,y:283.6884502132661},{type:"inventor",id:"5512426-1",name:"David H. Levy",numPatents:97,x:175.62273346829593,y:195.03348092042785},{type:"inventor",id:"5755737-3",name:"David Karl Lee Peterson",numPatents:10,x:-116.19997593920681,y:235.42317467768706},{type:"inventor",id:"6004276-13",name:"David L. Rabbers",numPatents:9,x:90.05455138839467,y:-199.76724302660992},{type:"inventor",id:"4127227-1",name:"David T. Green",numPatents:253,x:320.0538956493474,y:-2.5674406983783777},{type:"inventor",id:"5329655-1",name:"Dean L. Garner",numPatents:9,x:82.9868378665844,y:-75.01472155002138},{type:"inventor",id:"6551276-9",name:"Deborah Ruppert",numPatents:22,x:-118.26552937451507,y:20.131481189101695},{type:"inventor",id:"6551276-10",name:"Dennis P. Bishop",numPatents:16,x:-113.04138432659943,y:68.5347918156229},{type:"inventor",id:"5918159-2",name:"Denzil Willoughby Chesney",numPatents:8,x:-221.3438163197732,y:-180.31258868435725},{type:"inventor",id:"6912839-2",name:"Derek Dee Deville",numPatents:127,x:124.00562369714609,y:30.303518573213328},{type:"inventor",id:"6718361-8",name:"Domenic J. LaRosa",numPatents:7,x:-185.1634027151588,y:191.49880558090896},{type:"inventor",id:"6850949-1",name:"Doug Warner",numPatents:1,x:197.4109586624888,y:-141.51137425901277},{type:"inventor",id:"6530932-2",name:"Douglas B. Hoffman",numPatents:41,x:112.65902202678886,y:-41.95179419340801},{type:"inventor",id:"6434550-1",name:"Douglas K. Warner",numPatents:11,x:-240.213051803147,y:-58.38534522176044},{type:"inventor",id:"6850895-5",name:"Duane Wandless",numPatents:3,x:-141.77120370957505,y:-235.84945888555336},{type:"inventor",id:"7632985-4",name:"Ellen Dickinson",numPatents:5,x:-6.650712953659232,y:243.85922494977996},{type:"inventor",id:"5616532-3",name:"Ephraim Heller",numPatents:125,x:-136.66276931786788,y:148.50833287306844},{type:"inventor",id:"6724399-1",name:"Ernst Katchour",numPatents:2,x:20.460705177816816,y:-138.6316174346047},{type:"inventor",id:"4403687-2",name:"Eugene L. Timperman",numPatents:69,x:167.81405976240322,y:23.653794348670516},{type:"inventor",id:"6905057-2",name:"Frederick E. Shelton, IV",numPatents:1047,x:206.94055601161958,y:-33.63794401922105},{type:"inventor",id:"5041086-4",name:"Fredric C. Colman",numPatents:119,x:-93.07141522233565,y:187.61382791214774},{type:"inventor",id:"6433921-2",name:"G. Victor Treyz",numPatents:19,x:-250.2141922087249,y:117.70936188128789},{type:"inventor",id:"6558351-1",name:"Garry M. Steil",numPatents:21,x:-197.55033843707088,y:-14.969054157255261},{type:"inventor",id:"5707369-2",name:"Geoffrey C. Hueil",numPatents:37,x:88.77732129975968,y:-59.34294469090431},{type:"inventor",id:"6826582-2",name:"George Ericsson",numPatents:1,x:-158.02070855249937,y:-111.41355666075413},{type:"inventor",id:"RE28932-2",name:"Graham W. Bryan",numPatents:17,x:302.15197174981995,y:2.971153301217186},{type:"inventor",id:"6144679-1",name:"Gregory S Herman",numPatents:70,x:-107.08721212438253,y:-22.999325980475344},{type:"inventor",id:"6601087-2",name:"Guanghong Yang",numPatents:8,x:181.9400868080221,y:77.6677862338119},{type:"inventor",id:"6577726-3",name:"Henry D. Jay",numPatents:7,x:-122.02320476982499,y:-157.95566732418285},{type:"inventor",id:"4283024-1",name:"Henry R. Sienkiewicz",numPatents:35,x:274.60415603712727,y:-27.27330962584567},{type:"inventor",id:"7323356-5",name:"Hidenori Hiramatsu",numPatents:4,x:-36.605424251950446,y:115.850089319988},{type:"inventor",id:"4703019-2",name:"Hideo Hosono",numPatents:68,x:-9.859457094237333,y:112.18374696348913},{type:"inventor",id:"4253061-3",name:"Hideo Ohno",numPatents:55,x:16.424397835913993,y:1.5981290321141162},{type:"inventor",id:"5272069-6",name:"Hiromichi Ota",numPatents:19,x:-42.930231233299565,y:72.03081578296118},{type:"inventor",id:"5041200-1",name:"Hiromitsu Ishii",numPatents:40,x:-240.4509629339296,y:-150.27601265988352},{type:"inventor",id:"6863363-1",name:"Hisato Yabuta",numPatents:40,x:60.4372147665455,y:56.49664921881387},{type:"inventor",id:"7385224-2",name:"Hitoshi Hokari",numPatents:3,x:-241.8310333799511,y:-133.54049779295428},{type:"inventor",id:"5041200-4",name:"Ikuhiro Yamaguchi",numPatents:10,x:-228.78086701719153,y:-162.3667158856017},{type:"inventor",id:"4997262-1",name:"Ikuo Sakono",numPatents:9,x:-22.451556652393943,y:-34.04750168418211},{type:"inventor",id:"5081422-1",name:"Ishiang Shih",numPatents:28,x:-286.3270775940396,y:-23.733105119458497},{type:"inventor",id:"6281898-2",name:"Jacquelyn A. Martino",numPatents:43,x:-77.40426674630258,y:233.14366209397406},{type:"inventor",id:"6665648-3",name:"Jai-Jein Yu",numPatents:3,x:-31.84005286492673,y:-91.62375747364119},{type:"inventor",id:"4809697-1",name:"James D. Causey, III",numPatents:108,x:-178.265216120422,y:51.755680930746685},{type:"inventor",id:"4863425-2",name:"James L. Henke",numPatents:25,x:-229.82632326693144,y:81.1483918350451},{type:"inventor",id:"5533238-1",name:"James Say",numPatents:115,x:-110.26514650550313,y:189.73841907261374},{type:"inventor",id:"6711565-2",name:"Jason Zoss",numPatents:14,x:-36.79763583041338,y:-303.3606293140057},{type:"inventor",id:"6551276-8",name:"Jay Yonemoto",numPatents:26,x:-108.39060115065696,y:30.667530964984817},{type:"inventor",id:"5863326-1",name:"Jeffrey E. Nause",numPatents:7,x:-34.97468782651399,y:225.53781276672427},{type:"inventor",id:"4951278-2",name:"Jeffrey I. Cohen",numPatents:45,x:-106.67729256003422,y:-275.96655765182123},{type:"inventor",id:"6393605-1",name:"Jeffrey Loomans",numPatents:4,x:-12.089523280862164,y:-146.87295689250564},{type:"inventor",id:"5243622-2",name:"Jeffrey M. Fischer",numPatents:23,x:-69.11510576403663,y:-121.59596238278911},{type:"inventor",id:"5897563-4",name:"Jeffrey S. Swayze",numPatents:237,x:182.7575218770712,y:-42.652264875397925},{type:"inventor",id:"7608761-4",name:"Jennifer Rinehart",numPatents:9,x:14.603033717644877,y:258.01693807943076},{type:"inventor",id:"7380696-3",name:"Jerry R. Morgan",numPatents:1,x:240.77923512539172,y:.756185655222625},{type:"inventor",id:"5715450-1",name:"Jesse Ambrose",numPatents:19,x:36.180423514508206,y:-271.11815189166657},{type:"inventor",id:"6711565-3",name:"Jian-Jung Ying",numPatents:15,x:-52.40594362916027,y:-298.6209852446577},{type:"inventor",id:"6516227-4",name:"Joey Chen",numPatents:50,x:-154.54667136290993,y:208.95072280734337},{type:"inventor",id:"6233617-2",name:"John Coker",numPatents:29,x:-107.81893815632144,y:-170.9074676231656},{type:"inventor",id:"4561444-1",name:"John H. Livingston",numPatents:31,x:-152.85300444583956,y:85.10940008964967},{type:"inventor",id:"5237178-2",name:"John J. Mastrototaro",numPatents:77,x:-205.49739590958532,y:50.31477970484868},{type:"inventor",id:"6424847-3",name:"John J. Shin",numPatents:6,x:-185.37446355710384,y:-3.2872027106235895},{type:"inventor",id:"5713911-2",name:"John W. Beardsley",numPatents:110,x:-33.81475988638202,y:262.88267211113725},{type:"inventor",id:"6690387-1",name:"John Zimmerman",numPatents:16,x:-103.86436428501,y:287.0324152077035},{type:"inventor",id:"6295530-2",name:"Jonathan Bradshaw",numPatents:7,x:-211.8714260910478,y:-224.50904787445123},{type:"inventor",id:"6964363-2",name:"Joseph Charles Heuil",numPatents:1,x:157.89490960975428,y:-126.44781831975064},{type:"inventor",id:"6804330-4",name:"Joseph Harb",numPatents:16,x:61.12664822458566,y:-268.1908816611899},{type:"inventor",id:"7154477-2",name:"Joshua A. Strickon",numPatents:31,x:143.607727645999,y:-281.669369261142},{type:"inventor",id:"6665648-1",name:"Karen Brodersen",numPatents:2,x:-52.887761617406746,y:-135.25324601212748},{type:"inventor",id:"6914182-1",name:"Katsutoshi Takeda",numPatents:12,x:-301.89433487691184,y:-70.43324650808906},{type:"inventor",id:"5925224-1",name:"Kazuki Kobayashi",numPatents:22,x:-41.900676918096416,y:7.301358596622912},{type:"inventor",id:"7061014-4",name:"Kazushige Ueda",numPatents:8,x:-37.66496363448323,y:59.62475565738286},{type:"inventor",id:"4356455-3",name:"Keishi Saito",numPatents:60,x:10.219140633910085,y:114.60611008460567},{type:"inventor",id:"6175752-9",name:"Keith A. Friedman",numPatents:56,x:-72.76478399432692,y:157.96280246014734},{type:"inventor",id:"D263987-1",name:"Keith L. Milliman",numPatents:148,x:285.27055146309806,y:-4.161607699952845},{type:"inventor",id:"D304234-2",name:"Keith Ratcliff",numPatents:76,x:298.25438655644587,y:-62.037733990730615},{type:"inventor",id:"6838397-3",name:"Kengo Akimoto",numPatents:301,x:233.30591089284124,y:118.12865814744283},{type:"inventor",id:"4072236-1",name:"Kenji Nomura",numPatents:72,x:-18.491573620748454,y:164.3319743882085},{type:"inventor",id:"4890611-3",name:"Kenneth H. Mollenauer",numPatents:139,x:171.12139099125284,y:149.8278932183207},{type:"inventor",id:"5409498-4",name:"Kenneth S. Wales",numPatents:34,x:151.61506500486365,y:-68.1715301096975},{type:"inventor",id:"6558351-2",name:"Kerstin Rebrin",numPatents:8,x:-213.99832648219893,y:-18.21020350970695},{type:"inventor",id:"7083075-3",name:"Kevin R. Doll",numPatents:33,x:195.17161861296412,y:21.82757190718286},{type:"inventor",id:"6826745-3",name:"Kevin R. Nix",numPatents:5,x:-113.52318349679786,y:-186.65850464097767},{type:"inventor",id:"4682596-2",name:"Kevin W. Smith",numPatents:245,x:142.01517052619224,y:35.31713032040018},{type:"inventor",id:"6336137-1",name:"King-Hwa Lee",numPatents:7,x:29.136416821389545,y:-152.83892279100135},{type:"inventor",id:"6553563-3",name:"Klaus W. Strobel",numPatents:3,x:18.502269802896187,y:-277.84229119164485},{type:"inventor",id:"5715675-2",name:"Korey Kline",numPatents:67,x:107.3928086404656,y:.12497168391208881},{type:"inventor",id:"6718361-2",name:"Krishna Mangiapudi",numPatents:2,x:-221.42351181095376,y:210.68462107621696},{type:"inventor",id:"6577726-1",name:"Kuang-Yang Huang",numPatents:7,x:-110.90293474419634,y:-144.1107477274019},{type:"inventor",id:"7159750-5",name:"Lee Ann Olson",numPatents:102,x:-12.291045729816593,y:284.322824027671},{type:"inventor",id:"6718361-4",name:"Leroy R. Karge",numPatents:6,x:-246.56898495901828,y:176.8643082489128},{type:"inventor",id:"6551276-4",name:"Luis J. Malave",numPatents:25,x:-150.46955158412106,y:15.466681355594043},{type:"inventor",id:"6048110-3",name:"Lyn M. Irving",numPatents:50,x:185.89368255203638,y:211.73497316837444},{type:"inventor",id:"6718361-3",name:"Lynne M. Murach",numPatents:6,x:-184.59731612599379,y:168.95459030128404},{type:"inventor",id:"5948789-1",name:"Magnus Larsson",numPatents:32,x:282.3498743492304,y:-105.85390576839409},{type:"inventor",id:"6829655-2",name:"Magnus Vejlstrup",numPatents:5,x:84.57683420505849,y:-211.60546591129122},{type:"inventor",id:"6711565-4",name:"Marc Caltabiano",numPatents:18,x:-21.572503547031765,y:-303.25001204800884},{type:"inventor",id:"7078503-3",name:"Marianne Malven",numPatents:24,x:39.36478912183982,y:204.50761088237962},{type:"inventor",id:"6223205-2",name:"Mark E. Crovella",numPatents:11,x:-239.130673392076,y:159.5386268120703},{type:"inventor",id:"6621834-2",name:"Mark Randle Boyns",numPatents:9,x:92.9515991340844,y:139.72491699418129},{type:"inventor",id:"5534132-1",name:"Mark S. Vreeke",numPatents:99,x:-126.17414240825202,y:182.14886801748534},{type:"inventor",id:"4892244-4",name:"Mark S. Zeiner",numPatents:112,x:87.86551233944792,y:-93.61435949906866},{type:"inventor",id:"6829655-6",name:"Martin Susser",numPatents:8,x:86.5166449716311,y:-176.3680568624842},{type:"inventor",id:"4486720-1",name:"Masahiro Hirano",numPatents:64,x:-26.473941021328834,y:50.583877501287475},{type:"inventor",id:"5622653-1",name:"Masahiro Orita",numPatents:13,x:-43.311943512469504,y:88.05852401092362},{type:"inventor",id:"6080998-3",name:"Masao Isomura",numPatents:3,x:-277.1673968733419,y:-69.16313590358769},{type:"inventor",id:"4902671-3",name:"Masashi Kawasaki",numPatents:44,x:25.499834981751505,y:12.458835962907768},{type:"inventor",id:"5117838-1",name:"Matthew A. Palmer",numPatents:213,x:111.84440719512871,y:17.55352243854731},{type:"inventor",id:"6577726-2",name:"Matthew S. Malden",numPatents:15,x:-89.77281715762112,y:-212.5200099480745},{type:"inventor",id:"6665655-2",name:"Michael A. Myer",numPatents:3,x:-222.1548984266278,y:-91.88370779987125},{type:"inventor",id:"5632432-4",name:"Michael E. Setser",numPatents:46,x:236.1453486905915,y:-29.533043437416676},{type:"inventor",id:"5306623-3",name:"Michael F. Tomasco",numPatents:89,x:-136.35034022301926,y:166.87376786095362},{type:"inventor",id:"6606744-1",name:"Michael G. Mikurak",numPatents:14,x:143.06107123828787,y:203.68650030864686},{type:"inventor",id:"6264087-1",name:"Michael P. Whitman",numPatents:134,x:88.31330790988822,y:237.10476528058422},{type:"inventor",id:"6665648-2",name:"Michael Tsunghsi Yu",numPatents:2,x:7.3045597411881005,y:-101.62893346986323},{type:"inventor",id:"6081518-1",name:"Michel K. Bowman-Amuah",numPatents:56,x:153.55805703292674,y:278.7584163590403},{type:"inventor",id:"4224725-1",name:"Michio Kadota",numPatents:173,x:70.25249110067011,y:260.17630684500784},{type:"inventor",id:"6850949-2",name:"Mike Myer",numPatents:1,x:200.98410027290677,y:-165.1800994159187},{type:"inventor",id:"5261037-2",name:"Min Zhu",numPatents:119,x:187.21787990519445,y:119.18052322241124},{type:"inventor",id:"6732100-4",name:"Mingte J. Chen",numPatents:1,x:-74.89396821135054,y:-144.48151011840986},{type:"inventor",id:"5176502-3",name:"Mitchell J. Palmer",numPatents:40,x:315.79092621337537,y:-58.79666939419763},{type:"inventor",id:"7385224-3",name:"Motohiko Yoshida",numPatents:5,x:-231.18768324847443,y:-116.45107756791272},{type:"inventor",id:"5918159-1",name:"Mundi Fomukong",numPatents:12,x:-221.62526815353186,y:-201.75317388265475},{type:"inventor",id:"7632985-3",name:"Nancy Taylor",numPatents:5,x:50.015886492956845,y:227.2759540780497},{type:"inventor",id:"7468304-1",name:"Nobuyuki Kaji",numPatents:16,x:41.822376082161696,y:52.514246752854255},{type:"inventor",id:"7205716-5",name:"Norihito Sone",numPatents:19,x:269.115065567314,y:70.01224836249358},{type:"inventor",id:"5358514-3",name:"Paul M. Meadows",numPatents:70,x:-171.2697553163847,y:256.54794390887173},{type:"inventor",id:"6558351-3",name:"Paul V. Goode",numPatents:154,x:-230.16114196390936,y:-13.410314845001913},{type:"inventor",id:"6711565-1",name:"Pavitra Subramaniam",numPatents:20,x:-6.372748347947338,y:-297.9670264909068},{type:"inventor",id:"D423761-3",name:"Peter Hong",numPatents:25,x:-207.02913444458756,y:113.2044477207746},{type:"inventor",id:"6152987-2",name:"Peter Mardilovich",numPatents:110,x:-113.70541462763414,y:-71.63866878448928},{type:"inventor",id:"5873096-1",name:"Peter S. Lim",numPatents:19,x:-41.4971575994779,y:-229.8634738486308},{type:"inventor",id:"6732111-4",name:"Peter Siam Sy Lim III",numPatents:1,x:-119.68776087181291,y:-264.7441153149242},{type:"inventor",id:"6850895-3",name:"Peter Siam Sy Lim, III",numPatents:3,x:-137.51327861868992,y:-253.05015263416013},{type:"inventor",id:"7159750-4",name:"Philip Roy",numPatents:45,x:-55.915331837334584,y:265.4527399859059},{type:"inventor",id:"6103033-7",name:"Phillip John Plante",numPatents:76,x:-89.56172634273938,y:128.49359954020937},{type:"inventor",id:"5978829-1",name:"Pi-Yu Chung",numPatents:15,x:79.03330309768333,y:-166.89620301402695},{type:"inventor",id:"6092083-2",name:"Prashant Chatterjee",numPatents:12,x:-127.98166248978045,y:-226.09590322983067},{type:"inventor",id:"7340411-1",name:"Rachael L. Cook",numPatents:1,x:145.5816434953685,y:-185.9115227848251},{type:"inventor",id:"4872603-1",name:"Ralph Stearns",numPatents:82,x:-17.638261139740077,y:311.87440096016235},{type:"inventor",id:"6836540-6",name:"Randy Hoffman",numPatents:66,x:-96.67915062271523,y:-18.863267642338357},{type:"inventor",id:"4798594-1",name:"Richard A. Hillstead",numPatents:56,x:220.9404304325887,y:155.9212493217171},{type:"inventor",id:"5097122-2",name:"Richard E. Purvis",numPatents:22,x:-231.6221173485312,y:58.532788593406465},{type:"inventor",id:"6268803-3",name:"Richard Gorman",numPatents:10,x:76.71667439228202,y:-247.40756847543366},{type:"inventor",id:"5271543-1",name:"Richard L. Grant",numPatents:22,x:108.37790261638156,y:-109.53429774011205},{type:"inventor",id:"6092083-1",name:"Robert A. Brodersen",numPatents:21,x:-116.78677329380332,y:-211.74312172754898},{type:"inventor",id:"5873096-2",name:"Robert Broderson",numPatents:3,x:32.470564362710334,y:-212.3565037616904},{type:"inventor",id:"5963953-1",name:"Robert Cram",numPatents:3,x:39.731656228036044,y:-159.70117419662853},{type:"inventor",id:"4362387-1",name:"Roy Clark",numPatents:23,x:-143.38065467805583,y:-83.18646932332894},{type:"inventor",id:"5417770-8",name:"Ryo Hayashi",numPatents:71,x:109.56900270181322,y:94.2690776193339},{type:"inventor",id:"6081875-2",name:"Sanjoy Chatterjee",numPatents:2,x:-168.55351719373274,y:-55.00391327710072},{type:"inventor",id:"5416255-1",name:"Scott A. Bergemann",numPatents:106,x:236.9843658437831,y:-154.5385328936314},{type:"inventor",id:"6724399-2",name:"Shankar S. Nathan",numPatents:1,x:8.017651326713803,y:-132.67439205632664},{type:"inventor",id:"6804330-1",name:"Shannon Jones",numPatents:5,x:71.13206981844631,y:-258.49934239941376},{type:"inventor",id:"6887736-4",name:"Shanthi Ganesan",numPatents:4,x:-36.994882107564074,y:176.4435210395316},{type:"inventor",id:"6183589-1",name:"Shin Kim",numPatents:47,x:-287.672664666798,y:45.812611641390674},{type:"inventor",id:"6654032-4",name:"Songxiang Wei",numPatents:7,x:132.3199171044082,y:86.33369201811875},{type:"inventor",id:"6783524-1",name:"Stephen C. Anderson",numPatents:1,x:62.6200720139505,y:302.49618857083027},{type:"inventor",id:"5774357-1",name:"Steven M. Hoffberg",numPatents:106,x:-298.14981578939944,y:88.5680351045039},{type:"inventor",id:"5594169-2",name:"Steven P. Hotelling",numPatents:306,x:178.31356224420756,y:-255.43042507480578},{type:"inventor",id:"6526335-2",name:"Susan M. Treyz",numPatents:15,x:-279.2338471304183,y:139.99257336727945},{type:"inventor",id:"6639246-1",name:"Tatsuya Honda",numPatents:109,x:250.0602077201684,y:66.33401322268637},{type:"inventor",id:"5345639-6",name:"Tatsuya Iwasaki",numPatents:116,x:86.3336134471773,y:157.82593462060743},{type:"inventor",id:"6324568-1",name:"Thanh Diec",numPatents:3,x:-78.03147469125184,y:-272.5886606861718},{type:"inventor",id:"5715450-2",name:"Thomas M. Rothwein",numPatents:13,x:-19.165101013241493,y:-208.1804640840619},{type:"inventor",id:"RE39841-4",name:"Todd Phillip Omaits",numPatents:7,x:129.99306854625007,y:-22.049901615038408},{type:"inventor",id:"6850949-3",name:"Tom Abshire",numPatents:1,x:140.26566902715228,y:-153.3917294843958},{type:"inventor",id:"7061014-6",name:"Toshio Kamiya",numPatents:25,x:9.126271276254377,y:101.82298630556326},{type:"inventor",id:"6718361-1",name:"Vijay R. Basani",numPatents:9,x:-201.38227173205027,y:208.74327049926328},{type:"inventor",id:"6718361-5",name:"Vitaly S. Revsin",numPatents:13,x:-198.70473078024983,y:152.4052211665943},{type:"inventor",id:"6978921-3",name:"William B. Weisenburgh, II",numPatents:152,x:248.24393906293733,y:-90.29342524369324},{type:"inventor",id:"5257971-2",name:"William P. Van Antwerp",numPatents:69,x:-243.520991916779,y:23.417679977911327},{type:"inventor",id:"6829655-1",name:"Xiaofei Huang",numPatents:5,x:89.9887416103856,y:-187.79413998163483},{type:"inventor",id:"5283452-1",name:"Yi-Chi Shih",numPatents:33,x:-323.71359641871163,y:23.908936586494086},{type:"inventor",id:"5901896-1",name:"Yoram Gal",numPatents:76,x:-107.23225510620489,y:124.73541739026112},{type:"inventor",id:"4573472-1",name:"Yoshihiro Ito",numPatents:189,x:118.20250938383892,y:287.9615326434283},{type:"inventor",id:"5855957-1",name:"Zheng Yuan",numPatents:58,x:138.0920695217319,y:124.0644011797693},{type:"assignee",id:"org_Z59aUBGtZ9P5QzdFiKmZ",name:"Ablaise Limited",numPatents:2,x:-190.4821130010742,y:-236.53619698539487},{type:"assignee",id:"org_4zO2Bc08x56XjDq5TeBp",name:"Accenture LLP",numPatents:210,x:172.86602300833957,y:253.70330815416585},{type:"assignee",id:"org_bwq83jbccKqF4jJrPcaR",name:"Advanced Bionics AG",numPatents:633,x:-176.91468472981555,y:233.6338835259619},{type:"assignee",id:"org_IDUbS09ZR0JhJ8jFEptT",name:"Apple Inc.",numPatents:21023,x:151.68246641578867,y:-222.1248748814489},{type:"assignee",id:"org_EhYFPIJEmYQYRoYvsnpy",name:"Canon Kabushiki Kaisha",numPatents:74596,x:49.48223920573296,y:134.09228873115592},{type:"assignee",id:"org_Imeg9W6P1TE6I2QutS4y",name:"Casio Computer Co., Ltd.",numPatents:4521,x:-179.8175934120515,y:-142.71828852921044},{type:"assignee",id:"org_8csMgtgnN0mREZpNP1Ji",name:"Cerebral Vascular Applications, Inc.",numPatents:4,x:268.8004541444387,y:164.52369478315683},{type:"assignee",id:"org_0eTr3XIBjAKpXkC6823r",name:"Cermet, Inc.",numPatents:7,x:-48.40372768955156,y:205.44025883826066},{type:"assignee",id:"org_107WKNPbvDDKrZBlmw8U",name:"Contigo Software, Inc.",numPatents:2,x:299.3174359095953,y:48.03492469800833},{type:"assignee",id:"org_ppElkEtQvFtG6A4754UI",name:"Eastman Kodak Company",numPatents:21539,x:211.37525941352786,y:217.58287786532108},{type:"assignee",id:"org_0jPWM7YqhtXm0lm3fm1Y",name:"EMC Corporation",numPatents:4976,x:-189.70156274838973,y:-110.01559890437628},{type:"assignee",id:"org_Wh2cnOIzKlhzjuqVmOqY",name:"Enecto AB",numPatents:1,x:243.6765412246258,y:-131.2090311866099},{type:"assignee",id:"org_Xu6gXSsltDBZTAhMFBWD",name:"Ethicon Endo-Surger, Inc.",numPatents:3,x:224.71243580316477,y:39.60984252547865},{type:"assignee",id:"org_NfKBB9TWF4As8TSasJ5n",name:"Ethicon Endo-Surgery, Inc.",numPatents:2194,x:171.0743702247664,y:-55.03680709894609},{type:"assignee",id:"org_vS6rcKyc2qN3rFdX0P2K",name:"Hewlett-Packard Development Company, L.P.",numPatents:35118,x:-90.3103968526694,y:-50.0521628929454},{type:"assignee",id:"per_tX2e2yVLgyNgobEpzWKT",name:"Hideo Ohno",numPatents:4,x:-39.53612842704436,y:-20.270273354977252},{type:"assignee",id:"org_MKvbnCcyPudXexUvsSwF",name:"Holden's Foundation Seeds, Inc.",numPatents:83,x:240.0999059851908,y:-206.02637614806125},{type:"assignee",id:"org_fA0azqoBGEzoPoy85Jyv",name:"INTUITIVE SURGICAL OPERATIONS, INC.",numPatents:1202,x:15.378862865447624,y:290.2178222875223},{type:"assignee",id:"org_DttZMvkyvW3fV6oCUMTF",name:"Japan Science and Technology Agency",numPatents:1157,x:13.173450731061086,y:56.48614099577767},{type:"assignee",id:"org_c5vyBzK7iikkU4DjQFHT",name:"Japan Science and Technology Corporation",numPatents:418,x:63.56317058275,y:6.273673519090753},{type:"assignee",id:"org_FvgvGFe8JZ0iYlZ80weF",name:"Koninklijke Philips Electronics N.V.",numPatents:17138,x:-123.24179123790191,y:270.99746548441016},{type:"assignee",id:"org_XcqCjtT8pi8Mk3UjQlDt",name:"LG Electronics Inc.",numPatents:32725,x:-277.3460229984558,y:7.13369822254301},{type:"assignee",id:"per_DIjUTM7lHhDsAz2u8jiO",name:"Masashi Kawasaki",numPatents:3,x:19.895436596662908,y:-10.717178250900918},{type:"assignee",id:"org_GVMlLVbwCDSiqP9Og8Tn",name:"Medtronic MiniMed, Inc.",numPatents:800,x:-183.74023419057417,y:37.687218769839085},{type:"assignee",id:"org_Qw8EsrN0M52nVQUM6vsV",name:"Monsanto Technology LLC",numPatents:8689,x:19.763901488352673,y:196.62236862589774},{type:"assignee",id:"org_j5U5IEa1FIbgtr7iNsQM",name:"Murata Manufacturing Co., Ltd.",numPatents:7342,x:87.64878197108817,y:291.1023195872352},{type:"assignee",id:"org_1p4FWEoItjyKbwTpCJol",name:"Network Appliance, Inc.",numPatents:530,x:-222.2920372118052,y:149.08372155272062},{type:"assignee",id:"org_ATOWHd4GGaoh14zutXq7",name:"Power Medical Interventions, Inc.",numPatents:30,x:108.88110399749706,y:186.8533878262659},{type:"assignee",id:"org_k8V7c5gnmC7SVmup5Vu7",name:"Raindance Communications, Inc.",numPatents:3,x:65.15717694264417,y:83.41943637820401},{type:"assignee",id:"org_242hJegwfQCeP9hsfwpW",name:"Right Now Technologies, Inc.",numPatents:2,x:186.81965281602268,y:-183.4017025145853},{type:"assignee",id:"org_6r9t7ZA6YT031Od4kMPg",name:"Rightnow Technologies, Inc.",numPatents:10,x:-231.73615880122236,y:-74.09916970934252},{type:"assignee",id:"org_2IF97zVymSuraSnUAXmq",name:"Sanyo Electric Co., Ltd.",numPatents:8383,x:-283.9028253608946,y:-127.87253381969171},{type:"assignee",id:"org_plZbLxiysESbaI9pOeym",name:"SEMICONDUCTOR ENERGY LABORATORY CO., LTD.",numPatents:13885,x:256.2283987637905,y:124.46141696066522},{type:"assignee",id:"org_CMWcoCJWPOfisLWrKvyd",name:"Sharp Kabushiki Kaisha",numPatents:22540,x:4.095560406482671,y:-32.13618482579938},{type:"assignee",id:"org_83NNgJrP5lkIN876kNeG",name:"Siebel Systems, Inc.",numPatents:298,x:-33.91994752314842,y:-212.5994288988811},{type:"assignee",id:"org_J8VnAzFqEjWgxq4ev71z",name:"Starion Instruments Corporation",numPatents:20,x:178.98416654116346,y:169.54821211190276},{type:"assignee",id:"org_m2tNPJkA2g1AWOc7uzS1",name:"TheraSense, Inc.",numPatents:53,x:-125.9145998460851,y:132.41739054516117},{type:"assignee",id:"org_JjrM6UmeOY0Q5MmoNiP8",name:"TOKYO INSTITUTE OF TECHNOLOGY",numPatents:395,x:18.61413008116646,y:165.21253699554214},{type:"assignee",id:"org_ewVsCutpRzD9pT07kBoE",name:"Tyco Healtcare Group LP",numPatents:5,x:-67.25430526742107,y:308.6149282041579},{type:"assignee",id:"org_5wNNrJ4zFQ5KQ8OWnzRC",name:"United States Surtical Corporation",numPatents:1,x:282.781009224431,y:-52.981590115087144},{type:"assignee",id:"org_3vI2Z5kC1SaSlbUBoOBT",name:"WebEx Communications, Inc.",numPatents:22,x:187.36763951128714,y:101.20849847080181}],links:[{source:"6516227",target:"5358514-3"},{source:"6516227",target:"5755737-3"},{source:"6516227",target:"5948006-1"},{source:"6516227",target:"6516227-4"},{source:"6516227",target:"org_bwq83jbccKqF4jJrPcaR"},{source:"6535909",target:"6535909-1"},{source:"6535909",target:"org_107WKNPbvDDKrZBlmw8U"},{source:"6549908",target:"6393605-1"},{source:"6549908",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6553563",target:"5715450-1"},{source:"6553563",target:"5715450-2"},{source:"6553563",target:"6553563-3"},{source:"6553563",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6558320",target:"4809697-1"},{source:"6558320",target:"4863425-2"},{source:"6558320",target:"5097122-2"},{source:"6558320",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"6558351",target:"5097122-2"},{source:"6558351",target:"5237178-2"},{source:"6558351",target:"5257971-2"},{source:"6558351",target:"6424847-3"},{source:"6558351",target:"6558351-1"},{source:"6558351",target:"6558351-2"},{source:"6558351",target:"6558351-3"},{source:"6558351",target:"6558351-8"},{source:"6558351",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"6560461",target:"5918159-1"},{source:"6560461",target:"5918159-2"},{source:"6563174",target:"4253061-3"},{source:"6563174",target:"4902671-3"},{source:"6563174",target:"4997262-1"},{source:"6563174",target:"5925224-1"},{source:"6563174",target:"org_CMWcoCJWPOfisLWrKvyd"},{source:"6563174",target:"per_DIjUTM7lHhDsAz2u8jiO"},{source:"6563174",target:"per_tX2e2yVLgyNgobEpzWKT"},{source:"6565509",target:"4082602-2"},{source:"6565509",target:"5041086-4"},{source:"6565509",target:"5306623-3"},{source:"6565509",target:"5533238-1"},{source:"6565509",target:"5534132-1"},{source:"6565509",target:"5616532-3"},{source:"6565509",target:"5722997-2"},{source:"6565509",target:"5901896-1"},{source:"6565509",target:"6103033-7"},{source:"6565509",target:"6175752-9"},{source:"6565509",target:"org_m2tNPJkA2g1AWOc7uzS1"},{source:"6571282",target:"6081518-1"},{source:"6571282",target:"org_4zO2Bc08x56XjDq5TeBp"},{source:"6574635",target:"5715450-1"},{source:"6574635",target:"5715450-2"},{source:"6574635",target:"5963953-3"},{source:"6574635",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6577726",target:"6577726-1"},{source:"6577726",target:"6577726-2"},{source:"6577726",target:"6577726-3"},{source:"6577726",target:"6577726-4"},{source:"6577726",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6587835",target:"6433921-2"},{source:"6587835",target:"6526335-2"},{source:"6601087",target:"5261037-2"},{source:"6601087",target:"6601087-2"},{source:"6601087",target:"org_3vI2Z5kC1SaSlbUBoOBT"},{source:"6602252",target:"4890611-3"},{source:"6602252",target:"org_J8VnAzFqEjWgxq4ev71z"},{source:"6604117",target:"5873096-1"},{source:"6604117",target:"5873096-2"},{source:"6604117",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6604128",target:"6324568-1"},{source:"6604128",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6606744",target:"6606744-1"},{source:"6606744",target:"org_4zO2Bc08x56XjDq5TeBp"},{source:"6609150",target:"5963953-1"},{source:"6609150",target:"6336137-1"},{source:"6609150",target:"6336137-3"},{source:"6609150",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6621834",target:"5944791-1"},{source:"6621834",target:"6621834-2"},{source:"6621834",target:"org_k8V7c5gnmC7SVmup5Vu7"},{source:"6641533",target:"4809697-1"},{source:"6641533",target:"4863425-2"},{source:"6641533",target:"5097122-2"},{source:"6641533",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"6644532",target:"4127227-1"},{source:"6644532",target:"4283024-1"},{source:"6644532",target:"5176502-3"},{source:"6644532",target:"D263987-1"},{source:"6644532",target:"D304234-2"},{source:"6644532",target:"RE28932-2"},{source:"6644532",target:"org_5wNNrJ4zFQ5KQ8OWnzRC"},{source:"6654032",target:"5261037-2"},{source:"6654032",target:"5855957-1"},{source:"6654032",target:"6601087-2"},{source:"6654032",target:"6654032-4"},{source:"6654032",target:"org_3vI2Z5kC1SaSlbUBoOBT"},{source:"6656193",target:"4892244-4"},{source:"6656193",target:"5271543-1"},{source:"6656193",target:"5329655-1"},{source:"6656193",target:"5409498-4"},{source:"6656193",target:"5707369-2"},{source:"6656193",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6665648",target:"6665648-1"},{source:"6665648",target:"6665648-2"},{source:"6665648",target:"6665648-3"},{source:"6665648",target:"6665648-4"},{source:"6665648",target:"6665648-5"},{source:"6665648",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6665655",target:"6434550-1"},{source:"6665655",target:"6665655-2"},{source:"6665655",target:"org_6r9t7ZA6YT031Od4kMPg"},{source:"6684438",target:"5873096-1"},{source:"6684438",target:"6092083-1"},{source:"6684438",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6690387",target:"6281898-2"},{source:"6690387",target:"6690387-1"},{source:"6690387",target:"org_FvgvGFe8JZ0iYlZ80weF"},{source:"6693232",target:"5416255-1"},{source:"6693232",target:"org_MKvbnCcyPudXexUvsSwF"},{source:"6698643",target:"6264087-1"},{source:"6698643",target:"org_ATOWHd4GGaoh14zutXq7"},{source:"6711565",target:"6711565-1"},{source:"6711565",target:"6711565-2"},{source:"6711565",target:"6711565-3"},{source:"6711565",target:"6711565-4"},{source:"6711565",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6716233",target:"6264087-1"},{source:"6716233",target:"org_ATOWHd4GGaoh14zutXq7"},{source:"6718361",target:"6223205-2"},{source:"6718361",target:"6370584-1"},{source:"6718361",target:"6718361-1"},{source:"6718361",target:"6718361-2"},{source:"6718361",target:"6718361-3"},{source:"6718361",target:"6718361-4"},{source:"6718361",target:"6718361-5"},{source:"6718361",target:"6718361-8"},{source:"6718361",target:"org_1p4FWEoItjyKbwTpCJol"},{source:"6724399",target:"6724399-1"},{source:"6724399",target:"6724399-2"},{source:"6724399",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6727522",target:"4253061-3"},{source:"6727522",target:"4902671-3"},{source:"6727522",target:"org_c5vyBzK7iikkU4DjQFHT"},{source:"6728702",target:"6577726-2"},{source:"6728702",target:"6711565-1"},{source:"6728702",target:"6711565-2"},{source:"6728702",target:"6711565-3"},{source:"6728702",target:"6711565-4"},{source:"6728702",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6728960",target:"6393605-1"},{source:"6728960",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6732095",target:"5243622-2"},{source:"6732095",target:"6732095-1"},{source:"6732095",target:"6732095-2"},{source:"6732095",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6732100",target:"5715450-2"},{source:"6732100",target:"6577726-2"},{source:"6732100",target:"6577726-4"},{source:"6732100",target:"6665648-1"},{source:"6732100",target:"6732100-4"},{source:"6732100",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6732111",target:"4951278-2"},{source:"6732111",target:"6092083-1"},{source:"6732111",target:"6092083-2"},{source:"6732111",target:"6732111-4"},{source:"6732111",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6754681",target:"5873096-1"},{source:"6754681",target:"6092083-1"},{source:"6754681",target:"6092083-2"},{source:"6754681",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6763351",target:"6711565-1"},{source:"6763351",target:"6711565-2"},{source:"6763351",target:"6711565-3"},{source:"6763351",target:"6711565-4"},{source:"6763351",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6763501",target:"5261037-2"},{source:"6763501",target:"5855957-1"},{source:"6763501",target:"6601087-2"},{source:"6763501",target:"6654032-4"},{source:"6763501",target:"org_3vI2Z5kC1SaSlbUBoOBT"},{source:"6768904",target:"6183589-1"},{source:"6768904",target:"org_XcqCjtT8pi8Mk3UjQlDt"},{source:"6782383",target:"6711565-1"},{source:"6782383",target:"6711565-2"},{source:"6782383",target:"6711565-3"},{source:"6782383",target:"6711565-4"},{source:"6782383",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6783524",target:"5859916-3"},{source:"6783524",target:"6783524-1"},{source:"6783524",target:"org_fA0azqoBGEzoPoy85Jyv"},{source:"6786382",target:"6530932-2"},{source:"6786382",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6804330",target:"5715450-1"},{source:"6804330",target:"6268803-3"},{source:"6804330",target:"6804330-1"},{source:"6804330",target:"6804330-4"},{source:"6804330",target:"6804330-5"},{source:"6804330",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6809653",target:"4082097-1"},{source:"6809653",target:"4561444-1"},{source:"6809653",target:"4809697-1"},{source:"6809653",target:"4863425-2"},{source:"6809653",target:"5097122-2"},{source:"6809653",target:"5237178-2"},{source:"6809653",target:"5382232-1"},{source:"6809653",target:"6809653-9"},{source:"6809653",target:"D423761-3"},{source:"6809653",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"6826565",target:"6295530-1"},{source:"6826565",target:"6295530-2"},{source:"6826565",target:"org_Z59aUBGtZ9P5QzdFiKmZ"},{source:"6826582",target:"4362387-1"},{source:"6826582",target:"6081875-2"},{source:"6826582",target:"6826582-2"},{source:"6826582",target:"org_0jPWM7YqhtXm0lm3fm1Y"},{source:"6826745",target:"6233617-2"},{source:"6826745",target:"6577726-2"},{source:"6826745",target:"6826745-3"},{source:"6826745",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6829655",target:"5978829-1"},{source:"6829655",target:"6004276-13"},{source:"6829655",target:"6829655-1"},{source:"6829655",target:"6829655-2"},{source:"6829655",target:"6829655-3"},{source:"6829655",target:"6829655-6"},{source:"6829655",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6830174",target:"4798594-1"},{source:"6830174",target:"5465895-1"},{source:"6830174",target:"org_8csMgtgnN0mREZpNP1Ji"},{source:"6842748",target:"6434550-1"},{source:"6842748",target:"6665655-2"},{source:"6842748",target:"org_6r9t7ZA6YT031Od4kMPg"},{source:"6843403",target:"6264087-1"},{source:"6843403",target:"org_ATOWHd4GGaoh14zutXq7"},{source:"6850252",target:"5774357-1"},{source:"6850895",target:"6092083-1"},{source:"6850895",target:"6092083-2"},{source:"6850895",target:"6577726-2"},{source:"6850895",target:"6850895-3"},{source:"6850895",target:"6850895-5"},{source:"6850895",target:"org_83NNgJrP5lkIN876kNeG"},{source:"6850949",target:"6850949-1"},{source:"6850949",target:"6850949-2"},{source:"6850949",target:"6850949-3"},{source:"6850949",target:"org_242hJegwfQCeP9hsfwpW"},{source:"6852915",target:"5276262-2"},{source:"6852915",target:"org_MKvbnCcyPudXexUvsSwF"},{source:"6905057",target:"5897563-4"},{source:"6905057",target:"6905057-2"},{source:"6905057",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6959852",target:"5632432-4"},{source:"6959852",target:"6905057-2"},{source:"6959852",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6964363",target:"5409498-4"},{source:"6964363",target:"6964363-2"},{source:"6964363",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6978921",target:"5632432-4"},{source:"6978921",target:"6905057-2"},{source:"6978921",target:"6978921-3"},{source:"6978921",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"6981628",target:"5409498-4"},{source:"6981628",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7000818",target:"5632432-4"},{source:"7000818",target:"6905057-2"},{source:"7000818",target:"7000818-3"},{source:"7000818",target:"org_Xu6gXSsltDBZTAhMFBWD"},{source:"7025743",target:"4082097-1"},{source:"7025743",target:"4561444-1"},{source:"7025743",target:"4809697-1"},{source:"7025743",target:"5176644-1"},{source:"7025743",target:"5382232-1"},{source:"7025743",target:"6551276-10"},{source:"7025743",target:"6551276-11"},{source:"7025743",target:"6551276-12"},{source:"7025743",target:"6551276-3"},{source:"7025743",target:"6551276-4"},{source:"7025743",target:"6551276-8"},{source:"7025743",target:"6551276-9"},{source:"7025743",target:"org_GVMlLVbwCDSiqP9Og8Tn"},{source:"7049190",target:"6080998-3"},{source:"7049190",target:"6914182-1"},{source:"7049190",target:"org_2IF97zVymSuraSnUAXmq"},{source:"7055731",target:"5632432-4"},{source:"7055731",target:"6905057-2"},{source:"7055731",target:"6978921-3"},{source:"7055731",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7061014",target:"4486720-1"},{source:"7061014",target:"4703019-2"},{source:"7061014",target:"5272069-6"},{source:"7061014",target:"5622653-1"},{source:"7061014",target:"7061014-4"},{source:"7061014",target:"7061014-6"},{source:"7061014",target:"org_DttZMvkyvW3fV6oCUMTF"},{source:"7064346",target:"4253061-3"},{source:"7064346",target:"4902671-3"},{source:"7064346",target:"org_DttZMvkyvW3fV6oCUMTF"},{source:"7105868",target:"5863326-1"},{source:"7105868",target:"6887736-4"},{source:"7105868",target:"org_0eTr3XIBjAKpXkC6823r"},{source:"7111769",target:"5409498-4"},{source:"7111769",target:"5897563-4"},{source:"7111769",target:"6530932-2"},{source:"7111769",target:"6905057-2"},{source:"7111769",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7147138",target:"6905057-2"},{source:"7147138",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7159750",target:"4872603-1"},{source:"7159750",target:"5713911-1"},{source:"7159750",target:"5713911-2"},{source:"7159750",target:"7159750-4"},{source:"7159750",target:"7159750-5"},{source:"7159750",target:"org_ewVsCutpRzD9pT07kBoE"},{source:"7211825",target:"5081422-1"},{source:"7211825",target:"5283452-1"},{source:"7211825",target:"5703357-3"},{source:"7211825",target:"6593834-2"},{source:"7246734",target:"6905057-2"},{source:"7246734",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7282782",target:"6144679-1"},{source:"7282782",target:"6152987-2"},{source:"7282782",target:"6836540-6"},{source:"7282782",target:"org_vS6rcKyc2qN3rFdX0P2K"},{source:"7297977",target:"6144679-1"},{source:"7297977",target:"6152987-2"},{source:"7297977",target:"6836540-6"},{source:"7297977",target:"org_vS6rcKyc2qN3rFdX0P2K"},{source:"7323356",target:"4486720-1"},{source:"7323356",target:"4703019-2"},{source:"7323356",target:"5272069-6"},{source:"7323356",target:"5622653-1"},{source:"7323356",target:"7061014-4"},{source:"7323356",target:"7323356-5"},{source:"7323356",target:"org_DttZMvkyvW3fV6oCUMTF"},{source:"7340411",target:"7340411-1"},{source:"7380695",target:"5409498-4"},{source:"7380695",target:"5632432-4"},{source:"7380695",target:"6905057-2"},{source:"7380695",target:"7083075-3"},{source:"7380695",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7380696",target:"5632432-4"},{source:"7380696",target:"6905057-2"},{source:"7380696",target:"7083075-3"},{source:"7380696",target:"7380696-3"},{source:"7380696",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7385224",target:"5041200-1"},{source:"7385224",target:"5041200-4"},{source:"7385224",target:"7385224-2"},{source:"7385224",target:"7385224-3"},{source:"7385224",target:"org_Imeg9W6P1TE6I2QutS4y"},{source:"7402506",target:"5512426-1"},{source:"7402506",target:"6048110-3"},{source:"7402506",target:"7402506-2"},{source:"7402506",target:"org_ppElkEtQvFtG6A4754UI"},{source:"7404508",target:"4682596-2"},{source:"7404508",target:"5117838-1"},{source:"7404508",target:"5715675-2"},{source:"7404508",target:"6912839-2"},{source:"7404508",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7411209",target:"5345639-6"},{source:"7411209",target:"5417770-8"},{source:"7411209",target:"7082832-4"},{source:"7411209",target:"org_EhYFPIJEmYQYRoYvsnpy"},{source:"7453065",target:"4072236-1"},{source:"7453065",target:"4356455-3"},{source:"7453065",target:"4703019-2"},{source:"7453065",target:"7061014-6"},{source:"7453065",target:"org_EhYFPIJEmYQYRoYvsnpy"},{source:"7453065",target:"org_JjrM6UmeOY0Q5MmoNiP8"},{source:"7453087",target:"5345639-6"},{source:"7453087",target:"org_EhYFPIJEmYQYRoYvsnpy"},{source:"7462862",target:"6144679-1"},{source:"7462862",target:"6836540-6"},{source:"7462862",target:"org_vS6rcKyc2qN3rFdX0P2K"},{source:"7464846",target:"4403687-2"},{source:"7464846",target:"5897563-4"},{source:"7464846",target:"6905057-2"},{source:"7464846",target:"7083075-3"},{source:"7464846",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7468304",target:"6863363-1"},{source:"7468304",target:"7468304-1"},{source:"7468304",target:"org_EhYFPIJEmYQYRoYvsnpy"},{source:"7501293",target:"4224725-1"},{source:"7501293",target:"4573472-1"},{source:"7501293",target:"org_j5U5IEa1FIbgtr7iNsQM"},{source:"7506791",target:"4403687-2"},{source:"7506791",target:"4972224-1"},{source:"7506791",target:"6905057-2"},{source:"7506791",target:"RE39841-4"},{source:"7506791",target:"org_NfKBB9TWF4As8TSasJ5n"},{source:"7620655",target:"5948789-1"},{source:"7620655",target:"7620655-2"},{source:"7620655",target:"org_Wh2cnOIzKlhzjuqVmOqY"},{source:"7632985",target:"7078503-3"},{source:"7632985",target:"7608761-4"},{source:"7632985",target:"7632985-3"},{source:"7632985",target:"7632985-4"},{source:"7632985",target:"org_Qw8EsrN0M52nVQUM6vsV"},{source:"7663607",target:"5594169-2"},{source:"7663607",target:"6658577-1"},{source:"7663607",target:"7154477-2"},{source:"7663607",target:"org_IDUbS09ZR0JhJ8jFEptT"},{source:"7674650",target:"6639246-1"},{source:"7674650",target:"6838397-3"},{source:"7674650",target:"7205716-5"},{source:"7674650",target:"org_plZbLxiysESbaI9pOeym"},{source:"7732819",target:"6639246-1"},{source:"7732819",target:"6838397-3"},{source:"7732819",target:"7205716-5"},{source:"7732819",target:"org_plZbLxiysESbaI9pOeym"},{source:"8053184",target:"7078503-3"},{source:"8053184",target:"7608761-4"},{source:"8053184",target:"7632985-3"},{source:"8053184",target:"7632985-4"},{source:"8053184",target:"org_Qw8EsrN0M52nVQUM6vsV"}]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InteractionManager=void 0;e.InteractionManager=class{constructor(t){this.isZoomListened=!1,this.isMouseListened=!1,this.mouseEventCallbackCount=0,this.isMouseDown=!1,this.isMouseMove=!1,this.netv=t,this.canvas=this.netv.$_container.querySelector("canvas"),this.zoomCallbackSet=new Set,this.panCallbackSet=new Set,this.clickCallbackSet=new Set,this.mousedownCallbackSet=new Set,this.mouseupCallbackSet=new Set}panBy(t,e){const n={...this.netv.$_transform};return n.x+=t,n.y+=e,this.netv.transform(n)}zoomBy(t,e){const n={...this.netv.$_transform};let r=e;r||(r={x:this.netv.$_configs.width/2,y:this.netv.$_configs.height/2});const{x:a,y:o}=r;return n.x=(1-t)*a+t*n.x,n.y=(1-t)*o+t*n.y,n.k*=t,this.netv.transform(n)}centerPosition(t){const e={...this.netv.$_transform},n=t.x*e.k+e.x,r=t.y*e.k+e.y,a=this.netv.$_configs.width/2,o=this.netv.$_configs.height/2;return e.x+=a-n,e.y+=o-r,this.netv.transform(e),e}onZoom(t){this.zoomCallbackSet.add(t),this.isZoomListened||(this.addWheelListeners(),this.isZoomListened=!0)}offZoom(t){this.zoomCallbackSet.delete(t),this.zoomCallbackSet.size||(this.removeWheelListeners(),this.isZoomListened=!1)}onClick(t){this.clickCallbackSet.add(t),this.increaseMouseEventCallbackCountBy(1)}offClick(t){this.clickCallbackSet.delete(t),this.decreaseMouseEventCallbackCountBy(1)}onMousedown(t){this.mousedownCallbackSet.add(t),this.increaseMouseEventCallbackCountBy(1)}offMousedown(t){this.mousedownCallbackSet.delete(t),this.decreaseMouseEventCallbackCountBy(1)}onMouseup(t){this.mouseupCallbackSet.add(t),this.increaseMouseEventCallbackCountBy(1)}offMouseup(t){this.mouseupCallbackSet.delete(t),this.decreaseMouseEventCallbackCountBy(1)}onPan(t){this.panCallbackSet.add(t),this.increaseMouseEventCallbackCountBy(1)}offPan(t){this.panCallbackSet.delete(t),this.decreaseMouseEventCallbackCountBy(1)}increaseMouseEventCallbackCountBy(t){this.mouseEventCallbackCount+=t,!this.isMouseListened&&this.mouseEventCallbackCount>0&&(this.addMouseListeners(),this.isMouseListened=!0)}decreaseMouseEventCallbackCountBy(t){this.mouseEventCallbackCount-=t,this.mouseEventCallbackCount<=0&&!this.panCallbackSet.size&&(this.removeMouseListeners(),this.isMouseListened=!1)}handleZoom(t){const e={...this.netv.$_transform},n=t.offsetX||t.pageX-this.canvas.offsetLeft,r=t.offsetY||t.pageY-this.canvas.offsetTop,a=t.deltaY?t.deltaY/40:t.detail?-t.detail:0;if(a){const o=Math.pow(1.1,a);e.x=(1-o)*n+o*e.x,e.y=(1-o)*r+o*e.y,e.k*=o,this.netv.transform(e),this.netv.draw(),this.zoomCallbackSet.forEach(n=>n({event:t,name:"zoom",transform:e}))}t.preventDefault()}handleMouseDown(t){var e;const n=t.offsetX||t.pageX-this.canvas.offsetLeft,r=t.offsetY||t.pageY-this.canvas.offsetTop,a=this.netv.$_configs.height-r,o={...this.netv.$_transform};if(this.isMouseDown=!0,this.mouseDownPos={x:n,y:r},this.dragStartTransform=JSON.parse(JSON.stringify(o)),this.mouseDownElement=this.netv.getElementByPosition({x:n,y:a}),null===(e=this.mouseDownElement)||void 0===e?void 0:e.element){const e=this.mouseDownElement.element;"Node"===(null==e?void 0:e.type)&&(this.mouseDownElementOriginPos={...e.position()}),e.$_mousedownCallbackSet.forEach(n=>{n({event:t,name:"mousedown",element:e})})}else this.mousedownCallbackSet.forEach(e=>{e({event:t,name:"mousedown"})})}handleMouseMove(t){var e,n;let r={...this.netv.$_transform};const a=t.offsetX||t.pageX-this.canvas.offsetLeft,o=t.offsetY||t.pageY-this.canvas.offsetTop,i=this.isMouseMove,s=this.mouseMoveElement;if(this.isMouseDown){this.isMouseMove=!0;const n=null===(e=this.mouseDownElement)||void 0===e?void 0:e.element;"Node"===(null==n?void 0:n.type)&&n.$_dragstartCallbackSet.size+n.$_draggingCallbackSet.size+n.$_dragendCallbackSet.size?(i||n.$_dragstartCallbackSet.forEach(e=>{e({event:t,name:"dragstart",element:n})}),n.position({x:this.mouseDownElementOriginPos.x+(a-this.mouseDownPos.x)/r.k,y:this.mouseDownElementOriginPos.y+(o-this.mouseDownPos.y)/r.k}),this.netv.draw(),n.$_draggingCallbackSet.forEach(e=>{e({event:t,name:"dragging",element:n})})):(r.x=this.dragStartTransform.x+a-this.mouseDownPos.x,r.y=this.dragStartTransform.y+o-this.mouseDownPos.y,this.panCallbackSet.size&&(this.netv.transform(r),this.netv.draw(),this.panCallbackSet.forEach(e=>e({event:t,name:"pan",transform:r}))))}else{const e=this.netv.$_configs.height-o,r=null===(n=this.netv.getElementByPosition({x:a,y:e}))||void 0===n?void 0:n.element;this.mouseMoveElement=r,s===r?null==r||r.$_mousemoveCallbackSet.forEach(e=>e({event:t,name:"mousemove",element:r})):(null==s||s.$_mouseoutCallbackSet.forEach(e=>e({event:t,name:"mouseout",element:s})),null==r||r.$_mouseoverCallbackSet.forEach(e=>e({event:t,name:"mouseover",element:r})))}}handleMouseUp(t){var e,n;if(this.mouseDownElement){if(this.isMouseMove){if(null===(e=this.mouseDownElement)||void 0===e?void 0:e.element.$_dragendCallbackSet){const e=this.mouseDownElement.element;e.$_dragendCallbackSet.forEach(n=>n({event:t,name:"dragend",element:e}))}}else{const e=this.mouseDownElement.element;e.$_clickCallbackSet.forEach(n=>n({event:t,name:"click",element:e}))}if(null===(n=this.mouseDownElement)||void 0===n?void 0:n.element.$_mouseupCallbackSet){const e=this.mouseDownElement.element;e.$_mouseupCallbackSet.forEach(n=>n({event:t,name:"mouseup",element:e}))}}else this.mouseupCallbackSet.forEach(e=>e({event:t,name:"mouseup"})),this.isMouseMove||this.clickCallbackSet.forEach(e=>e({event:t,name:"click"}));this.isMouseDown=!1,this.isMouseMove=!1,this.mouseDownElement=void 0}addWheelListeners(){this.canvas.addEventListener("DOMMouseScroll",this.handleZoom.bind(this),!1),this.canvas.addEventListener("mousewheel",this.handleZoom.bind(this),!1)}removeWheelListeners(){this.canvas.removeEventListener("DOMMouseScroll",this.handleZoom.bind(this)),this.canvas.removeEventListener("mousewheel",this.handleZoom.bind(this))}addMouseListeners(){const t=this.canvas;t.addEventListener("mousedown",this.handleMouseDown.bind(this)),t.addEventListener("mousemove",this.handleMouseMove.bind(this)),t.addEventListener("mouseup",this.handleMouseUp.bind(this))}removeMouseListeners(){const t=this.canvas;t.removeEventListener("mousedown",this.handleMouseDown.bind(this)),t.removeEventListener("mousemove",this.handleMouseMove.bind(this)),t.removeEventListener("mouseup",this.handleMouseUp.bind(this))}}},function(t,e,n){"use strict";function r(){console.log("js log")}n.r(e),n.d(e,"logJs",(function(){return r}))},function(t,e,n){t.exports=function t(e,n,r){function a(i,s){if(!n[i]){if(!e[i]){if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[i]={exports:{}};e[i][0].call(c.exports,(function(t){var n=e[i][1][t];return a(n||t)}),c,c.exports,t,e,n,r)}return n[i].exports}for(var o=!1,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(t,e,n){"use strict";!function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(t("stardust-core"));var r=t("stardust-webgl");n.WebGLPlatform=r.WebGLPlatform,n.WebGLCanvasPlatform2D=r.WebGLCanvasPlatform2D;var a=t("stardust-isotype");!function(t){t.isotype=a.isotype}(n.mark||(n.mark={})),t("stardust-webgl")},{"stardust-core":27,"stardust-isotype":28,"stardust-webgl":33}],2:[function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./types"),o=function(){};n.TextureBinding=o;var i=function(t){function e(){t.apply(this,arguments),this._data=null,this._valueFunction=null,this._dirty=!1,this._textureData=null}return r(e,t),e.prototype.getTextureData=function(){if(this._dirty){var t=this._data.map(this._valueFunction).map(a.getBindingValue);if(0==t.length)this._textureData=null;else{var e,n=void 0;if("number"==typeof t[0]){n=1,e=new Float32Array(4*t.length);for(var r=0;r<t.length;r++)e[4*r]=t[r]}else{n=t[0].length,e=new Float32Array(4*t.length);var o=0;for(r=0;r<t.length;r++){for(var i=t[r],s=0;s<n;s++)e[o++]=i[s];o+=4-n}}this._textureData={width:this._data.length,height:1,dimensions:1,numberComponents:n,data:e}}}return this._textureData},e.prototype.data=function(t){return null!=t?(this._data=t,this._dirty=!0,this):this._data},e.prototype.value=function(t){return null!=t?(this._valueFunction=t,this._dirty=!0,this):this._valueFunction},e}(o);n.Array=i,n.array=function(){return new i}},{"./types":4}],3:[function(t,e,n){"use strict";function r(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}var a=t("../spec/spec"),o=t("./array"),i=t("../exceptions"),s=t("./types");r(t("./types")),r(t("./array"));var u=function(){function t(t,e){this._type=a.types[t],this._value=e}return Object.defineProperty(t.prototype,"valueType",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindingType",{get:function(){return this._value instanceof o.TextureBinding?s.BindingType.TEXTURE:"function"==typeof this._value?s.BindingType.FUNCTION:s.BindingType.VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"specValue",{get:function(){return s.getBindingValue(this._value)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textureValue",{get:function(){return this._value},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){switch(this.bindingType){case s.BindingType.FUNCTION:for(var n=this._value,r=0;r<t.length;r++)e(s.getBindingValue(n(t[r],r)),r);break;case s.BindingType.VALUE:var a=s.getBindingValue(this._value);for(r=0;r<t.length;r++)e(a,r);break;case s.BindingType.TEXTURE:throw new i.RuntimeError("Texture binding does not support for each")}},t.prototype.map=function(t){switch(this.bindingType){case s.BindingType.FUNCTION:var e=this._value;return t.map((function(t,n){return s.getBindingValue(e(t,n))}));case s.BindingType.VALUE:var n=s.getBindingValue(this._value);return t.map((function(){return n}));case s.BindingType.TEXTURE:throw new i.RuntimeError("Texture binding does not support for map")}},t.prototype.fillBinary=function(t,e,n){var r=t.length,a=this._type.primitiveCount,o=0;switch(this.bindingType){case s.BindingType.FUNCTION:var u=this._value;if(1==a)for(var c=0;c<r;c++)for(var l=s.getBindingValue(u(t[c],c)),p=0;p<e;p++)n[o++]=l;else for(c=0;c<r;c++)for(l=s.getBindingValue(u(t[c],c)),p=0;p<e;p++)for(var d=0;d<a;d++)n[o++]=l[d];break;case s.BindingType.VALUE:var h=s.getBindingValue(this._value);if(1==a){var m=h;for(c=0;c<r;c++)for(p=0;p<e;p++)n[o++]=m}else for(m=h,c=0;c<r;c++)for(p=0;p<e;p++)for(d=0;d<a;d++)n[o++]=m[d];break;case s.BindingType.TEXTURE:throw new i.RuntimeError("Texture binding does not support for fillBinary")}},t}();n.Binding=u},{"../exceptions":11,"../spec/spec":23,"./array":2,"./types":4}],4:[function(t,e,n){"use strict";var r=t("../math/math");!function(t){t[t.VALUE=0]="VALUE",t[t.FUNCTION=1]="FUNCTION",t[t.TEXTURE=2]="TEXTURE"}(n.BindingType||(n.BindingType={})),n.BindingType;var a=function(t,e){this.name=t,this.offset=e};n.ShiftBinding=a,n.getBindingValue=function(t){return t instanceof r.MathType?t.toArray():t}},{"../math/math":18}],5:[function(t,e,n){"use strict";var r,a=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},o=function(t){function e(e,n,r,a){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=1),t.call(this),this.r=e,this.g=n,this.b=r,this.a=a}return a(e,t),e.prototype.toArray=function(){return[this.r,this.g,this.b,this.a]},e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.a)},e.FromArray=function(t){return new e(t[0],t[1],t[2],t[3])},e.FromHTML=function(t){return e.FromArray(r.fromHTML(t))},e}(t("../math/math").MathType);n.Color=o,function(t){t.fromHTML=function(t,e){var n;return void 0===t&&(t="#000000"),(n=t.match(/^ *rgb *\( *([0-9\.\-e]+) *, *([0-9\.\-e]+) *, *([0-9\.\-e]+) *\) *$/))?[+n[1]/255,+n[2]/255,+n[3]/255,null!=e?e:1]:(n=t.match(/^ *rgba *\( *([0-9\.\-e]+) *, *([0-9\.\-e]+) *, *([0-9\.\-e]+) *, *([0-9\.\-e]+) *\) *$/))?[+n[1]/255,+n[2]/255,+n[3]/255,null!=e?e*+n[4]:+n[4]]:(n=t.match(/^ *\#([0-9a-fA-F]{3}) *$/))?[17*parseInt(n[1][0],16)/255,17*parseInt(n[1][1],16)/255,17*parseInt(n[1][2],16)/255,null!=e?e:1]:(n=t.match(/^ *\#([0-9a-fA-F]{6}) *$/))?[parseInt(n[1].slice(0,2),16)/255,parseInt(n[1].slice(2,4),16)/255,parseInt(n[1].slice(4,6),16)/255,null!=e?e:1]:[0,0,0,1]}}(r=n.color||(n.color={}))},{"../math/math":18}],6:[function(t,e,n){"use strict";var r=t("../exceptions"),a=t("./parser"),o=t("../utils/utils"),i=t("../intrinsics/intrinsics"),s=t("../library/library"),u=function(){function t(){var t=this;this._functions=new o.Dictionary,this._functionModule=new o.Dictionary,this._currentMoudles=[],i.forEachIntrinsicFunction((function(e){t.addIntrinsicFunction(e.name,{type:"function",isMark:!1,isShader:!1,name:e.internalName,returnType:e.returnType,arguments:e.argTypes.map((function(t,e){return{name:"a"+e,type:t}})),statements:null})}))}return t.prototype.addIntrinsicFunction=function(t,e){if(this._functions.has(t))(n=this._functions.get(t)).addFunction(e);else{var n=new d(t);this._functions.set(t,n),n.addFunction(e)}},t.prototype.addFunction=function(t,e){if(this._functions.has(t))(n=this._functions.get(t)).addFunction(e);else{var n=new d(t);this._functions.set(t,n),n.addFunction(e)}},t.prototype.importFunction=function(t,e){this.addFunction(e,t.get(e)),this._functionModule.set(e,t)},t.prototype.getFunction=function(t){for(var e=this._currentMoudles.length-1;e>=0;e--){var n=this._currentMoudles[e];if(n&&n.has(t)){var r=new d(t);return r.addFunction(n.get(t)),r}}return this._functions.has(t)?this._functions.get(t):null},t.prototype.enterFunctionImplementation=function(t){this._currentMoudles.push(this._functionModule.get(t))},t.prototype.leaveFunctionImplementation=function(t){this._currentMoudles.pop()},t}();n.ModuleResolver=u;var c=function(){function t(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null),this._owner=t,this._variables=new o.Dictionary,this._parentScope=e||null,this._argMap=n}return t.prototype.addVariable=function(t,e){if(this._variables.has(t)||null!=this._argMap&&this._argMap.has(t))throw new r.CompileError(t+" is already declared.");var n=this._owner.newTranslatedName(t,e);this._variables.set(t,{name:t,type:e,translatedName:n})},t.prototype.nextVariable=function(t){var e=this,n=o.attemptName("tmp",(function(t){return!(e._variables.has(t)||null!=e._argMap&&e._argMap.has(t))}));return this.addVariable(n,t),this.getVariable(n)},t.prototype.getVariable=function(t){if(this._variables.has(t))return this._variables.get(t);if(null!=this._argMap&&this._argMap.has(t))return this._parentScope.getVariable(this._argMap.get(t));if(this._parentScope)return this._parentScope.getVariable(t);throw new r.CompileError(t+" is undefined.")},Object.defineProperty(t.prototype,"parentScope",{get:function(){return this._parentScope},enumerable:!0,configurable:!0}),t}();n.ScopeVariables=c;var l=function(){function t(){this._translatedNames=new o.Dictionary,this._globalScope=new c(this),this._currentScope=this._globalScope}return t.prototype.resetScope=function(){this._translatedNames=new o.Dictionary,this._globalScope=new c(this),this._currentScope=this._globalScope},t.prototype.pushScope=function(t){void 0===t&&(t=null),this._currentScope=new c(this,this._currentScope,t)},t.prototype.popScope=function(){this._currentScope=this._currentScope.parentScope},t.prototype.newTranslatedName=function(t,e){var n=this,r=o.attemptName(t,(function(t){return!n._translatedNames.has(t)}));return this._translatedNames.set(r,{name:t,type:e,translatedName:r}),r},t.prototype.forEach=function(t){this._translatedNames.forEach((function(e){t(e.translatedName,e.type)}))},t.prototype.nextVariableTranslatedName=function(t){return this.nextVariable(t).translatedName},t.prototype.nextVariableName=function(t){return this.nextVariable(t).name},t.prototype.nextVariable=function(t){return this._currentScope.nextVariable(t)},t.prototype.addVariable=function(t,e,n){"global"==n?this._globalScope.addVariable(t,e):this._currentScope.addVariable(t,e)},t.prototype.translateVariableName=function(t){return this.getVariable(t).translatedName},t.prototype.getVariable=function(t){return this._currentScope.getVariable(t)},t}();function p(t,e){var n=i.getTypeConversion(t.valueType,e);if(n){var r=n.rank;return[{type:"function",valueType:e,arguments:[t],functionName:n.internalName},r]}return[null,null]}n.ScopeStack=l;var d=function(){function t(t){this._name=t,this._functions=[]}return t.prototype.addFunction=function(t){this._functions.push(t)},t.prototype.resolveArguments=function(t,e){for(var n=null,a=null,o=0,i=this._functions;o<i.length;o++){var s=i[o],u=0,c=!0,l=[],d=[],h=[];for(var m in s.arguments){var f=s.arguments[m],g=t[m]||e[f.name];if(null!=t[m]?d.push(m):e[f.name]&&h.push(f.name),null!=g)if(g.valueType!=f.type){var y=p(g,f.type),v=y[0],_=y[1];if(!v){c=!1;break}l.push(v),u+=_}else l.push(g);else{if(null===f.default||void 0===f.default){c=!1;break}l.push({type:"constant",value:f.default,valueType:f.type})}}var x=!0;for(var m in t)d.indexOf(m)<0&&(x=!1);for(var b in e)h.indexOf(b)<0&&(x=!1);c&&x&&(!n||u<a)&&(n=[s,l],a=u)}if(n)return n;var C=t.map((function(t){return t.valueType})).join(", ");throw new r.CompileError("unable to resolve function '"+this._name+"' with arguments ("+C+")")},t}();n.FunctionOverloadResolver=d;var h=function(){function t(){this._scope=new l,this._constants=new o.Dictionary,this._moduleResolver=new u,this._statements=[],this._lastIndex=1,this.prepareFieldTypeRegistry(),this.prepareConstants()}return t.prototype.prepareFieldTypeRegistry=function(){this._fieldTypeRegistry={};for(var t=this._fieldTypeRegistry,e=0,n=["x","y"];e<n.length;e++)t["Vector2."+n[e]]="float";for(var r=0,a=["x","y","z","r","g","b"];r<a.length;r++)t["Vector3."+a[r]]="float";for(var o=0,i=["x","y","z","w","r","g","b","a"];o<i.length;o++)t["Vector4."+i[o]]="float";for(var s=0,u=["r","g","b","a"];s<u.length;s++)t["Color."+u[s]]="float"},t.prototype.prepareConstants=function(){var t=this;i.forEachConstant((function(e){t._constants.set(e.name,e)}))},t.prototype.resolveFunction=function(t,e,n){var a=this._moduleResolver.getFunction(t);if(a)return a.resolveArguments(e,n);throw new r.CompileError("function '"+t+" is undefined.")},t.prototype.loadFile=function(t){for(var e=this,n=function(t){if("function"==t.type){var n=t;r._moduleResolver.addFunction(n.name,n)}if("import"==t.type){var a=t;if(null!=a.functionNames)a.functionNames.forEach((function(t){e._moduleResolver.importFunction(s.getModule(a.moduleName),t)}));else{var o=s.getModule(a.moduleName);o.forEach((function(t,n){e._moduleResolver.importFunction(o,n)}))}}},r=this,a=0,o=t.blocks;a<o.length;a++)n(o[a])},t.prototype.getDefaultValueForType=function(t){return"float"==t?0:"Vector2"==t?[0,0]:"Vector3"==t?[0,0,0]:"Vector4"==t?[0,0,0,0]:"Color"==t||"Quaternion"==t?[0,0,0,1]:0},t.prototype.compileFunctionToMark=function(t,e){this._scope.resetScope(),this._lastIndex=1;for(var n={},a={},o={},i=0,s=t;i<s.length;i++){var u=s[i];this._scope.addVariable(u.name,u.valueType,"global"),n[u.name]={type:u.valueType,default:u.default||this.getDefaultValueForType(u.valueType)}}for(var c=0,l=e.arguments;c<l.length;c++){var p=l[c];this._scope.addVariable(p.name,p.type,"local"),n[p.name]={type:p.type,default:p.default||this.getDefaultValueForType(p.type)}}this.compileStatements({type:"statements",statements:e.statements}),this._scope.forEach((function(t,e){n[t]||(o[t]=e)}));var d=function(t){t.forEach((function(t){if("emit"==t.type){var e=t;for(var n in e.attributes)if(a.hasOwnProperty(n)){if(a[n].type!=e.attributes[n].valueType)throw new r.CompileError("output variable '"+n+" has conflicting types.")}else a[n]={type:e.attributes[n].valueType}}if("condition"==t.type){var o=t;d(o.trueStatements),d(o.falseStatements)}"for"==t.type&&d(t.statements)}))};return d(this._statements),{input:n,output:a,variables:o,statements:this._statements}},t.prototype.addStatement=function(t){this._statements.push(t)},t.prototype.addStatements=function(t){this._statements=this._statements.concat(t)},t.prototype.captureStatements=function(t){var e=this._statements;this._statements=[],t();var n=this._statements;return this._statements=e,n},t.prototype.compileExpression=function(t){switch(t.type){case"value":return{type:"constant",value:(e=t).value,valueType:e.valueType};case"variable":var e=t;if(this._constants.has(e.name)){var n=this._constants.get(e.name);return{type:"constant",value:n.value,valueType:n.type}}return{type:"variable",variableName:this._scope.translateVariableName(e.name),valueType:this._scope.getVariable(e.name).type};case"field":e=t;var r=this.compileExpression(e.value);return{type:"field",fieldName:e.fieldName,value:r,valueType:this._fieldTypeRegistry[r.valueType+"."+e.fieldName]};case"function":for(var a=[],i={},s=0,u=(e=t).args.args;s<u.length;s++){var c=u[s];a.push(this.compileExpression(c))}for(var l in e.args.kwargs)e.args.kwargs[l],i[l]=this.compileExpression(e.args.kwargs[l]);var p=this.resolveFunction(e.name,a,i),d=p[0],h=p[1],m=null;if(d.statements){var f=new o.Dictionary;for(var g in d.arguments){c=d.arguments[g];var y=this._scope.nextVariableName(c.type);f.set(c.name,y),this.addStatement({type:"assign",variableName:this._scope.translateVariableName(y),expression:h[g]})}this._scope.pushScope(f),this._moduleResolver.enterFunctionImplementation(e.name);for(var v=0,_=d.statements;v<_.length;v++){var x=_[v];if("return"==x.type){var b=x;m=this.compileExpression(b.value);break}this.compileStatement(x)}this._moduleResolver.leaveFunctionImplementation(e.name),this._scope.popScope()}else m={type:"function",functionName:d.name,arguments:h,valueType:d.returnType};return m}return null},t.prototype.compileStandaloneExpression=function(t,e){switch(t.type){case"value":return{type:"constant",value:(n=t).value,valueType:n.valueType};case"variable":var n=t;if(e.has(n.name))return e.get(n.name);if(this._constants.has(n.name)){var a=this._constants.get(n.name);return{type:"constant",value:a.value,valueType:a.type}}throw new r.CompileError("variable "+n.name+" is undefined");case"field":n=t;var o=this.compileStandaloneExpression(n.value,e);return{type:"field",fieldName:n.fieldName,value:o,valueType:this._fieldTypeRegistry[o.valueType+"."+n.fieldName]};case"function":for(var i=[],s={},u=0,c=(n=t).args.args;u<c.length;u++){var l=c[u];i.push(this.compileStandaloneExpression(l,e))}for(var p in n.args.kwargs)n.args.kwargs[p],s[p]=this.compileStandaloneExpression(n.args.kwargs[p],e);var d=this.resolveFunction(n.name,i,s),h=d[0],m=d[1];return{type:"function",functionName:h.name,arguments:m,valueType:h.returnType}}return null},t.prototype.compileStatements=function(t){this._scope.pushScope();for(var e=0,n=t.statements;e<n.length;e++){var r=n[e];this.compileStatement(r)}this._scope.popScope()},t.prototype.compileStatement=function(t){var e=this;switch(t.type){case"declare":if((i=t).initial){var n=this.compileExpression(i.initial),a=i.variableType;if("auto"==a&&(a=n.valueType),this._scope.addVariable(i.variableName,a,"local"),n.valueType!=a){var o=n.valueType;if(null===(n=p(n,this._scope.getVariable(i.variableName).type)[0]))throw new r.CompileError("cannot convert type '"+o+"' to '"+a+"'.")}this.addStatement({type:"assign",variableName:this._scope.translateVariableName(i.variableName),expression:n})}else this._scope.addVariable(i.variableName,i.variableType,"local");break;case"expression":var i=t;this.compileExpression(i.expression);break;case"assign":i=t,n=this.compileExpression(i.expression);var s=this._scope.getVariable(i.variableName).type;if(n.valueType!=s&&(o=n.valueType,null===(n=p(n,this._scope.getVariable(i.variableName).type)[0])))throw new r.CompileError("cannot convert type '"+o+" to '"+s+"'.");this.addStatement({type:"assign",variableName:this._scope.translateVariableName(i.variableName),expression:n});break;case"emit":(i=t).vertices.forEach((function(t){var n={};for(var r in t){var a=t[r];n[r]=e.compileExpression(a)}e.addStatement({type:"emit",attributes:n})}));break;case"statements":i=t,this.compileStatements(i);break;case"for":var u=t;this._scope.pushScope(),this._scope.addVariable(u.variableName,"int","local");var c={type:"for",variableName:this._scope.translateVariableName(u.variableName),rangeMin:u.start,rangeMax:u.end,statements:this.captureStatements((function(){return e.compileStatement(u.statement)}))};this.addStatement(c),this._scope.popScope();break;case"if":var l=t,d=function(t){if(t<l.conditions.length){e._scope.pushScope();var n={type:"condition",condition:e.compileExpression(l.conditions[t].condition),trueStatements:e.captureStatements((function(){return e.compileStatement(l.conditions[t].statement)})),falseStatements:e.captureStatements((function(){return d(t+1)}))};e.addStatement(n),e._scope.popScope()}else l.else&&e.compileStatement(l.else)};d(0);break;case"return":throw new r.CompileError("unexpected return statement")}},t}();function m(t){for(var e={},n=t.blocks.filter((function(t){return"global"==t.type})),r=0,a=t.blocks;r<a.length;r++){var o=a[r];if("function"==o.type){var i=o;if(i.isMark||i.isShader){var s=new h;s.loadFile(t);var u=s.compileFunctionToMark(n,i);e[i.name]=u}}}return e}n.Compiler=h,n.compileTree=m;var f=new h;n.compileExpression=function(t,e){return f.compileStandaloneExpression(t,e)},n.compileString=function(t){return m(a.parseFile(t))}},{"../exceptions":11,"../intrinsics/intrinsics":12,"../library/library":13,"../utils/utils":26,"./parser":8}],7:[function(t,e,n){"use strict";var r=t("../utils/utils"),a=t("./compiler"),o=function(){function t(t){this._name=t,this._attrs=new r.Dictionary}return t.prototype.attr=function(t,e){return this._attrs.set(t,e),this},t.prototype.generateCode=function(){var t=[];return this._attrs.forEach((function(e,n){t.push(n+" = "+e)})),this._name+"("+t.join(", ")+")"},t}();n.CustomMarkItem=o;var i=function(){function t(){this._imports=[],this._inputs=[],this._variables=[],this._items=[]}return t.prototype.input=function(t,e,n){return this._inputs.push([t,e,n]),this},t.prototype.variable=function(t,e){return this._variables.push([t,e]),this},t.prototype.add=function(t){for(var e=t.split("."),n=e[0],r=e[1],a=!1,i=0,s=this._imports;i<s.length;i++){var u=s[i],c=u[0],l=u[1];c==n&&l==r&&(a=!0)}a||this._imports.push([n,r]);var p=new o(r);return this._items.push(p),p},t.prototype.generateCode=function(t){for(var e=[],n=0,r=this._imports;n<r.length;n++){var a=r[n],o=a[0],i=a[1];e.push("import { "+i+" } from "+o+";")}for(var s=[],u=0,c=this._inputs;u<c.length;u++){var l=c[u],p=l[0],d=l[1],h=l[2];null==h?s.push(p+": "+d):s.push(p+": "+d+" = "+h)}e.push("mark "+t+"("),e.push("    "+s.join(", ")),e.push(") {");for(var m=0,f=this._variables;m<f.length;m++){var g=f[m],y=g[0],v=g[1];e.push("    let "+y+" = "+v+";")}for(var _=0,x=this._items;_<x.length;_++){var b=x[_];e.push("    "+b.generateCode()+";")}return e.push("}"),e.join("\n")},t.prototype.compile=function(){var t=this.generateCode("Mark");return a.compileString(t).Mark},t}();n.CustomMark=i},{"../utils/utils":26,"./compiler":6}],8:[function(t,e,n){"use strict";var r=t("../exceptions"),a=t("./parser_pegjs");n.parseFile=function(t){t=function(t){return t=(t=t.replace(/\/\/[^\n]*\n/g,"\n")).replace(/\/\/[^\n]*$/g,"")}(t);var e=null;try{e=a.parse(t,{startRule:"FileEntry"})}catch(t){throw t.location?new r.ParseError(t.message,t.location.start,t.location.end):new r.ParseError(t.message)}return e},n.parseExpression=function(t){var e=null;try{e=a.parse(t,{startRule:"ExpressionEntry"})}catch(t){throw t.location?new r.ParseError(t.message,t.location.start,t.location.end):new r.ParseError(t.message)}return e}},{"../exceptions":11,"./parser_pegjs":9}],9:[function(t,e,n){e.exports=function(){"use strict";function t(e,n,r,a){this.message=e,this.expected=n,this.found=r,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(t,Error),{SyntaxError:t,parse:function(e){var n,r=arguments.length>1?arguments[1]:{},a={},o={FileEntry:Ge,ExpressionEntry:$e},i=Ge,s=function(t){return{blocks:t.map((function(t){return t[0]}))}},u=function(t){return t},c="function",l={type:"literal",value:"function",description:'"function"'},p="mark",d={type:"literal",value:"mark",description:'"mark"'},h="shader",m={type:"literal",value:"shader",description:'"shader"'},f="(",g={type:"literal",value:"(",description:'"("'},y=")",v={type:"literal",value:")",description:'")"'},_=":",x={type:"literal",value:":",description:'":"'},b="{",C={type:"literal",value:"{",description:'"{"'},w="}",P={type:"literal",value:"}",description:'"}"'},T=function(t,e,n,r,a){return{type:"function",isMark:"mark"==Bn(t),isShader:"shader"==Bn(t),name:e,returnType:r?r[3]:"void",arguments:n,statements:a}},V="let",M={type:"literal",value:"let",description:'"let"'},E="=",A={type:"literal",value:"=",description:'"="'},k=";",S={type:"literal",value:";",description:'";"'},B=function(t,e,n){return{type:"global",name:t,valueType:e?e[3]:"auto",default:n?n[3]:void 0}},N="import",F={type:"literal",value:"import",description:'"import"'},I="*",L={type:"literal",value:"*",description:'"*"'},R="from",D={type:"literal",value:"from",description:'"from"'},z=function(t){return{type:"import",moduleName:t,functionNames:null}},O=",",G={type:"literal",value:",",description:'","'},$=function(t,e,n){return{type:"import",moduleName:n,functionNames:Nn(t,e,3)}},U=function(t,e){return Nn(t,e,3)},j=function(){return[]},J=function(t,e,n){return{type:e,name:t,default:n}},W=function(t,e){return{type:e,name:t}},K=function(t,e){return Nn(t,e,1)},q=function(t){return t},Z=function(t){return{type:"statements",statements:t}},H="return",Y={type:"literal",value:"return",description:'"return"'},Q=function(t){return{type:"return",value:t}},X="emit",tt={type:"literal",value:"emit",description:'"emit"'},et="[",nt={type:"literal",value:"[",description:'"["'},rt="]",at={type:"literal",value:"]",description:'"]"'},ot=function(t){return{type:"emit",vertices:t}},it=function(t){return{type:"emit",vertices:[t]}},st=function(t,e){return{name:t,value:e}},ut=function(t,e){return In(Nn(t,e,3)).kwargs},ct=function(){return{}},lt=function(t,e){return Nn(t,e,4)},pt=function(t){return{type:"expression",expression:t}},dt=function(t,e,n){return{type:"declare",variableType:e?e[3]:"auto",variableName:t,initial:n?n[3]:void 0}},ht=function(t,e){return{type:"assign",variableName:t,expression:e}},mt="for",ft={type:"literal",value:"for",description:'"for"'},gt="in",yt={type:"literal",value:"in",description:'"in"'},vt="..",_t={type:"literal",value:"..",description:'".."'},xt=function(t,e,n,r){return{type:"for",variableName:t,statement:r,start:e,end:n}},bt="if",Ct={type:"literal",value:"if",description:'"if"'},wt="else",Pt={type:"literal",value:"else",description:'"else"'},Tt=function(t,e,n,r){return{type:"if",conditions:[{condition:t,statement:e}].concat(n.map((function(t){return{condition:t[7],statement:t[11]}}))),else:r?r[3]:null}},Vt="&&",Mt={type:"literal",value:"&&",description:'"&&"'},Et="||",At={type:"literal",value:"||",description:'"||"'},kt=">=",St={type:"literal",value:">=",description:'">="'},Bt=">",Nt={type:"literal",value:">",description:'">"'},Ft="<=",It={type:"literal",value:"<=",description:'"<="'},Lt="<",Rt={type:"literal",value:"<",description:'"<"'},Dt="==",zt={type:"literal",value:"==",description:'"=="'},Ot="!=",Gt={type:"literal",value:"!=",description:'"!="'},$t="+",Ut={type:"literal",value:"+",description:'"+"'},jt="-",Jt={type:"literal",value:"-",description:'"-"'},Wt="/",Kt={type:"literal",value:"/",description:'"/"'},qt="%",Zt={type:"literal",value:"%",description:'"%"'},Ht="not",Yt={type:"literal",value:"not",description:'"not"'},Qt=function(t){return Ln({type:"operator",operator:"!",args:[item]})},Xt=function(t,e){return Fn(t,e)},te=function(t){return Ln({type:"operator",operator:"-",args:[t]})},ee=function(t){return{type:"variable",name:t}},ne=".",re={type:"literal",value:".",description:'"."'},ae=function(t,e){return{type:"field",value:t,fieldName:e}},oe=function(t,e){return{type:"function",name:t,args:In(e)}},ie=function(t){return{value:t}},se=function(t){return{type:"value",valueType:"float",value:t}},ue=function(t){return{type:"value",valueType:"bool",value:t}},ce=function(t){return{type:"value",valueType:"int",value:t}},le=function(t,e){var n=Nn(t,e,3);return{type:"value",valueType:"Vector"+n.length,value:n}},pe=/^[+\-]/,de={type:"class",value:"[+-]",description:"[+-]"},he=/^[0-9]/,me={type:"class",value:"[0-9]",description:"[0-9]"},fe=function(t){return parseFloat(Bn(t))},ge=/^[eE]/,ye={type:"class",value:"[eE]",description:"[eE]"},ve="true",_e={type:"literal",value:"true",description:'"true"'},xe=function(){return!0},be="false",Ce={type:"literal",value:"false",description:'"false"'},we=function(){return!1},Pe=/^[a-zA-Z_]/,Te={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},Ve=/^[a-zA-Z0-9_]/,Me={type:"class",value:"[a-zA-Z0-9_]",description:"[a-zA-Z0-9_]"},Ee=function(t){return Bn(t)},Ae=/^[ \t\n]/,ke={type:"class",value:"[ \\t\\n]",description:"[ \\t\\n]"},Se=function(){return" "},Be=0,Ne=[{line:1,column:1,seenCR:!1}],Fe=0,Ie=[],Le=0;if("startRule"in r){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=o[r.startRule]}function Re(t){var n,r,a=Ne[t];if(a)return a;for(n=t-1;!Ne[n];)n--;for(a={line:(a=Ne[n]).line,column:a.column,seenCR:a.seenCR};n<t;)"\n"===(r=e.charAt(n))?(a.seenCR||a.line++,a.column=1,a.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(a.line++,a.column=1,a.seenCR=!0):(a.column++,a.seenCR=!1),n++;return Ne[t]=a,a}function De(t,e){var n=Re(t),r=Re(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function ze(t){Be<Fe||(Be>Fe&&(Fe=Be,Ie=[]),Ie.push(t))}function Oe(e,n,r,a){return null!==n&&function(t){var e=1;for(t.sort((function(t,e){return t.description<e.description?-1:t.description>e.description?1:0}));e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}(n),new t(null!==e?e:function(t,e){var n,r=new Array(t.length);for(n=0;n<t.length;n++)r[n]=t[n].description;return"Expected "+(t.length>1?r.slice(0,-1).join(", ")+" or "+r[t.length-1]:r[0])+" but "+(e?'"'+function(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,(function(t){return"\\x0"+e(t)})).replace(/[\x10-\x1F\x80-\xFF]/g,(function(t){return"\\x"+e(t)})).replace(/[\u0100-\u0FFF]/g,(function(t){return"\\u0"+e(t)})).replace(/[\u1000-\uFFFF]/g,(function(t){return"\\u"+e(t)}))}(e)+'"':"end of input")+" found."}(n,r),n,r,a)}function Ge(){var t,e,n,r,o;if(t=Be,kn()!==a){for(e=[],n=Be,(r=Ue())!==a&&(o=kn())!==a?n=r=[r,o]:(Be=n,n=a);n!==a;)e.push(n),n=Be,(r=Ue())!==a&&(o=kn())!==a?n=r=[r,o]:(Be=n,n=a);e!==a?t=s(e):(Be=t,t=a)}else Be=t,t=a;return t}function $e(){var t,e;return t=Be,kn()!==a&&(e=dn())!==a&&kn()!==a?t=u(e):(Be=t,t=a),t}function Ue(){var t;return(t=je())===a&&(t=Je())===a&&(t=We()),t}function je(){var t,n,r,o,i,s,u,V,M,E,A,k;return t=Be,e.substr(Be,8)===c?(n=c,Be+=8):(n=a,0===Le&&ze(l)),n===a&&(e.substr(Be,4)===p?(n=p,Be+=4):(n=a,0===Le&&ze(d)),n===a&&(e.substr(Be,6)===h?(n=h,Be+=6):(n=a,0===Le&&ze(m)))),n!==a&&Sn()!==a&&(r=An())!==a&&kn()!==a?(40===e.charCodeAt(Be)?(o=f,Be++):(o=a,0===Le&&ze(g)),o!==a&&(i=Ke())!==a?(41===e.charCodeAt(Be)?(s=y,Be++):(s=a,0===Le&&ze(v)),s!==a?(u=Be,(V=kn())!==a?(58===e.charCodeAt(Be)?(M=_,Be++):(M=a,0===Le&&ze(x)),M!==a&&(E=kn())!==a&&(A=An())!==a?u=V=[V,M,E,A]:(Be=u,u=a)):(Be=u,u=a),u===a&&(u=null),u!==a&&(V=kn())!==a?(123===e.charCodeAt(Be)?(M=b,Be++):(M=a,0===Le&&ze(C)),M!==a&&(E=kn())!==a&&(A=Ze())!==a&&kn()!==a?(125===e.charCodeAt(Be)?(k=w,Be++):(k=a,0===Le&&ze(P)),k!==a?t=n=T(n,r,i,u,A):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a),t}function Je(){var t,n,r,o,i,s,u,c,l;return t=Be,e.substr(Be,3)===V?(n=V,Be+=3):(n=a,0===Le&&ze(M)),n!==a&&Sn()!==a&&(r=An())!==a?(o=Be,(i=kn())!==a?(58===e.charCodeAt(Be)?(s=_,Be++):(s=a,0===Le&&ze(x)),s!==a&&(u=kn())!==a&&(c=An())!==a?o=i=[i,s,u,c]:(Be=o,o=a)):(Be=o,o=a),o===a&&(o=null),o!==a?(i=Be,(s=kn())!==a?(61===e.charCodeAt(Be)?(u=E,Be++):(u=a,0===Le&&ze(A)),u!==a&&(c=kn())!==a&&(l=Tn())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a),i===a&&(i=null),i!==a&&(s=kn())!==a?(59===e.charCodeAt(Be)?(u=k,Be++):(u=a,0===Le&&ze(S)),u!==a?t=n=B(r,o,i):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a),t}function We(){var t,n,r,o,i,s,u,c,l,p,d,h;if(t=Be,e.substr(Be,6)===N?(n=N,Be+=6):(n=a,0===Le&&ze(F)),n!==a&&Sn()!==a?(42===e.charCodeAt(Be)?(r=I,Be++):(r=a,0===Le&&ze(L)),r!==a&&Sn()!==a?(e.substr(Be,4)===R?(o=R,Be+=4):(o=a,0===Le&&ze(D)),o!==a&&(i=Sn())!==a&&(s=An())!==a&&(u=kn())!==a?(59===e.charCodeAt(Be)?(c=k,Be++):(c=a,0===Le&&ze(S)),c!==a?t=n=z(s):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a),t===a)if(t=Be,e.substr(Be,6)===N?(n=N,Be+=6):(n=a,0===Le&&ze(F)),n!==a)if(kn()!==a)if(123===e.charCodeAt(Be)?(r=b,Be++):(r=a,0===Le&&ze(C)),r!==a)if(kn()!==a)if((o=An())!==a){for(i=[],s=Be,(u=kn())!==a?(44===e.charCodeAt(Be)?(c=O,Be++):(c=a,0===Le&&ze(G)),c!==a&&(l=kn())!==a&&(p=An())!==a?s=u=[u,c,l,p]:(Be=s,s=a)):(Be=s,s=a);s!==a;)i.push(s),s=Be,(u=kn())!==a?(44===e.charCodeAt(Be)?(c=O,Be++):(c=a,0===Le&&ze(G)),c!==a&&(l=kn())!==a&&(p=An())!==a?s=u=[u,c,l,p]:(Be=s,s=a)):(Be=s,s=a);i!==a&&(s=kn())!==a?(125===e.charCodeAt(Be)?(u=w,Be++):(u=a,0===Le&&ze(P)),u!==a&&(c=kn())!==a?(e.substr(Be,4)===R?(l=R,Be+=4):(l=a,0===Le&&ze(D)),l!==a&&(p=Sn())!==a&&(d=An())!==a&&kn()!==a?(59===e.charCodeAt(Be)?(h=k,Be++):(h=a,0===Le&&ze(S)),h!==a?t=n=$(o,i,d):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)}else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;return t}function Ke(){var t,n,r,o,i,s,u,c,l;if(t=Be,(n=kn())!==a)if((r=qe())!==a){for(o=[],i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=qe())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);i!==a;)o.push(i),i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=qe())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);o!==a&&(i=kn())!==a?t=n=U(r,o):(Be=t,t=a)}else Be=t,t=a;else Be=t,t=a;return t===a&&(t=Be,(n=kn())!==a&&(n=j()),t=n),t}function qe(){var t,n,r,o,i,s;return t=Be,(n=An())!==a&&kn()!==a?(58===e.charCodeAt(Be)?(r=_,Be++):(r=a,0===Le&&ze(x)),r!==a&&kn()!==a&&(o=An())!==a&&kn()!==a?(61===e.charCodeAt(Be)?(i=E,Be++):(i=a,0===Le&&ze(A)),i!==a&&kn()!==a&&(s=Tn())!==a?t=n=J(n,o,s):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a),t===a&&(t=Be,(n=An())!==a&&kn()!==a?(58===e.charCodeAt(Be)?(r=_,Be++):(r=a,0===Le&&ze(x)),r!==a&&kn()!==a&&(o=An())!==a?t=n=W(n,o):(Be=t,t=a)):(Be=t,t=a)),t}function Ze(){var t,e,n,r,o,i;if(t=Be,(e=He())!==a){for(n=[],r=Be,(o=kn())!==a&&(i=He())!==a?r=o=[o,i]:(Be=r,r=a);r!==a;)n.push(r),r=Be,(o=kn())!==a&&(i=He())!==a?r=o=[o,i]:(Be=r,r=a);n!==a?t=e=K(e,n):(Be=t,t=a)}else Be=t,t=a;return t===a&&(t=Be,(e=kn())!==a&&(e=j()),t=e),t}function He(){var t,n,r,o;return t=Be,(n=Ye())===a&&(n=Qe())===a&&(n=rn())===a&&(n=an())===a&&(n=nn()),n!==a&&kn()!==a?(59===e.charCodeAt(Be)?(r=k,Be++):(r=a,0===Le&&ze(S)),r!==a?t=n=q(n):(Be=t,t=a)):(Be=t,t=a),t===a&&(t=on())===a&&(t=sn())===a&&(t=Be,123===e.charCodeAt(Be)?(n=b,Be++):(n=a,0===Le&&ze(C)),n!==a&&kn()!==a&&(r=Ze())!==a&&kn()!==a?(125===e.charCodeAt(Be)?(o=w,Be++):(o=a,0===Le&&ze(P)),o!==a?t=n=Z(r):(Be=t,t=a)):(Be=t,t=a)),t}function Ye(){var t,n,r;return t=Be,e.substr(Be,6)===H?(n=H,Be+=6):(n=a,0===Le&&ze(Y)),n!==a&&Sn()!==a&&(r=dn())!==a?t=n=Q(r):(Be=t,t=a),t}function Qe(){var t,n,r,o,i;return t=Be,e.substr(Be,4)===X?(n=X,Be+=4):(n=a,0===Le&&ze(tt)),n!==a&&kn()!==a?(91===e.charCodeAt(Be)?(r=et,Be++):(r=a,0===Le&&ze(nt)),r!==a&&(o=en())!==a?(93===e.charCodeAt(Be)?(i=rt,Be++):(i=a,0===Le&&ze(at)),i!==a?t=n=ot(o):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a),t===a&&(t=Be,e.substr(Be,4)===X?(n=X,Be+=4):(n=a,0===Le&&ze(tt)),n!==a&&kn()!==a?(123===e.charCodeAt(Be)?(r=b,Be++):(r=a,0===Le&&ze(C)),r!==a&&(o=tn())!==a?(125===e.charCodeAt(Be)?(i=w,Be++):(i=a,0===Le&&ze(P)),i!==a?t=n=it(o):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)),t}function Xe(){var t,n,r,o;return t=Be,(n=An())!==a&&kn()!==a?(58===e.charCodeAt(Be)?(r=_,Be++):(r=a,0===Le&&ze(x)),r!==a&&kn()!==a&&(o=dn())!==a?t=n=st(n,o):(Be=t,t=a)):(Be=t,t=a),t}function tn(){var t,n,r,o,i,s,u,c,l;if(t=Be,(n=kn())!==a)if((r=Xe())!==a){for(o=[],i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=Xe())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);i!==a;)o.push(i),i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=Xe())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);o!==a&&(i=kn())!==a?t=n=ut(r,o):(Be=t,t=a)}else Be=t,t=a;else Be=t,t=a;return t===a&&(t=Be,(n=kn())!==a&&(n=ct()),t=n),t}function en(){var t,n,r,o,i,s,u,c,l,p,d,h,m;if(t=Be,(n=kn())!==a)if(123===e.charCodeAt(Be)?(r=b,Be++):(r=a,0===Le&&ze(C)),r!==a)if((o=tn())!==a)if(125===e.charCodeAt(Be)?(i=w,Be++):(i=a,0===Le&&ze(P)),i!==a){for(s=[],u=Be,(c=kn())!==a?(44===e.charCodeAt(Be)?(l=O,Be++):(l=a,0===Le&&ze(G)),l!==a&&(p=kn())!==a?(123===e.charCodeAt(Be)?(d=b,Be++):(d=a,0===Le&&ze(C)),d!==a&&(h=tn())!==a?(125===e.charCodeAt(Be)?(m=w,Be++):(m=a,0===Le&&ze(P)),m!==a?u=c=[c,l,p,d,h,m]:(Be=u,u=a)):(Be=u,u=a)):(Be=u,u=a)):(Be=u,u=a);u!==a;)s.push(u),u=Be,(c=kn())!==a?(44===e.charCodeAt(Be)?(l=O,Be++):(l=a,0===Le&&ze(G)),l!==a&&(p=kn())!==a?(123===e.charCodeAt(Be)?(d=b,Be++):(d=a,0===Le&&ze(C)),d!==a&&(h=tn())!==a?(125===e.charCodeAt(Be)?(m=w,Be++):(m=a,0===Le&&ze(P)),m!==a?u=c=[c,l,p,d,h,m]:(Be=u,u=a)):(Be=u,u=a)):(Be=u,u=a)):(Be=u,u=a);s!==a&&(u=kn())!==a?t=n=lt(o,s):(Be=t,t=a)}else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;return t===a&&(t=Be,(n=kn())!==a&&(n=j()),t=n),t}function nn(){var t;return(t=dn())!==a&&(t=pt(t)),t}function rn(){var t,n,r,o,i,s,u,c,l;return t=Be,e.substr(Be,3)===V?(n=V,Be+=3):(n=a,0===Le&&ze(M)),n!==a&&Sn()!==a&&(r=An())!==a?(o=Be,(i=kn())!==a?(58===e.charCodeAt(Be)?(s=_,Be++):(s=a,0===Le&&ze(x)),s!==a&&(u=kn())!==a&&(c=An())!==a?o=i=[i,s,u,c]:(Be=o,o=a)):(Be=o,o=a),o===a&&(o=null),o!==a?(i=Be,(s=kn())!==a?(61===e.charCodeAt(Be)?(u=E,Be++):(u=a,0===Le&&ze(A)),u!==a&&(c=kn())!==a&&(l=dn())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a),i===a&&(i=null),i!==a?t=n=dt(r,o,i):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a),t}function an(){var t,n,r,o;return t=Be,(n=An())!==a&&kn()!==a?(61===e.charCodeAt(Be)?(r=E,Be++):(r=a,0===Le&&ze(A)),r!==a&&kn()!==a&&(o=dn())!==a?t=n=ht(n,o):(Be=t,t=a)):(Be=t,t=a),t}function on(){var t,n,r,o,i,s,u,c,l,p;return t=Be,e.substr(Be,3)===mt?(n=mt,Be+=3):(n=a,0===Le&&ze(ft)),n!==a&&kn()!==a?(40===e.charCodeAt(Be)?(r=f,Be++):(r=a,0===Le&&ze(g)),r!==a&&kn()!==a&&(o=An())!==a&&kn()!==a?(e.substr(Be,2)===gt?(i=gt,Be+=2):(i=a,0===Le&&ze(yt)),i!==a&&kn()!==a&&(s=Vn())!==a&&kn()!==a?(e.substr(Be,2)===vt?(u=vt,Be+=2):(u=a,0===Le&&ze(_t)),u!==a&&kn()!==a&&(c=Vn())!==a&&kn()!==a?(41===e.charCodeAt(Be)?(l=y,Be++):(l=a,0===Le&&ze(v)),l!==a&&kn()!==a&&(p=He())!==a?t=n=xt(o,s,c,p):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a),t}function sn(){var t,n,r,o,i,s,u,c,l,p,d,h,m,_,x,b,C,w,P,T;if(t=Be,e.substr(Be,2)===bt?(n=bt,Be+=2):(n=a,0===Le&&ze(Ct)),n!==a)if(kn()!==a)if(40===e.charCodeAt(Be)?(r=f,Be++):(r=a,0===Le&&ze(g)),r!==a)if(kn()!==a)if((o=dn())!==a)if(kn()!==a)if(41===e.charCodeAt(Be)?(i=y,Be++):(i=a,0===Le&&ze(v)),i!==a)if(kn()!==a)if((s=He())!==a){for(u=[],c=Be,(l=kn())!==a?(e.substr(Be,4)===wt?(p=wt,Be+=4):(p=a,0===Le&&ze(Pt)),p!==a&&(d=Sn())!==a?(e.substr(Be,2)===bt?(h=bt,Be+=2):(h=a,0===Le&&ze(Ct)),h!==a&&(m=kn())!==a?(40===e.charCodeAt(Be)?(_=f,Be++):(_=a,0===Le&&ze(g)),_!==a&&(x=kn())!==a&&(b=dn())!==a&&(C=kn())!==a?(41===e.charCodeAt(Be)?(w=y,Be++):(w=a,0===Le&&ze(v)),w!==a&&(P=kn())!==a&&(T=He())!==a?c=l=[l,p,d,h,m,_,x,b,C,w,P,T]:(Be=c,c=a)):(Be=c,c=a)):(Be=c,c=a)):(Be=c,c=a)):(Be=c,c=a);c!==a;)u.push(c),c=Be,(l=kn())!==a?(e.substr(Be,4)===wt?(p=wt,Be+=4):(p=a,0===Le&&ze(Pt)),p!==a&&(d=Sn())!==a?(e.substr(Be,2)===bt?(h=bt,Be+=2):(h=a,0===Le&&ze(Ct)),h!==a&&(m=kn())!==a?(40===e.charCodeAt(Be)?(_=f,Be++):(_=a,0===Le&&ze(g)),_!==a&&(x=kn())!==a&&(b=dn())!==a&&(C=kn())!==a?(41===e.charCodeAt(Be)?(w=y,Be++):(w=a,0===Le&&ze(v)),w!==a&&(P=kn())!==a&&(T=He())!==a?c=l=[l,p,d,h,m,_,x,b,C,w,P,T]:(Be=c,c=a)):(Be=c,c=a)):(Be=c,c=a)):(Be=c,c=a)):(Be=c,c=a);u!==a?(c=Be,(l=kn())!==a?(e.substr(Be,4)===wt?(p=wt,Be+=4):(p=a,0===Le&&ze(Pt)),p!==a&&(d=kn())!==a&&(h=He())!==a?c=l=[l,p,d,h]:(Be=c,c=a)):(Be=c,c=a),c===a&&(c=null),c!==a?t=n=Tt(o,s,u,c):(Be=t,t=a)):(Be=t,t=a)}else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;return t}function un(){var t;return e.substr(Be,2)===Vt?(t=Vt,Be+=2):(t=a,0===Le&&ze(Mt)),t===a&&(e.substr(Be,2)===Et?(t=Et,Be+=2):(t=a,0===Le&&ze(At))),t}function cn(){var t;return e.substr(Be,2)===kt?(t=kt,Be+=2):(t=a,0===Le&&ze(St)),t===a&&(62===e.charCodeAt(Be)?(t=Bt,Be++):(t=a,0===Le&&ze(Nt)),t===a&&(e.substr(Be,2)===Ft?(t=Ft,Be+=2):(t=a,0===Le&&ze(It)),t===a&&(60===e.charCodeAt(Be)?(t=Lt,Be++):(t=a,0===Le&&ze(Rt)),t===a&&(e.substr(Be,2)===Dt?(t=Dt,Be+=2):(t=a,0===Le&&ze(zt)),t===a&&(e.substr(Be,2)===Ot?(t=Ot,Be+=2):(t=a,0===Le&&ze(Gt))))))),t}function ln(){var t;return 43===e.charCodeAt(Be)?(t=$t,Be++):(t=a,0===Le&&ze(Ut)),t===a&&(45===e.charCodeAt(Be)?(t=jt,Be++):(t=a,0===Le&&ze(Jt))),t}function pn(){var t;return 42===e.charCodeAt(Be)?(t=I,Be++):(t=a,0===Le&&ze(L)),t===a&&(47===e.charCodeAt(Be)?(t=Wt,Be++):(t=a,0===Le&&ze(Kt)),t===a&&(37===e.charCodeAt(Be)?(t=qt,Be++):(t=a,0===Le&&ze(Zt)))),t}function dn(){var t,n,r,o,i,s,u,c;if(t=Be,e.substr(Be,3)===Ht?(n=Ht,Be+=3):(n=a,0===Le&&ze(Yt)),n!==a&&(r=kn())!==a&&(o=dn())!==a?t=n=Qt(o):(Be=t,t=a),t===a)if(t=Be,(n=hn())!==a){for(r=[],o=Be,(i=kn())!==a&&(s=un())!==a&&(u=kn())!==a&&(c=hn())!==a?o=i=[i,s,u,c]:(Be=o,o=a);o!==a;)r.push(o),o=Be,(i=kn())!==a&&(s=un())!==a&&(u=kn())!==a&&(c=hn())!==a?o=i=[i,s,u,c]:(Be=o,o=a);r!==a?t=n=Xt(n,r):(Be=t,t=a)}else Be=t,t=a;return t}function hn(){var t,e,n,r,o,i,s,u;if(t=Be,(e=mn())!==a){for(n=[],r=Be,(o=kn())!==a&&(i=cn())!==a&&(s=kn())!==a&&(u=mn())!==a?r=o=[o,i,s,u]:(Be=r,r=a);r!==a;)n.push(r),r=Be,(o=kn())!==a&&(i=cn())!==a&&(s=kn())!==a&&(u=mn())!==a?r=o=[o,i,s,u]:(Be=r,r=a);n!==a?t=e=Xt(e,n):(Be=t,t=a)}else Be=t,t=a;return t===a&&(t=mn()),t}function mn(){var t,e,n,r,o,i,s,u;if(t=Be,(e=fn())!==a){for(n=[],r=Be,(o=kn())!==a&&(i=ln())!==a&&(s=kn())!==a&&(u=fn())!==a?r=o=[o,i,s,u]:(Be=r,r=a);r!==a;)n.push(r),r=Be,(o=kn())!==a&&(i=ln())!==a&&(s=kn())!==a&&(u=fn())!==a?r=o=[o,i,s,u]:(Be=r,r=a);n!==a?t=e=Xt(e,n):(Be=t,t=a)}else Be=t,t=a;return t===a&&(t=fn()),t}function fn(){var t,e,n,r,o,i,s,u;if(t=Be,(e=gn())!==a){for(n=[],r=Be,(o=kn())!==a&&(i=pn())!==a&&(s=kn())!==a&&(u=gn())!==a?r=o=[o,i,s,u]:(Be=r,r=a);r!==a;)n.push(r),r=Be,(o=kn())!==a&&(i=pn())!==a&&(s=kn())!==a&&(u=gn())!==a?r=o=[o,i,s,u]:(Be=r,r=a);n!==a?t=e=Xt(e,n):(Be=t,t=a)}else Be=t,t=a;return t===a&&(t=gn()),t}function gn(){var t,n,r;return t=Be,45===e.charCodeAt(Be)?(n=jt,Be++):(n=a,0===Le&&ze(Jt)),n!==a&&kn()!==a&&(r=vn())!==a?t=n=te(r):(Be=t,t=a),t===a&&(t=vn()),t}function yn(){var t,n,r,o;return t=Be,40===e.charCodeAt(Be)?(n=f,Be++):(n=a,0===Le&&ze(g)),n!==a&&kn()!==a&&(r=dn())!==a&&kn()!==a?(41===e.charCodeAt(Be)?(o=y,Be++):(o=a,0===Le&&ze(v)),o!==a?t=n=u(r):(Be=t,t=a)):(Be=t,t=a),t}function vn(){var t;return(t=bn())===a&&(t=xn())===a&&(t=_n())===a&&(t=Pn())===a&&(t=yn()),t}function _n(){var t;return(t=An())!==a&&(t=ee(t)),t}function xn(){var t,n,r,o;return t=Be,(n=bn())===a&&(n=_n())===a&&(n=yn()),n!==a?(46===e.charCodeAt(Be)?(r=ne,Be++):(r=a,0===Le&&ze(re)),r!==a&&(o=An())!==a?t=n=ae(n,o):(Be=t,t=a)):(Be=t,t=a),t}function bn(){var t,n,r,o,i;return t=Be,(n=An())!==a&&kn()!==a?(40===e.charCodeAt(Be)?(r=f,Be++):(r=a,0===Le&&ze(g)),r!==a&&(o=Cn())!==a?(41===e.charCodeAt(Be)?(i=y,Be++):(i=a,0===Le&&ze(v)),i!==a?t=n=oe(n,o):(Be=t,t=a)):(Be=t,t=a)):(Be=t,t=a),t}function Cn(){var t,n,r,o,i,s,u,c,l;if(t=Be,(n=kn())!==a)if((r=wn())!==a){for(o=[],i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=wn())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);i!==a;)o.push(i),i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=wn())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);o!==a&&(i=kn())!==a?t=n=U(r,o):(Be=t,t=a)}else Be=t,t=a;else Be=t,t=a;return t===a&&(t=Be,(n=kn())!==a&&(n=j()),t=n),t}function wn(){var t,n,r,o;return t=Be,(n=An())!==a&&kn()!==a?(61===e.charCodeAt(Be)?(r=E,Be++):(r=a,0===Le&&ze(A)),r!==a&&kn()!==a&&(o=dn())!==a?t=n=st(n,o):(Be=t,t=a)):(Be=t,t=a),t===a&&(t=Be,(n=dn())!==a&&(n=ie(n)),t=n),t}function Pn(){var t,n,r,o,i,s,u,c,l;if(t=Be,(n=Mn())!==a&&(n=se(n)),(t=n)===a&&(t=Be,(n=Vn())!==a&&(n=ue(n)),(t=n)===a&&(t=Be,(n=En())!==a&&(n=ce(n)),(t=n)===a)))if(t=Be,91===e.charCodeAt(Be)?(n=et,Be++):(n=a,0===Le&&ze(nt)),n!==a)if(kn()!==a)if((r=Mn())!==a){for(o=[],i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=Mn())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);i!==a;)o.push(i),i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=Mn())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);o!==a&&(i=kn())!==a?(93===e.charCodeAt(Be)?(s=rt,Be++):(s=a,0===Le&&ze(at)),s!==a?t=n=le(r,o):(Be=t,t=a)):(Be=t,t=a)}else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;return t}function Tn(){var t,n,r,o,i,s,u,c,l;if((t=Mn())===a&&(t=Vn())===a&&(t=En())===a)if(t=Be,91===e.charCodeAt(Be)?(n=et,Be++):(n=a,0===Le&&ze(nt)),n!==a)if(kn()!==a)if((r=Mn())!==a){for(o=[],i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=Mn())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);i!==a;)o.push(i),i=Be,(s=kn())!==a?(44===e.charCodeAt(Be)?(u=O,Be++):(u=a,0===Le&&ze(G)),u!==a&&(c=kn())!==a&&(l=Mn())!==a?i=s=[s,u,c,l]:(Be=i,i=a)):(Be=i,i=a);o!==a&&(i=kn())!==a?(93===e.charCodeAt(Be)?(s=rt,Be++):(s=a,0===Le&&ze(at)),s!==a?t=n=U(r,o):(Be=t,t=a)):(Be=t,t=a)}else Be=t,t=a;else Be=t,t=a;else Be=t,t=a;return t}function Vn(){var t,n,r,o;if(t=Be,pe.test(e.charAt(Be))?(n=e.charAt(Be),Be++):(n=a,0===Le&&ze(de)),n===a&&(n=null),n!==a){if(r=[],he.test(e.charAt(Be))?(o=e.charAt(Be),Be++):(o=a,0===Le&&ze(me)),o!==a)for(;o!==a;)r.push(o),he.test(e.charAt(Be))?(o=e.charAt(Be),Be++):(o=a,0===Le&&ze(me));else r=a;r!==a?t=n=[n,r]:(Be=t,t=a)}else Be=t,t=a;return t!==a&&(t=fe(t)),t}function Mn(){var t,n,r,o,i,s,u,c,l;if(t=Be,pe.test(e.charAt(Be))?(n=e.charAt(Be),Be++):(n=a,0===Le&&ze(de)),n===a&&(n=null),n!==a){if(r=[],he.test(e.charAt(Be))?(o=e.charAt(Be),Be++):(o=a,0===Le&&ze(me)),o!==a)for(;o!==a;)r.push(o),he.test(e.charAt(Be))?(o=e.charAt(Be),Be++):(o=a,0===Le&&ze(me));else r=a;if(r!==a){if(o=Be,46===e.charCodeAt(Be)?(i=ne,Be++):(i=a,0===Le&&ze(re)),i!==a){if(s=[],he.test(e.charAt(Be))?(u=e.charAt(Be),Be++):(u=a,0===Le&&ze(me)),u!==a)for(;u!==a;)s.push(u),he.test(e.charAt(Be))?(u=e.charAt(Be),Be++):(u=a,0===Le&&ze(me));else s=a;s!==a?o=i=[i,s]:(Be=o,o=a)}else Be=o,o=a;if(o===a&&(o=null),o!==a){if(i=Be,ge.test(e.charAt(Be))?(s=e.charAt(Be),Be++):(s=a,0===Le&&ze(ye)),s!==a)if(pe.test(e.charAt(Be))?(u=e.charAt(Be),Be++):(u=a,0===Le&&ze(de)),u===a&&(u=null),u!==a){if(c=[],he.test(e.charAt(Be))?(l=e.charAt(Be),Be++):(l=a,0===Le&&ze(me)),l!==a)for(;l!==a;)c.push(l),he.test(e.charAt(Be))?(l=e.charAt(Be),Be++):(l=a,0===Le&&ze(me));else c=a;c!==a?i=s=[s,u,c]:(Be=i,i=a)}else Be=i,i=a;else Be=i,i=a;i===a&&(i=null),i!==a?t=n=[n,r,o,i]:(Be=t,t=a)}else Be=t,t=a}else Be=t,t=a}else Be=t,t=a;return t!==a&&(t=fe(t)),t}function En(){var t,n;return t=Be,e.substr(Be,4)===ve?(n=ve,Be+=4):(n=a,0===Le&&ze(_e)),n!==a&&(n=xe()),(t=n)===a&&(t=Be,e.substr(Be,5)===be?(n=be,Be+=5):(n=a,0===Le&&ze(Ce)),n!==a&&(n=we()),t=n),t}function An(){var t,n,r,o;if(t=Be,Pe.test(e.charAt(Be))?(n=e.charAt(Be),Be++):(n=a,0===Le&&ze(Te)),n!==a){for(r=[],Ve.test(e.charAt(Be))?(o=e.charAt(Be),Be++):(o=a,0===Le&&ze(Me));o!==a;)r.push(o),Ve.test(e.charAt(Be))?(o=e.charAt(Be),Be++):(o=a,0===Le&&ze(Me));r!==a?t=n=[n,r]:(Be=t,t=a)}else Be=t,t=a;return t!==a&&(t=Ee(t)),t}function kn(){var t,n;for(t=[],Ae.test(e.charAt(Be))?(n=e.charAt(Be),Be++):(n=a,0===Le&&ze(ke));n!==a;)t.push(n),Ae.test(e.charAt(Be))?(n=e.charAt(Be),Be++):(n=a,0===Le&&ze(ke));return t!==a&&(t=Se()),t}function Sn(){var t,n;if(t=[],Ae.test(e.charAt(Be))?(n=e.charAt(Be),Be++):(n=a,0===Le&&ze(ke)),n!==a)for(;n!==a;)t.push(n),Ae.test(e.charAt(Be))?(n=e.charAt(Be),Be++):(n=a,0===Le&&ze(ke));else t=a;return t!==a&&(t=Se()),t}function Bn(t){if(t instanceof Array){for(var e="",n=0;n<t.length;n++)e+=Bn(t[n]);return e}return t||""}function Nn(t,e,n){return e?[t].concat(e.map((function(t){return t[n]}))):[t]}function Fn(t,e){var n=t;return e.forEach((function(t){var e=t[1],r=t[3];n=Ln({type:"operator",operator:e,args:[n,r]})})),n}function In(t){var e={args:[],kwargs:{}};return t.forEach((function(t){void 0!==t.name?e.kwargs[t.name]=t.value:e.args.push(t.value)})),e}function Ln(t){return{type:"function",name:"@"+t.operator,args:{args:t.args,kwargs:{}}}}if((n=i())!==a&&Be===e.length)return n;throw n!==a&&Be<e.length&&ze({type:"end",description:"end of input"}),Oe(null,Ie,Fe<e.length?e.charAt(Fe):null,Fe<e.length?De(Fe,Fe+1):De(Fe,Fe))}}}()},{}],10:[function(t,e,n){"use strict";var r=t("../exceptions"),a=t("../utils/utils"),o=t("../intrinsics/intrinsics"),i=function(){function t(){this._variables=new a.Dictionary}return t.prototype.get=function(t){if(!this._variables.has(t))throw new r.RuntimeError("'"+t+"' is undefined.");return this._variables.get(t)},t.prototype.set=function(t,e){this._variables.set(t,e)},t.prototype.evaluateExpression=function(t){var e=this;switch(t.type){case"function":var n=(i=t).arguments.map((function(t){return e.evaluateExpression(t)})),a=o.getIntrinsicFunction(i.functionName);if(!a)throw new r.RuntimeError("function '"+i.functionName+"' is undefined.");return a.javascriptImplementation.apply(a,n);case"field":var i=t,s=this.evaluateExpression(i.value);switch(i.fieldName){case"x":return s[0];case"y":return s[1];case"z":return s[2];case"w":return s[3];case"r":return s[0];case"g":return s[1];case"b":return s[2];case"a":return s[3]}throw new r.RuntimeError("invalid field.");case"constant":return(i=t).value;case"variable":return i=t,this.get(i.variableName)}},t.prototype.evaluateStatement=function(t){switch(t.type){case"assign":var e=t;return this.set(e.variableName,this.evaluateExpression(e.expression)),[];case"condition":return e=t,0!=this.evaluateExpression(e.condition)?this.evaluateStatements(e.trueStatements):this.evaluateStatements(e.falseStatements);case"emit":e=t;var n={};for(var r in e.attributes){var a=this.evaluateExpression(e.attributes[r]);n[r]=a}return[n]}},t.prototype.evaluateStatements=function(t){for(var e=[],n=0,r=t;n<r.length;n++)for(var a=r[n],o=0,i=this.evaluateStatement(a);o<i.length;o++){var s=i[o];e.push(s)}return e},t.prototype.evaluateMark=function(t,e){for(var n in e)this.set(n,e[n]);return this.evaluateStatements(t.statements)},t}();n.Context=i},{"../exceptions":11,"../intrinsics/intrinsics":12,"../utils/utils":26}],11:[function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=function(t){function e(e){t.call(this,e),this.stack=new Error(e).stack}return r(e,t),e}(Error);n.BaseError=a;var o=function(t){function e(e,n,r){t.call(this,e),this.name="ParseError",this.message=e,this.start=n,this.end=r}return r(e,t),e}(a);n.ParseError=o;var i=function(t){function e(e,n,r){t.call(this,e),this.name="CompileError",this.message=e,this.start=n,this.end=r}return r(e,t),e}(a);n.CompileError=i;var s=function(t){function e(e,n,r){t.call(this,e),this.name="RuntimeError",this.message=e,this.start=n,this.end=r}return r(e,t),e}(a);n.RuntimeError=s},{}],12:[function(t,e,n){"use strict";var r=t("../utils/utils"),a=t("../math/math"),o=new r.Dictionary,i=[],s=new r.Dictionary,u=new r.Dictionary;function c(t){return"@"+t.name+":"+t.argTypes.join(",")+":"+t.returnType}function l(t){t.internalName=c(t),o.set(t.internalName,t),i.push(t)}function p(t,e,n){var r={name:t,type:e,value:n};u.set(t,r)}function d(t,e,n,r){var a={name:"cast:"+t+":"+e,argTypes:[t],returnType:e,javascriptImplementation:r};l(a),s.set(t+":"+e,{internalName:a.internalName,rank:n})}function h(t,e,n,r){l({name:t,argTypes:e,returnType:n,javascriptImplementation:r})}function m(t,e,n,r){l({name:"@"+t,argTypes:e,returnType:n,javascriptImplementation:r})}function f(){throw new Error("not implemented")}n.getInternalName=c,n.getIntrinsicFunction=function(t){return o.has(t)||console.log(t),o.get(t)},n.forEachIntrinsicFunction=function(t){i.forEach(t)},n.addIntrinsicFunction=l,n.addConstant=p,n.forEachConstant=function(t){u.forEach(t)},n.forEachTypeConversion=function(t){s.forEach(t)},n.getTypeConversion=function(t,e){return s.get(t+":"+e)};var g=function(t,e,n){return h(t,e,t,n)};m("+",["float","float"],"float",(function(t,e){return t+e})),m("-",["float","float"],"float",(function(t,e){return t-e})),m("*",["float","float"],"float",(function(t,e){return t*e})),m("/",["float","float"],"float",(function(t,e){return t/e})),m("+",["float"],"float",(function(t){return+t})),m("-",["float"],"float",(function(t){return-t})),m("%",["int","int"],"int",(function(t,e){return t%e})),m("%",["float","float"],"float",(function(t,e){return t%e})),m("+",["int","int"],"int",(function(t,e){return t+e})),m("-",["int","int"],"int",(function(t,e){return t-e})),m("*",["int","int"],"int",(function(t,e){return t*e})),m("/",["int","int"],"int",(function(t,e){return t/e})),m("+",["int"],"int",(function(t){return+t})),m("-",["int"],"int",(function(t){return-t})),m("+",["Vector2","Vector2"],"Vector2",(function(t,e){return[t[0]+e[0],t[1]+e[1]]})),m("-",["Vector2","Vector2"],"Vector2",(function(t,e){return[t[0]-e[0],t[1]-e[1]]})),m("*",["Vector2","Vector2"],"Vector2",(function(t,e){return[t[0]*e[0],t[1]*e[1]]})),m("/",["Vector2","Vector2"],"Vector2",(function(t,e){return[t[0]/e[0],t[1]/e[1]]})),m("+",["Vector2"],"Vector2",(function(t){return t})),m("-",["Vector2"],"Vector2",(function(t){return[-t[0],-t[1]]})),m("+",["Vector3","Vector3"],"Vector3",(function(t,e){return[t[0]+e[0],t[1]+e[1],t[2]+e[2]]})),m("-",["Vector3","Vector3"],"Vector3",(function(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]})),m("*",["Vector3","Vector3"],"Vector3",(function(t,e){return[t[0]*e[0],t[1]*e[1],t[2]*e[2]]})),m("/",["Vector3","Vector3"],"Vector3",(function(t,e){return[t[0]/e[0],t[1]/e[1],t[2]/e[2]]})),m("+",["Vector3"],"Vector3",(function(t){return t})),m("-",["Vector3"],"Vector3",(function(t){return[-t[0],-t[1],-t[2]]})),m("+",["Vector4","Vector4"],"Vector4",(function(t,e){return[t[0]+e[0],t[1]+e[1],t[2]+e[2],t[3]+e[3]]})),m("-",["Vector4","Vector4"],"Vector4",(function(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2],t[3]-e[3]]})),m("*",["Vector4","Vector4"],"Vector4",(function(t,e){return[t[0]*e[0],t[1]*e[1],t[2]*e[2],t[3]*e[3]]})),m("/",["Vector4","Vector4"],"Vector4",(function(t,e){return[t[0]/e[0],t[1]/e[1],t[2]/e[2],t[3]/e[3]]})),m("+",["Vector4"],"Vector4",(function(t){return t})),m("-",["Vector4"],"Vector4",(function(t){return[-t[0],-t[1],-t[2],-t[3]]})),m("*",["float","Vector2"],"Vector2",(function(t,e){return[t*e[0],t*e[1]]})),m("*",["Vector2","float"],"Vector2",(function(t,e){return[t[0]*e,t[1]*e]})),m("*",["Vector2","float"],"Vector2",(function(t,e){return[t[0]/e,t[1]/e]})),m("*",["float","Vector3"],"Vector3",(function(t,e){return[t*e[0],t*e[1],t*e[2]]})),m("*",["Vector3","float"],"Vector3",(function(t,e){return[t[0]*e,t[1]*e,t[2]*e]})),m("*",["Vector3","float"],"Vector3",(function(t,e){return[t[0]/e,t[1]/e,t[2]/e]})),m("*",["float","Vector4"],"Vector4",(function(t,e){return[t*e[0],t*e[1],t*e[2],t*e[3]]})),m("*",["Vector4","float"],"Vector4",(function(t,e){return[t[0]*e,t[1]*e,t[2]*e,t[3]*e]})),m("*",["Vector4","float"],"Vector4",(function(t,e){return[t[0]/e,t[1]/e,t[2]/e,t[3]/e]})),m("==",["float","float"],"bool",(function(t,e){return t==e?1:0})),m(">",["float","float"],"bool",(function(t,e){return t>e?1:0})),m("<",["float","float"],"bool",(function(t,e){return t<e?1:0})),m(">=",["float","float"],"bool",(function(t,e){return t>=e?1:0})),m("<=",["float","float"],"bool",(function(t,e){return t<=e?1:0})),m("==",["int","int"],"bool",(function(t,e){return t==e?1:0})),m(">",["int","int"],"bool",(function(t,e){return t>e?1:0})),m("<",["int","int"],"bool",(function(t,e){return t<e?1:0})),m(">=",["int","int"],"bool",(function(t,e){return t>=e?1:0})),m("<=",["int","int"],"bool",(function(t,e){return t<=e?1:0})),m("==",["bool","bool"],"bool",(function(t,e){return t==e?1:0})),m("!",["bool"],"bool",(function(t){return t?0:1})),m("&&",["bool","bool"],"bool",(function(t,e){return t&&e?1:0})),m("||",["bool","bool"],"bool",(function(t,e){return t||e?1:0})),g("Vector2",["float","float"],(function(t,e){return[t,e]})),g("Vector3",["float","float","float"],(function(t,e,n){return[t,e,n]})),g("Vector4",["float","float","float","float"],(function(t,e,n,r){return[t,e,n,r]})),g("Color",["float","float","float","float"],(function(t,e,n,r){return[t,e,n,r]})),g("Quaternion",["float","float","float","float"],(function(t,e,n,r){return[t,e,n,r]})),h("abs",["float"],"float",(function(t){return Math.abs(t)})),h("sqrt",["float"],"float",(function(t){return Math.sqrt(t)})),h("exp",["float"],"float",(function(t){return Math.exp(t)})),h("log",["float"],"float",(function(t){return Math.log(t)})),h("sin",["float"],"float",(function(t){return Math.sin(t)})),h("cos",["float"],"float",(function(t){return Math.cos(t)})),h("tan",["float"],"float",(function(t){return Math.tan(t)})),h("asin",["float"],"float",(function(t){return Math.asin(t)})),h("acos",["float"],"float",(function(t){return Math.acos(t)})),h("atan",["float"],"float",(function(t){return Math.atan(t)})),h("atan2",["float","float"],"float",(function(t,e){return Math.atan2(t,e)})),h("abs",["int"],"int",(function(t){return Math.abs(t)})),h("min",["int","int"],"int",(function(t,e){return Math.min(t,e)})),h("max",["int","int"],"int",(function(t,e){return Math.max(t,e)})),h("min",["float","float"],"float",(function(t,e){return Math.min(t,e)})),h("max",["float","float"],"float",(function(t,e){return Math.max(t,e)})),h("ceil",["float"],"float",(function(t,e){return Math.ceil(t)})),h("floor",["float"],"float",(function(t,e){return Math.floor(t)})),h("mix",["float","float","float"],"float",(function(t,e,n){return t+(e-t)*n})),h("mix",["Vector2","Vector2","float"],"Vector2",null),h("mix",["Vector3","Vector3","float"],"Vector3",null),h("mix",["Vector4","Vector4","float"],"Vector4",null),h("mix",["Color","Color","float"],"Color",null),h("clamp",["float"],"float",(function(t){return Math.max(0,Math.min(1,t))})),h("dot",["Vector2","Vector2"],"float",(function(t,e){return t[0]*e[0]+t[1]*e[1]})),h("dot",["Vector3","Vector3"],"float",(function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]})),h("dot",["Vector4","Vector4"],"float",(function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]})),h("length",["Vector2"],"float",(function(t){return a.Vector2.FromArray(t).normalize().toArray()})),h("length",["Vector3"],"float",(function(t){return a.Vector3.FromArray(t).normalize().toArray()})),h("length",["Vector4"],"float",(function(t){return a.Quaternion.FromArray(t).normalize().toArray()})),h("length",["Quaternion"],"float",(function(t){return a.Quaternion.FromArray(t).normalize().toArray()})),h("normalize",["Vector2"],"Vector2",(function(t){return a.Vector2.FromArray(t).length()})),h("normalize",["Vector3"],"Vector3",(function(t){return a.Vector3.FromArray(t).length()})),h("normalize",["Vector4"],"Vector4",(function(t){return a.Quaternion.FromArray(t).length()})),h("normalize",["Quaternion"],"Quaternion",(function(t){return a.Quaternion.FromArray(t).length()})),h("cross",["Vector3","Vector3"],"Vector3",(function(t,e){return a.Vector3.FromArray(t).cross(a.Vector3.FromArray(e)).toArray()})),h("quat_mul",["Quaternion","Quaternion"],"Quaternion",(function(t,e){return a.Quaternion.FromArray(t).mul(a.Quaternion.FromArray(e)).toArray()})),h("quat_conj",["Quaternion"],"Quaternion",(function(t){return a.Quaternion.FromArray(t).conj().toArray()})),h("quat_slerp",["Quaternion","Quaternion","float"],"Quaternion",(function(t,e,n){return a.Quaternion.Slerp(a.Quaternion.FromArray(t),a.Quaternion.FromArray(e),n).toArray()})),h("quat_rotate",["Quaternion","Vector3"],"Vector3",(function(t,e){return a.Quaternion.FromArray(t).rotate(a.Vector3.FromArray(e)).toArray()})),h("quat_rotation",["Vector3","float"],"Quaternion",(function(t,e){return a.Quaternion.Rotation(a.Vector3.FromArray(t),e).toArray()})),g("Color",["float","float","float","float"],(function(t,e,n,r){return[t,e,n,r]})),g("Color",["float","float","float"],(function(t,e,n){return[t,e,n,1]})),g("Color",["float","float"],(function(t,e){return[t,t,t,e]})),g("Color",["float"],(function(t){return[t,t,t,1]})),h("lab2rgb",["Color"],"Color",(function(t){return t})),h("hcl2rgb",["Color"],"Color",(function(t){return t})),d("bool","int",1,(function(t){return t})),d("int","float",1,(function(t){return t})),h("int",["float"],"int",(function(t){return Math.floor(t)})),h("float",["int"],"float",(function(t){return t})),d("Quaternion","Vector4",0,(function(t){return t})),d("Vector4","Quaternion",0,(function(t){return t})),d("Color","Vector4",0,(function(t){return t})),d("Vector4","Color",0,(function(t){return t})),d("Vector4Array","ColorArray",0,(function(t){return t})),d("ColorArray","Vector4Array",0,(function(t){return t})),d("Vector4Array2D","Image",0,(function(t){return t})),d("Image","Vector4Image",0,(function(t){return t})),p("PI","float",Math.PI),p("SQRT2","float",Math.SQRT2),p("SQRT1_2","float",Math.SQRT1_2),p("RED","Color",[1,0,0,1]),h("array",["FloatArray","float"],"float",f),h("array",["Vector2Array","float"],"Vector2",f),h("array",["Vector3Array","float"],"Vector3",f),h("array",["Vector4Array","float"],"Vector4",f),h("array",["ColorArray","float"],"Color",f),h("image",["Image","Vector2"],"Color",f),h("image",["Vector4Image","Vector2"],"Vector4",f),h("image",["Vector3Image","Vector2"],"Vector3",f),h("image",["Vector2Image","Vector2"],"Vector2",f),h("image",["FloatImage","Vector2"],"float",f)},{"../math/math":18,"../utils/utils":26}],13:[function(t,e,n){"use strict";var r=t("../compiler/parser"),a=t("../utils/utils"),o=new a.Dictionary;function i(t,e){var n=null;o.has(t)?n=o.get(t):(n=new a.Dictionary,o.set(t,n));for(var i=0,s=r.parseFile(e).blocks;i<s.length;i++){var u=s[i];if("function"==u.type){var c=u;n.set(c.name,c)}}}i("P2D",t("./primitives2d").primitives),i("P3D",t("./primitives3d").primitives),n.getModule=function(t){return o.get(t)},n.getModuleFunction=function(t,e){return o.get(t).get(e)},n.forEachModuleFunction=function(t,e){return o.get(t).forEach(e)}},{"../compiler/parser":8,"../utils/utils":26,"./primitives2d":14,"./primitives3d":15}],14:[function(t,e,n){"use strict";n.primitives="\n    mark Triangle(\n        p1: Vector2,\n        p2: Vector2,\n        p3: Vector2,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        emit [\n            { position: p1, color: color },\n            { position: p2, color: color },\n            { position: p3, color: color }\n        ];\n    }\n\n    mark Rectangle(\n        p1: Vector2,\n        p2: Vector2,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        emit [\n            { position: Vector2(p1.x, p1.y), color: color },\n            { position: Vector2(p2.x, p1.y), color: color },\n            { position: Vector2(p2.x, p2.y), color: color }\n        ];\n        emit [\n            { position: Vector2(p1.x, p1.y), color: color },\n            { position: Vector2(p1.x, p2.y), color: color },\n            { position: Vector2(p2.x, p2.y), color: color }\n        ];\n    }\n\n    mark OutlinedRectangle(\n        p1: Vector2,\n        p2: Vector2,\n        width: float = 1,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        Rectangle(p1, Vector2(p1.x + width, p2.y - width), color);\n        Rectangle(Vector2(p1.x, p2.y - width), Vector2(p2.x - width, p2.y), color);\n        Rectangle(Vector2(p1.x + width, p1.y), Vector2(p2.x, p1.y + width), color);\n        Rectangle(Vector2(p2.x - width, p1.y + width), p2, color);\n    }\n\n    mark Hexagon(\n        center: Vector2,\n        radius: float,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        for(i in 0..5) {\n            let a1 = i / 6.0 * PI * 2.0;\n            let a2 = (i + 1) / 6.0 * PI * 2.0;\n            let p1 = Vector2(radius * cos(a1), radius * sin(a1));\n            let p2 = Vector2(radius * cos(a2), radius * sin(a2));\n            emit [\n                { position: center + p1, color: color },\n                { position: center, color: color },\n                { position: center + p2, color: color }\n            ];\n        }\n    }\n\n    mark Circle16(\n        center: Vector2,\n        radius: float,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        for(i in 0..15) {\n            let a1 = i / 16.0 * PI * 2.0;\n            let a2 = (i + 1) / 16.0 * PI * 2.0;\n            let p1 = Vector2(radius * cos(a1), radius * sin(a1));\n            let p2 = Vector2(radius * cos(a2), radius * sin(a2));\n            emit [\n                { position: center + p1, color: color },\n                { position: center, color: color },\n                { position: center + p2, color: color }\n            ];\n        }\n    }\n\n    mark Circle(\n        center: Vector2,\n        radius: float,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        for(i in 0..31) {\n            let a1 = i / 32.0 * PI * 2.0;\n            let a2 = (i + 1) / 32.0 * PI * 2.0;\n            let p1 = Vector2(radius * cos(a1), radius * sin(a1));\n            let p2 = Vector2(radius * cos(a2), radius * sin(a2));\n            emit [\n                { position: center + p1, color: color },\n                { position: center, color: color },\n                { position: center + p2, color: color }\n            ];\n        }\n    }\n\n    mark Line(\n        p1: Vector2,\n        p2: Vector2,\n        width: float = 1,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        let d = normalize(p2 - p1);\n        let t = Vector2(d.y, -d.x) * (width / 2);\n        emit [\n            { position: p1 + t, color: color },\n            { position: p1 - t, color: color },\n            { position: p2 + t, color: color }\n        ];\n        emit [\n            { position: p1 - t, color: color },\n            { position: p2 - t, color: color },\n            { position: p2 + t, color: color }\n        ];\n    }\n\n    mark Sector2(\n        c: Vector2,\n        p1: Vector2,\n        p2: Vector2,\n        color: Color\n    ) {\n        let pc = c + normalize(p1 + p2 - c - c) * length(p1 - c);\n        Triangle(c, p1, pc, color);\n        Triangle(c, pc, p2, color);\n    }\n\n    mark Sector4(\n        c: Vector2,\n        p1: Vector2,\n        p2: Vector2,\n        color: Color\n    ) {\n        let pc = c + normalize(p1 + p2 - c - c) * length(p1 - c);\n        Sector2(c, p1, pc, color);\n        Sector2(c, pc, p2, color);\n    }\n\n    mark Polyline(\n        p: Vector2, p_p: Vector2, p_n: Vector2, p_nn: Vector2,\n        width: float,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        let EPS = 1e-5;\n        let w = width / 2;\n        let d = normalize(p - p_n);\n        let n = Vector2(d.y, -d.x);\n        let m1: Vector2;\n        if(length(p - p_p) < EPS) {\n            m1 = n * w;\n        } else {\n            m1 = normalize(d + normalize(p - p_p)) * w;\n        }\n        let m2: Vector2;\n        if(length(p_n - p_nn) < EPS) {\n            m2 = -n * w;\n        } else {\n            m2 = normalize(normalize(p_n - p_nn) - d) * w;\n        }\n        let c1a: Vector2;\n        let c1b: Vector2;\n        let a1: Vector2;\n        let a2: Vector2;\n        if(dot(m1, n) > 0) {\n            c1a = p + m1;\n            c1b = p + n * w;\n            a2 = c1b;\n            a1 = p - m1 * (w / dot(m1, n));\n        } else {\n            c1a = p + m1;\n            c1b = p - n * w;\n            a2 = p + m1 * (w / dot(m1, n));\n            a1 = c1b;\n        }\n        let c2a: Vector2;\n        let c2b: Vector2;\n        let b1: Vector2;\n        let b2: Vector2;\n        if(dot(m2, n) < 0) {\n            c2a = p_n + m2;\n            c2b = p_n - n * w;\n            b1 = c2b;\n            b2 = p_n + m2 * (w / dot(m2, n));\n        } else {\n            c2a = p_n + m2;\n            c2b = p_n + n * w;\n            b2 = c2b;\n            b1 = p_n - m2 * (w / dot(m2, n));\n        }\n        emit [\n            { position: p, color: color },\n            { position: c1a, color: color },\n            { position: c1b, color: color }\n        ];\n        emit [\n            { position: p_n, color: color },\n            { position: c2a, color: color },\n            { position: c2b, color: color }\n        ];\n        emit [\n            { position: p, color: color },\n            { position: a1, color: color },\n            { position: b1, color: color }\n        ];\n        emit [\n            { position: p, color: color },\n            { position: b1, color: color },\n            { position: p_n, color: color }\n        ];\n        emit [\n            { position: p, color: color },\n            { position: a2, color: color },\n            { position: b2, color: color }\n        ];\n        emit [\n            { position: p, color: color },\n            { position: b2, color: color },\n            { position: p_n, color: color }\n        ];\n    }\n\n    mark Wedge(\n        p1: Vector2 = [ 0, 0 ],\n        theta1: float = 0,\n        theta2: float = 0,\n        length: float = 10,\n        width: float = 1,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        let dTheta = (theta2 - theta1) / 60;\n        let dL = length / 60;\n        for(i in 0..59) {\n            let dThetaA = i * dTheta;\n            let dThetaB = (i + 1) * dTheta;\n            let thetaA = theta1 + dThetaA;\n            let thetaB = theta1 + dThetaB;\n            let thetaCenterA = theta1 + dThetaA / 2;\n            let thetaCenterB = theta1 + dThetaB / 2;\n            let dlA = dL * i;\n            let dlB = dL * (i + 1);\n            if(dThetaA > 1e-5 || dThetaA < -1e-5) {\n                dlA = dlA / dThetaA * 2 * sin(dThetaA / 2);\n            }\n            if(dThetaB > 1e-5 || dThetaB < -1e-5) {\n                dlB = dlB / dThetaB * 2 * sin(dThetaB / 2);\n            }\n            let pAdvA = Vector2(-sin(thetaCenterA), cos(thetaCenterA)) * dlA;\n            let pAdvB = Vector2(-sin(thetaCenterB), cos(thetaCenterB)) * dlB;\n            let pA = p1 + pAdvA;\n            let pB = p1 + pAdvB;\n\n            let dpA = Vector2(cos(thetaA), sin(thetaA)) * width * 0.5;\n            let dpB = Vector2(cos(thetaB), sin(thetaB)) * width * 0.5;\n\n            Triangle(pA + dpA, pB + dpB, pB - dpB, color);\n            Triangle(pA + dpA, pB - dpB, pA - dpA, color);\n        }\n    }\n"},{}],15:[function(t,e,n){"use strict";n.primitives="\n    mark Triangle(\n        p1: Vector3,\n        p2: Vector3,\n        p3: Vector3,\n        color: Color = [ 0, 0, 0, 1 ]\n    ) {\n        let normal = normalize(cross(p2 - p1, p3 - p1));\n        emit [\n            { position: p1, color: color, normal: normal },\n            { position: p2, color: color, normal: normal },\n            { position: p3, color: color, normal: normal }\n        ];\n    }\n\n    mark Tetrahedron(\n        p1: Vector3,\n        p2: Vector3,\n        p3: Vector3,\n        p4: Vector3\n    ) {\n        Triangle(p3, p4, p1);\n        Triangle(p1, p4, p2);\n        Triangle(p1, p2, p3);\n        Triangle(p2, p3, p4);\n    }\n\n    mark Cube(\n        center: Vector3,\n        radius: float,\n        color: Color\n    ) {\n        let p000 = Vector3(center.x - radius, center.y - radius, center.z - radius);\n        let p001 = Vector3(center.x - radius, center.y - radius, center.z + radius);\n        let p010 = Vector3(center.x - radius, center.y + radius, center.z - radius);\n        let p011 = Vector3(center.x - radius, center.y + radius, center.z + radius);\n        let p100 = Vector3(center.x + radius, center.y - radius, center.z - radius);\n        let p101 = Vector3(center.x + radius, center.y - radius, center.z + radius);\n        let p110 = Vector3(center.x + radius, center.y + radius, center.z - radius);\n        let p111 = Vector3(center.x + radius, center.y + radius, center.z + radius);\n        let nx = Vector3(1, 0, 0);\n        let ny = Vector3(0, 1, 0);\n        let nz = Vector3(0, 0, 1);\n        emit [ { position: p000, color: color, normal: nz }, { position: p110, color: color, normal: nz }, { position: p100, color: color, normal: nz } ];\n        emit [ { position: p000, color: color, normal: nz }, { position: p010, color: color, normal: nz }, { position: p110, color: color, normal: nz } ];\n        emit [ { position: p001, color: color, normal: nz }, { position: p101, color: color, normal: nz }, { position: p111, color: color, normal: nz } ];\n        emit [ { position: p001, color: color, normal: nz }, { position: p111, color: color, normal: nz }, { position: p011, color: color, normal: nz } ];\n        emit [ { position: p000, color: color, normal: ny }, { position: p100, color: color, normal: ny }, { position: p101, color: color, normal: ny } ];\n        emit [ { position: p000, color: color, normal: ny }, { position: p101, color: color, normal: ny }, { position: p001, color: color, normal: ny } ];\n        emit [ { position: p010, color: color, normal: ny }, { position: p111, color: color, normal: ny }, { position: p110, color: color, normal: ny } ];\n        emit [ { position: p010, color: color, normal: ny }, { position: p011, color: color, normal: ny }, { position: p111, color: color, normal: ny } ];\n        emit [ { position: p000, color: color, normal: nx }, { position: p001, color: color, normal: nx }, { position: p011, color: color, normal: nx } ];\n        emit [ { position: p000, color: color, normal: nx }, { position: p011, color: color, normal: nx }, { position: p010, color: color, normal: nx } ];\n        emit [ { position: p100, color: color, normal: nx }, { position: p101, color: color, normal: nx }, { position: p111, color: color, normal: nx } ];\n        emit [ { position: p100, color: color, normal: nx }, { position: p111, color: color, normal: nx }, { position: p110, color: color, normal: nx } ];\n    }\n"},{}],16:[function(t,e,n){"use strict";var r=t("../binding/binding"),a=t("../exceptions"),o=t("../utils/utils"),i=t("../scale/scale"),s=[{shift:-2,suffix:"_pp"},{shift:-1,suffix:"_p"},{shift:1,suffix:"_n"},{shift:2,suffix:"_nn"}],u=function(){function t(t,e,n){for(var a in this._spec=t,this._shader=e,this._data=[],this._platform=n,this._bindings=new o.Dictionary,this._shiftBindings=new o.Dictionary,this._platformMark=null,this._shouldUploadData=!0,this._instanceFunctions=null,this._spec.input)if(this._spec.input.hasOwnProperty(a)){var i=this._spec.input[a];null!=i.default&&this._bindings.set(a,new r.Binding(i.type,i.default))}for(var u in this._spec.input)if(this._spec.input.hasOwnProperty(u))for(var c=0,l=s;c<l.length;c++){var p=l[c],d=p.shift,h=p.suffix;this._spec.input.hasOwnProperty(u+h)&&this._shiftBindings.set(u+h,new r.ShiftBinding(u,d))}}return Object.defineProperty(t.prototype,"spec",{get:function(){return this._spec},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shader",{get:function(){return this._shader},enumerable:!0,configurable:!0}),t.prototype.attr=function(t,e){if(void 0===e){if(!this._bindings.has(t))throw new a.RuntimeError("attr '"+t+" is undefined.");var n=this._bindings.get(t);return n instanceof r.Binding?n.value:n}if(!this._spec.input.hasOwnProperty(t))throw new a.RuntimeError("attr '"+t+" is undefined.");if(e instanceof i.ScaleBinding)this._platformMark&&this._bindings.get(t)!=e&&(this._platformMark=null),this._bindings.set(t,e);else{var o=new r.Binding(this._spec.input[t].type,e);this._platformMark&&(this._platformMark.isUniform(t)&&o.bindingType!=r.BindingType.FUNCTION?(o.bindingType==r.BindingType.VALUE&&this._platformMark.updateUniform(t,o.specValue),o.bindingType==r.BindingType.TEXTURE&&this._platformMark.updateTexture(t,o.textureValue)):this._platformMark=null),this._bindings.set(t,o)}return this},t.prototype.data=function(t){return void 0===t?this._data:(this._data=t.slice(),this._shouldUploadData=!0,this)},t.prototype.instance=function(t,e){if(void 0===t&&void 0===e)return this._instanceFunctions;this._instanceFunctions={datum:t,attrs:e}},t.prototype.prepareSpecification=function(){var t={input:o.shallowClone(this._spec.input),output:this._spec.output,statements:this._spec.statements.slice(),variables:o.shallowClone(this._spec.variables),repeatBegin:this._spec.repeatBegin,repeatEnd:this._spec.repeatEnd},e=this._bindings.clone(),n=this._shiftBindings.clone();return this._bindings.forEach((function(a,o){if(a instanceof i.ScaleBinding){var u=a.getAttributes(),c={};u.forEach((function(n){var a=o+n.bindedName;e.set(a,new r.Binding(n.type,n.binding)),c[n.bindedName]={type:"variable",valueType:n.type,variableName:a},t.input[a]={type:n.type,default:null}})),t.variables[o]=t.input[o].type,t.statements.splice(0,0,{type:"assign",variableName:o,expression:a.getExpression(c),valueType:t.input[o].type});for(var l=function(i,s){if(t.input.hasOwnProperty(o+i)){t.variables[o+i]=t.input[o].type;var c={};u.forEach((function(a){var u=o+a.bindedName;if(e.get(u).bindingType==r.BindingType.FUNCTION){var l=u+i;n.set(l,new r.ShiftBinding(u,s)),c[a.bindedName]={type:"variable",valueType:a.type,variableName:l},t.input[l]={type:a.type,default:null}}else c[a.bindedName]={type:"variable",valueType:a.type,variableName:u}})),t.statements.splice(0,0,{type:"assign",variableName:o+i,expression:a.getExpression(c),valueType:t.input[o].type})}},p=0,d=s;p<d.length;p++){var h=d[p];l(g=h.suffix,h.shift)}delete t.input[o],e.delete(o);for(var m=0,f=s;m<f.length;m++){var g=f[m].suffix;n.has(o+g)&&(delete t.input[o+g],n.delete(o+g))}}})),[t,e,n]},t.prototype.uploadScaleUniforms=function(){var t=this;this._bindings.forEach((function(e,n){e instanceof i.ScaleBinding&&e.getAttributes().forEach((function(e){e.binding instanceof r.TextureBinding?t._platformMark.updateTexture(n+e.bindedName,e.binding):t._platformMark.updateUniform(n+e.bindedName,e.binding)}))}))},t.prototype.prepare=function(){var t=this;if(!this._platformMark){var e=this.prepareSpecification(),n=e[0],r=e[1],a=e[2];this._platformMark=this._platform.compile(this,n,this._shader,r,a),this._shouldUploadData=!0}if(this._shouldUploadData){if(null==this._instanceFunctions)this._platformMarkData=this._platformMark.uploadData([this._data]);else{var o=[];this._data.forEach((function(e,n){var r=t._instanceFunctions.datum(e,n,t._data);o.push(r)})),this._platformMarkData=this._platformMark.uploadData(o)}this._shouldUploadData=!1}return this},t.prototype.render=function(){var t=this;return this.prepare(),null==this._instanceFunctions?this._platformMark.render(this._platformMarkData,(function(){t.uploadScaleUniforms()})):this._platformMark.render(this._platformMarkData,(function(e){var n=t._data[e];if(t._instanceFunctions.attrs){var a=t._instanceFunctions.attrs(n,e,t._data);if(null!=a)for(var o in a)a.hasOwnProperty(o)&&t._platformMark.updateUniform(o,r.getBindingValue(a[o]))}t.uploadScaleUniforms()})),this},t}();n.Mark=u},{"../binding/binding":3,"../exceptions":11,"../scale/scale":20,"../utils/utils":26}],17:[function(t,e,n){"use strict";var r,a=t("../compiler/compiler"),o=t("../compiler/declare"),i=t("./mark"),s=t("../platform/platform");!function(t){t.create=function(t,e,n){if(e instanceof s.Platform){var a=r.basic();return t instanceof o.CustomMark?new i.Mark(t.compile(),a,e):new i.Mark(t,a,e)}return a=e,t instanceof o.CustomMark?new i.Mark(t.compile(),a,n):new i.Mark(t,a,n)},t.custom=function(){return new o.CustomMark},t.compile=function(t){return a.compileString(t)},t.circle=function(e){return void 0===e&&(e=32),t.compile("\n            mark Circle(\n                center: Vector2 = [ 0, 0 ],\n                radius: float = 1,\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                for(i in 0.."+(e-1)+") {\n                    let a1 = i / "+e.toFixed(1)+" * PI * 2.0;\n                    let a2 = (i + 1) / "+e.toFixed(1)+" * PI * 2.0;\n                    let p1 = Vector2(radius * cos(a1), radius * sin(a1));\n                    let p2 = Vector2(radius * cos(a2), radius * sin(a2));\n                    emit [\n                        { position: center + p1, color: color },\n                        { position: center, color: color },\n                        { position: center + p2, color: color }\n                    ];\n                }\n            }\n        ").Circle},t.rect=function(){return t.compile("\n            mark Rectangle(\n                p1: Vector2 = [ 0, 0 ],\n                p2: Vector2 = [ 0, 0 ],\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                emit [\n                    { position: Vector2(p1.x, p1.y), color: color },\n                    { position: Vector2(p2.x, p1.y), color: color },\n                    { position: Vector2(p2.x, p2.y), color: color }\n                ];\n                emit [\n                    { position: Vector2(p1.x, p1.y), color: color },\n                    { position: Vector2(p1.x, p2.y), color: color },\n                    { position: Vector2(p2.x, p2.y), color: color }\n                ];\n            }\n        ").Rectangle},t.line=function(){return t.compile("\n            mark Line(\n                p1: Vector2 = [ 0, 0 ],\n                p2: Vector2 = [ 0, 0 ],\n                width: float = 1,\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                let d = normalize(p2 - p1);\n                let t = Vector2(d.y, -d.x) * (width / 2);\n                emit [\n                    { position: p1 + t, color: color },\n                    { position: p1 - t, color: color },\n                    { position: p2 + t, color: color }\n                ];\n                emit [\n                    { position: p1 - t, color: color },\n                    { position: p2 - t, color: color },\n                    { position: p2 + t, color: color }\n                ];\n            }\n        ").Line},t.wedge=function(e){return void 0===e&&(e=60),t.compile("\n            import { Triangle } from P2D;\n\n            mark Wedge(\n                p1: Vector2 = [ 0, 0 ],\n                theta1: float = 0,\n                theta2: float = 0,\n                length: float = 10,\n                width: float = 1,\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                let dTheta = (theta2 - theta1) / 60;\n                let dL = length / 60;\n                for(i in 0..59) {\n                    let dThetaA = i * dTheta;\n                    let dThetaB = (i + 1) * dTheta;\n                    let thetaA = theta1 + dThetaA;\n                    let thetaB = theta1 + dThetaB;\n                    let thetaCenterA = theta1 + dThetaA / 2;\n                    let thetaCenterB = theta1 + dThetaB / 2;\n                    let dlA = dL * i;\n                    let dlB = dL * (i + 1);\n                    if(dThetaA > 1e-5 || dThetaA < -1e-5) {\n                        dlA = dlA / dThetaA * 2 * sin(dThetaA / 2);\n                    }\n                    if(dThetaB > 1e-5 || dThetaB < -1e-5) {\n                        dlB = dlB / dThetaB * 2 * sin(dThetaB / 2);\n                    }\n                    let pAdvA = Vector2(-sin(thetaCenterA), cos(thetaCenterA)) * dlA;\n                    let pAdvB = Vector2(-sin(thetaCenterB), cos(thetaCenterB)) * dlB;\n                    let pA = p1 + pAdvA;\n                    let pB = p1 + pAdvB;\n\n                    let dpA = Vector2(cos(thetaA), sin(thetaA)) * width * 0.5;\n                    let dpB = Vector2(cos(thetaB), sin(thetaB)) * width * 0.5;\n\n                    Triangle(pA + dpA, pB + dpB, pB - dpB, color);\n                    Triangle(pA + dpA, pB - dpB, pA - dpA, color);\n                }\n            }\n        ").Wedge},t.polyline=function(){var e=t.compile("\n            import { Triangle } from P2D;\n\n            mark Sector2(\n                c: Vector2,\n                p1: Vector2,\n                p2: Vector2,\n                color: Color\n            ) {\n                let pc = c + normalize(p1 + p2 - c - c) * length(p1 - c);\n                Triangle(c, p1, pc, color);\n                Triangle(c, pc, p2, color);\n            }\n\n            mark Sector4(\n                c: Vector2,\n                p1: Vector2,\n                p2: Vector2,\n                color: Color\n            ) {\n                let pc = c + normalize(p1 + p2 - c - c) * length(p1 - c);\n                Sector2(c, p1, pc, color);\n                Sector2(c, pc, p2, color);\n            }\n\n            mark PolylineRound(\n                p: Vector2, p_p: Vector2, p_n: Vector2, p_nn: Vector2,\n                width: float = 1,\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                let EPS = 1e-5;\n                let w = width / 2;\n                let d = normalize(p - p_n);\n                let n = Vector2(d.y, -d.x);\n                let m1: Vector2;\n                if(length(p - p_p) < EPS) {\n                    m1 = n * w;\n                } else {\n                    m1 = normalize(d + normalize(p - p_p)) * w;\n                }\n                let m2: Vector2;\n                if(length(p_n - p_nn) < EPS) {\n                    m2 = -n * w;\n                } else {\n                    m2 = normalize(normalize(p_n - p_nn) - d) * w;\n                }\n                let c1a: Vector2;\n                let c1b: Vector2;\n                let a1: Vector2;\n                let a2: Vector2;\n                if(dot(m1, n) > 0) {\n                    c1a = p + m1;\n                    c1b = p + n * w;\n                    a2 = c1b;\n                    a1 = p - m1 * (w / dot(m1, n));\n                } else {\n                    c1a = p + m1;\n                    c1b = p - n * w;\n                    a2 = p + m1 * (w / dot(m1, n));\n                    a1 = c1b;\n                }\n                let c2a: Vector2;\n                let c2b: Vector2;\n                let b1: Vector2;\n                let b2: Vector2;\n                if(dot(m2, n) < 0) {\n                    c2a = p_n + m2;\n                    c2b = p_n - n * w;\n                    b1 = c2b;\n                    b2 = p_n + m2 * (w / dot(m2, n));\n                } else {\n                    c2a = p_n + m2;\n                    c2b = p_n + n * w;\n                    b2 = c2b;\n                    b1 = p_n - m2 * (w / dot(m2, n));\n                }\n                Sector4(p, c1a, c1b, color);\n                Sector4(p_n, c2a, c2b, color);\n                Triangle(p, a1, b1, color);\n                Triangle(p, b1, p_n, color);\n                Triangle(p, a2, b2, color);\n                Triangle(p, b2, p_n, color);\n            }\n        ").PolylineRound;return e.repeatBegin=1,e.repeatEnd=1,e}}(n.mark||(n.mark={})),function(t){t.compile=function(t){return a.compileString(t)},t.basic=function(){return t.compile("\n            shader Default(\n                color: Color = [ 0, 0, 0, 1 ]\n            ) {\n                emit { color: color };\n            }\n        ").Default},t.lighting=function(){return t.compile("\n            shader Default(\n                color: Color = [ 0, 0, 0, 1 ],\n                normal: Vector3,\n                position: Vector3\n            ) {\n                let lighting = normalize(position);\n                let NdotL = abs(dot(normal, lighting));\n                let s = NdotL * 0.5 + 0.5;\n                emit { color: Color(s * color.r, s * color.g, s * color.b, color.a) };\n            }\n        ").Default}}(r=n.shader||(n.shader={}))},{"../compiler/compiler":6,"../compiler/declare":7,"../platform/platform":19,"./mark":16}],18:[function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=function(){};n.MathType=a;var o=function(t){function e(e,n){void 0===e&&(e=0),void 0===n&&(n=0),t.call(this),this.x=e,this.y=n}return r(e,t),e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.scale=function(t){return new e(this.x*t,this.y*t)},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return new i(this.x/t,this.y/t)},e.prototype.toArray=function(){return[this.x,this.y]},e.FromArray=function(t){return new e(t[0],t[1])},e}(a);n.Vector2=o;var i=function(t){function e(e,n,r){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),t.call(this),this.x=e,this.y=n,this.z=r}return r(e,t),e.prototype.clone=function(){return new e(this.x,this.y,this.z)},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y,this.z*t.z)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y,this.z/t.z)},e.prototype.scale=function(t){return new e(this.x*t,this.y*t,this.z*t)},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},e.prototype.cross=function(t){return new e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},e.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return new e(this.x/t,this.y/t,this.z/t)},e.prototype.toArray=function(){return[this.x,this.y,this.z]},e.FromArray=function(t){return new e(t[0],t[1],t[2])},e}(a);n.Vector3=i;var s=function(t){function e(e,n,r,a){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),t.call(this),this.x=e,this.y=n,this.z=r,this.w=a}return r(e,t),e.prototype.clone=function(){return new e(this.x,this.y,this.z,this.w)},e.prototype.conj=function(){return new e(-this.x,-this.y,-this.z,this.w)},e.prototype.mul=function(t){return new e(t.x*this.w+this.x*t.w+this.y*t.z-this.z*t.y,t.y*this.w+this.y*t.w+this.z*t.x-this.x*t.z,t.z*this.w+this.z*t.w+this.x*t.y-this.y*t.x,this.w*t.w-this.x*t.x-this.y*t.y-this.z*t.z)},e.prototype.rotate=function(t){var n=new e(t.x,t.y,t.z,0),r=this.mul(n).mul(this.conj());return new i(r.x,r.y,r.z)},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.w*this.w)},e.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.w*this.w);return new e(this.x/t,this.y/t,this.z/t,this.w/t)},e.prototype.slerp=function(t,n){return e.Slerp(this,t,n)},e.Slerp=function(t,n,r){var a=t.x*n.x+t.y*n.y+t.z*n.z+t.w*n.w;a>1&&(a=1),a<-1&&(a=-1);var o,i,s=Math.acos(a);if(Math.abs(s)<1e-10)o=1-r,i=r;else{var u=Math.sin(s);o=Math.sin((1-r)*s)/u,i=Math.sin(r*s)/u}return new e(t.x*o+n.x*i,t.y*o+n.y*i,t.z*o+n.z*i,t.w*o+n.w*i)},e.Rotation=function(t,n){var r=t.normalize().scale(Math.sin(n/2));return new e(r.x,r.y,r.z,Math.cos(n/2))},e.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},e.FromArray=function(t){return new e(t[0],t[1],t[2],t[3])},e}(a);n.Quaternion=s;var u=function(t,e){void 0===t&&(t=new i(0,0,0)),void 0===e&&(e=new s(0,0,0,1)),this.position=t,this.rotation=e};n.Pose=u},{}],19:[function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("../utils/utils"),o=function(){};n.PlatformMarkData=o;var i=function(){};n.PlatformMark=i;var s=function(){};n.Viewport=s;var u=function(t){function e(e,n){t.call(this),this.width=e,this.height=n}return r(e,t),e}(s);n.Viewport2D=u;var c=function(t){function e(e,n,r){t.call(this),this.width=e,this.height=n,this.fov=r}return r(e,t),e}(s);n.Viewport3D=c;var l=function(){};n.Platform=l;var p=new a.Dictionary;n.registerPlatformConstructor=function(t,e){p.set(t,e)},n.platform=function(t){console.log("log in stardust");for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return p.get(t).apply(void 0,e)}},{"../utils/utils":26}],20:[function(t,e,n){"use strict";var r=function(){function t(t,e,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];this._scale=t,this._returnType=e,this._argTypes=n,this._args=r}return t.prototype.getReturnType=function(){return this._returnType},t.prototype.getAttributes=function(){for(var e=this,n=[],r=0,a=this._scale.getAttributes();r<a.length;r++){var o=a[r];n.push({scaleBinding:this,bindedName:"s"+o.name,name:o.name,type:o.type,binding:o.binding})}return this._args.forEach((function(r,a){if(r instanceof t)for(var o=0,i=r.getAttributes();o<i.length;o++){var s=i[o];n.push({scaleBinding:e,bindedName:"a"+a+s.bindedName,name:s.name,type:s.type,binding:s.binding})}else n.push({scaleBinding:e,bindedName:"a"+a,name:"a"+a,type:e._argTypes[a],binding:r})})),n},t.prototype.getExpression=function(e){for(var n={},r=0,a=this._scale.getAttributes();r<a.length;r++){var o=a[r];n[o.name]=e["s"+o.name]}var i,s=this._args.map((function(n,r){if(n instanceof t){for(var a={},o=0,i=n.getAttributes();o<i.length;o++){var s=i[o];a[s.bindedName]=e["a"+r+s.bindedName]}return n.getExpression(a)}return e["a"+r]}));return(i=this._scale).getExpression.apply(i,[n].concat(s))},t}();n.ScaleBinding=r},{}],21:[function(t,e,n){"use strict";var r=t("../utils/utils"),a=t("../compiler/compiler"),o=t("../compiler/parser"),i=t("./scale"),s=t("../spec/construct");!function(t){function e(){var t=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return new(i.ScaleBinding.bind.apply(i.ScaleBinding,[void 0].concat([t,"float",["float","float"]],e)))};return t.getAttributes=function(){return[]},t.getExpression=function(t,e,n){return s.add(e,n)},t}function n(){var t=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return new(i.ScaleBinding.bind.apply(i.ScaleBinding,[void 0].concat([t,"float",["float","float"]],e)))};return t.getAttributes=function(){return[]},t.getExpression=function(t,e,n){return s.sub(e,n)},t}function u(){var t=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return new(i.ScaleBinding.bind.apply(i.ScaleBinding,[void 0].concat([t,"float",["float","float"]],e)))};return t.getAttributes=function(){return[]},t.getExpression=function(t,e,n){return s.mul(e,n)},t}function c(){var t=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return new(i.ScaleBinding.bind.apply(i.ScaleBinding,[void 0].concat([t,"float",["float","float"]],e)))};return t.getAttributes=function(){return[]},t.getExpression=function(t,e,n){return s.div(e,n)},t}function l(){var t=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return new(i.ScaleBinding.bind.apply(i.ScaleBinding,[void 0].concat([t,"Vector2",["float","float"]],e)))};return t.getAttributes=function(){return[]},t.getExpression=function(t,e,n){return s.func("Vector2","Vector2",e,n)},t}t.linear=function(t){void 0===t&&(t="float");var e=function(){for(var n=[],r=0;r<arguments.length;r++)n[r-0]=arguments[r];return new(i.ScaleBinding.bind.apply(i.ScaleBinding,[void 0].concat([e,t,["float"]],n)))},n=[0,1],r=[0,1];return e.domain=function(t){return null==t?n:(n[0]=t[0],n[1]=t[1],e)},e.range=function(t){return null==t?r:(r[0]=t[0],r[1]=t[1],e)},e.getAttributes=function(){return[{name:"d0",type:t,binding:n[0]},{name:"d1",type:t,binding:n[1]},{name:"r0",type:t,binding:r[0]},{name:"r1",type:t,binding:r[1]}]},e.getExpression=function(t,e){return s.mix(t.r0,t.r1,s.div(s.sub(e,t.d0),s.sub(t.d1,t.d0)))},e},t.log=function(t){void 0===t&&(t="float");var e=function(){for(var n=[],r=0;r<arguments.length;r++)n[r-0]=arguments[r];return new(i.ScaleBinding.bind.apply(i.ScaleBinding,[void 0].concat([e,t,["float"]],n)))},n=[0,1],r=[0,1];return e.domain=function(t){return null==t?n:(n[0]=t[0],n[1]=t[1],e)},e.range=function(t){return null==t?r:(r[0]=t[0],r[1]=t[1],e)},e.getAttributes=function(){return[{name:"d0",type:t,binding:n[0]},{name:"d1",type:t,binding:n[1]},{name:"r0",type:t,binding:r[0]},{name:"r1",type:t,binding:r[1]}]},e.getExpression=function(t,e){return s.mix(t.r0,t.r1,s.div(s.log(s.div(e,t.d0)),s.log(s.div(t.d1,t.d0))))},e},t.addScale=e,t.subScale=n,t.mulScale=u,t.divScale=c,t.vector2Scale=l,t.add=function(t,n){return e()(t,n)},t.sub=function(t,e){return n()(t,e)},t.mul=function(t,e){return u()(t,e)},t.div=function(t,e){return c()(t,e)},t.interpolate=function(t){void 0===t&&(t="float");var e,n=function(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];return new(i.ScaleBinding.bind.apply(i.ScaleBinding,[void 0].concat([n,t,[t,t]],e)))};return n.t=function(t){return null==t?e:(e=t,n)},n.getAttributes=function(){return[{name:"t",type:"float",binding:e}]},n.getExpression=function(t,e,n){return s.mix(e,n,t.t)},n},t.Vector2=function(t,e){return l()(t,e)},t.custom=function(t){var e=o.parseExpression(t),n=function(){for(var t=[],o=0;o<arguments.length;o++)t[o-0]=arguments[o];var u=new r.Dictionary;s.forEach((function(t,e){u.set(e,{type:"constant",valueType:t.type,value:null})})),u.set("value",{type:"constant",valueType:"float",value:null});var c=a.compileExpression(e,u);return new(i.ScaleBinding.bind.apply(i.ScaleBinding,[void 0].concat([n,c.valueType,["float"]],t)))},s=new r.Dictionary;return n.attr=function(t,e,r){return null==e&&null==r?s.get(t).value:"string"==typeof e?(s.set(t,{type:e,value:r}),n):(s.set(t,{type:"float",value:e}),n)},n.getAttributes=function(){var t=[];return s.forEach((function(e,n){t.push({name:n,type:e.type,binding:e.value})})),t},n.getExpression=function(t,n){var o=new r.Dictionary;for(var i in t)t.hasOwnProperty(i)&&o.set(i,t[i]);return o.set("value",n),a.compileExpression(e,o)},n}}(n.scale||(n.scale={}))},{"../compiler/compiler":6,"../compiler/parser":8,"../spec/construct":22,"../utils/utils":26,"./scale":20}],22:[function(t,e,n){"use strict";var r=t("../intrinsics/intrinsics");function a(t,e){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return{type:"function",functionName:r.getInternalName({name:t,argTypes:n.map((function(t){return t.valueType})),returnType:e}),arguments:n,valueType:e}}function o(t,e){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return{type:"function",functionName:r.getInternalName({name:"@"+t,argTypes:n.map((function(t){return t.valueType})),returnType:e}),valueType:e,arguments:n}}n.func=a,n.op=o,n.cast=function(t,e){return{type:"function",functionName:r.getInternalName({name:"cast:"+t.valueType+":"+e,argTypes:[t.valueType],returnType:e}),valueType:e,arguments:[t]}},n.variable=function(t,e){return{type:"variable",variableName:t,valueType:e}},n.constant=function(t,e){return{type:"constant",value:t,valueType:e}},n.mix=function(t,e,n){return a("mix",t.valueType,t,e,n)},n.exp=function(t){return a("exp","float",t)},n.log=function(t){return a("log","float",t)},n.add=function(t,e){return o("+",t.valueType,t,e)},n.sub=function(t,e){return o("-",t.valueType,t,e)},n.mul=function(t,e){return o("*",t.valueType,t,e)},n.div=function(t,e){return o("/",t.valueType,t,e)},n.equals=function(t,e){return o("==","bool",t,e)},n.greaterThan=function(t,e){return o(">","bool",t,e)},n.lessThan=function(t,e){return o("<","bool",t,e)},n.greaterThanOrEquals=function(t,e){return o(">=","bool",t,e)},n.lessThanOrEquals=function(t,e){return o("<=","bool",t,e)}},{"../intrinsics/intrinsics":12}],23:[function(t,e,n){"use strict";n.types={float:{name:"float",size:4,primitive:"float",primitiveCount:1},int:{name:"int",size:4,primitive:"int",primitiveCount:1},Vector2:{name:"Vector2",size:8,primitive:"float",primitiveCount:2},Vector3:{name:"Vector3",size:12,primitive:"float",primitiveCount:3},Quaternion:{name:"Quaternion",size:16,primitive:"float",primitiveCount:4},Color:{name:"Color",size:16,primitive:"float",primitiveCount:4}}},{}],24:[function(t,e,n){"use strict";var r=t("../spec/construct"),a=t("../utils/utils");n.flattenEmits=function(t){var e=a.attemptName("s3idx",(function(e){return!t.variables.hasOwnProperty(e)&&!t.input.hasOwnProperty(e)})),n=a.attemptName("s3idx_i",(function(e){return!t.variables.hasOwnProperty(e)&&!t.input.hasOwnProperty(e)})),o=a.attemptName("s3emitidx",(function(e){return!t.variables.hasOwnProperty(e)&&!t.input.hasOwnProperty(e)})),i={input:{},output:t.output,variables:t.variables,statements:[],repeatBegin:t.repeatBegin,repeatEnd:t.repeatEnd};for(var s in t.input)t.input.hasOwnProperty(s)&&(i.input[s]=t.input[s]);i.input[e]={type:"float",default:0},i.variables[n]="int",i.variables[o]="int",i.statements.push({type:"assign",variableName:n,expression:r.cast(r.variable(e,"float"),"int")}),i.statements.push({type:"assign",variableName:o,expression:r.constant(0,"int")});var u=function(t){for(var e=[],a=0,i=0;i<t.length;i++)switch(t[i].type){case"emit":e.push({type:"condition",condition:r.equals(r.variable(n,"int"),r.variable(o,"int")),trueStatements:[t[i]],falseStatements:[]}),e.push({type:"assign",variableName:o,expression:r.add(r.variable(o,"int"),r.constant(1,"int"))}),a+=1;break;case"for":var s=t[i],c=u(s.statements),l=c[0],p=c[1],d=[];d.push({type:"assign",variableName:s.variableName,expression:r.add(r.div(r.sub(r.variable(n,"int"),r.variable(o,"int")),r.constant(p,"int")),r.constant(s.rangeMin,"int"))}),d.push({type:"assign",variableName:o,expression:r.add(r.variable(o,"int"),r.mul(r.constant(p,"int"),r.sub(r.variable(s.variableName,"int"),r.constant(s.rangeMin,"int"))))}),(d=d.concat(l)).push({type:"assign",variableName:o,expression:r.add(r.variable(o,"int"),r.mul(r.constant(p,"int"),r.sub(r.constant(s.rangeMax,"int"),r.variable(s.variableName,"int"))))}),e.push({type:"condition",condition:r.op("&&","bool",r.greaterThanOrEquals(r.variable(n,"int"),r.variable(o,"int")),r.lessThan(r.variable(n,"int"),r.add(r.variable(o,"int"),r.constant(p*(s.rangeMax-s.rangeMin+1),"int")))),trueStatements:d,falseStatements:[{type:"assign",variableName:o,expression:r.add(r.variable(o,"int"),r.constant((s.rangeMax-s.rangeMin+1)*p,"int"))}]}),a+=(s.rangeMax-s.rangeMin+1)*p;break;case"condition":var h=t[i],m=u(h.trueStatements),f=m[0],g=m[1],y=u(h.falseStatements),v=y[0],_=y[1];e.push({type:"condition",condition:h.condition,trueStatements:f,falseStatements:v}),a=Math.max(g,_);break;default:e.push(t[i])}return[e,a]},c=u(t.statements),l=c[0],p=c[1];return i.statements=i.statements.concat(l),{specification:i,count:p,indexVariable:e}}},{"../spec/construct":22,"../utils/utils":26}],25:[function(t,e,n){"use strict";var r=t("./flattener");n.flattenEmits=r.flattenEmits},{"./flattener":24}],26:[function(t,e,n){"use strict";var r=function(){function t(){this._dict={}}return t.prototype.set=function(t,e){this._dict[t]=e},t.prototype.has=function(t){return this._dict.hasOwnProperty(t)},t.prototype.delete=function(t){delete this._dict[t]},t.prototype.get=function(t){return this._dict.hasOwnProperty(t)?this._dict[t]:void 0},t.prototype.forEach=function(t){for(var e in this._dict)this._dict.hasOwnProperty(e)&&t(this._dict[e],e)},t.prototype.clone=function(){var e=new t;return this.forEach((function(t,n){e.set(n,t)})),e},t}();n.Dictionary=r,n.shallowClone=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},n.attemptName=function(t,e){if(e(t))return t;for(var n=1;;n++){var r=t+n.toString();if(e(r))return r}},n.timeTask=function(t,e){var n=(new Date).getTime();e();var r=(new Date).getTime();console.log(t+": "+((r-n)/1e3).toFixed(3)+"s")}},{}],27:[function(t,e,n){"use strict";function r(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}n.version="0.1.1",r(t("./core/utils/utils")),r(t("./core/math/math")),r(t("./core/color/color")),r(t("./core/mark/mark")),r(t("./core/mark/marks")),r(t("./core/binding/binding")),r(t("./core/spec/spec")),r(t("./core/intrinsics/intrinsics")),r(t("./core/exceptions")),r(t("./core/compiler/parser")),r(t("./core/compiler/compiler")),r(t("./core/compiler/declare")),r(t("./core/transform/transforms")),r(t("./core/evaluator/evaluator")),r(t("./core/platform/platform")),r(t("./core/scale/scale"));var a=t("./core/scale/scales");n.scale=a.scale},{"./core/binding/binding":3,"./core/color/color":5,"./core/compiler/compiler":6,"./core/compiler/declare":7,"./core/compiler/parser":8,"./core/evaluator/evaluator":10,"./core/exceptions":11,"./core/intrinsics/intrinsics":12,"./core/mark/mark":16,"./core/mark/marks":17,"./core/math/math":18,"./core/platform/platform":19,"./core/scale/scale":20,"./core/scale/scales":21,"./core/spec/spec":23,"./core/transform/transforms":25,"./core/utils/utils":26}],28:[function(t,e,n){"use strict";var r=t("stardust-core"),a=t("earcut");n.isotype=function(t){var e=r.mark.custom();e.input("position","Vector2","[ 0, 0 ]"),e.input("size","float","1"),e.input("color","Color","[ 0, 0, 0, 1 ]");for(var n=function(t){var e=(new DOMParser).parseFromString(t,"image/svg+xml");function n(t,e){if(t instanceof Element&&t.tagName&&t.tagName.toLowerCase()==e)return[t];for(var r=[],a=0;a<t.children.length;a++)r=r.concat(n(t.children.item(a),e));return r}var r=n(e,"svg")[0],o=n(e,"polygon"),i=[];o.forEach((function(t){var e=t.getAttribute("points").split(/[, \t]/).map((function(t){return t.trim()})).filter((function(t){return""!=t})).map((function(t){return parseFloat(t)})),n=a(e),r="black";t.style.fill&&""!=t.style.fill&&(r=t.style.fill);for(var o=0;o<n.length;o+=3){var s=n[o+0],u=n[o+1],c=n[o+2],l={p1:[e[2*s],e[2*s+1]],p2:[e[2*u],e[2*u+1]],p3:[e[2*c],e[2*c+1]],color:r};i.push(l)}}));var s=function(t){return null==t||""==t?0:t.match(/px$/)||t.match(/em$/)?parseFloat(t.substr(0,t.length-2)):parseFloat(t)};return{x:s(r.getAttribute("x")),y:s(r.getAttribute("y")),width:s(r.getAttribute("width")),height:s(r.getAttribute("height")),triangles:i}}(t),o=n.x+n.width/2,i=n.y+n.height/2,s=0,u=n.triangles;s<u.length;s++){var c=u[s];e.add("P2D.Triangle").attr("p1","position + Vector2("+(c.p1[0]-o)+", "+(c.p1[1]-i)+") * size").attr("p2","position + Vector2("+(c.p2[0]-o)+", "+(c.p2[1]-i)+") * size").attr("p3","position + Vector2("+(c.p3[0]-o)+", "+(c.p3[1]-i)+") * size").attr("color","color")}return e.compile()}},{earcut:29,"stardust-core":27}],29:[function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,s,u,c,l,h,f,g=e&&e.length,y=g?e[0]*n:t.length,v=a(t,0,y,n,!0),_=[];if(!v)return _;if(g&&(v=function(t,e,n,r){var i,s,u,c,l,h=[];for(i=0,s=e.length;i<s;i++)u=e[i]*r,c=i<s-1?e[i+1]*r:t.length,(l=a(t,u,c,r,!1))===l.next&&(l.steiner=!0),h.push(m(l));for(h.sort(p),i=0;i<h.length;i++)d(h[i],n),n=o(n,n.next);return n}(t,e,v,n)),t.length>80*n){r=u=t[0],s=c=t[1];for(var x=n;x<y;x+=n)(l=t[x])<r&&(r=l),(h=t[x+1])<s&&(s=h),l>u&&(u=l),h>c&&(c=h);f=Math.max(u-r,c-s)}return i(v,_,n,r,s,f),_}function a(t,e,n,r,a){var o,i;if(a===T(t,e,n,r)>0)for(o=e;o<n;o+=r)i=C(o,t[o],t[o+1],i);else for(o=n-r;o>=e;o-=r)i=C(o,t[o],t[o+1],i);return i&&v(i,i.next)&&(w(i),i=i.next),i}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!v(r,r.next)&&0!==y(r.prev,r,r.next))r=r.next;else{if(w(r),(r=e=r.prev)===r.next)return null;n=!0}}while(n||r!==e);return e}function i(t,e,n,r,a,p,d){if(t){!d&&p&&function(t,e,n,r){var a=t;do{null===a.z&&(a.z=h(a.x,a.y,e,n,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==t);a.prevZ.nextZ=null,a.prevZ=null,function(t){var e,n,r,a,o,i,s,u,c=1;do{for(n=t,t=null,o=null,i=0;n;){for(i++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0===s?(a=r,r=r.nextZ,u--):0!==u&&r?n.z<=r.z?(a=n,n=n.nextZ,s--):(a=r,r=r.nextZ,u--):(a=n,n=n.nextZ,s--),o?o.nextZ=a:t=a,a.prevZ=o,o=a;n=r}o.nextZ=null,c*=2}while(i>1)}(a)}(t,r,a,p);for(var m,f,g=t;t.prev!==t.next;)if(m=t.prev,f=t.next,p?u(t,r,a,p):s(t))e.push(m.i/n),e.push(t.i/n),e.push(f.i/n),w(t),t=f.next,g=f.next;else if((t=f)===g){d?1===d?i(t=c(t,e,n),e,n,r,a,p,2):2===d&&l(t,e,n,r,a,p):i(o(t),e,n,r,a,p,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(y(e,n,r)>=0)return!1;for(var a=t.next.next;a!==t.prev;){if(f(e.x,e.y,n.x,n.y,r.x,r.y,a.x,a.y)&&y(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function u(t,e,n,r){var a=t.prev,o=t,i=t.next;if(y(a,o,i)>=0)return!1;for(var s=a.x<o.x?a.x<i.x?a.x:i.x:o.x<i.x?o.x:i.x,u=a.y<o.y?a.y<i.y?a.y:i.y:o.y<i.y?o.y:i.y,c=a.x>o.x?a.x>i.x?a.x:i.x:o.x>i.x?o.x:i.x,l=a.y>o.y?a.y>i.y?a.y:i.y:o.y>i.y?o.y:i.y,p=h(s,u,e,n,r),d=h(c,l,e,n,r),m=t.nextZ;m&&m.z<=d;){if(m!==t.prev&&m!==t.next&&f(a.x,a.y,o.x,o.y,i.x,i.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(m=t.prevZ;m&&m.z>=p;){if(m!==t.prev&&m!==t.next&&f(a.x,a.y,o.x,o.y,i.x,i.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.prevZ}return!0}function c(t,e,n){var r=t;do{var a=r.prev,o=r.next.next;!v(a,o)&&_(a,r,r.next,o)&&x(a,o)&&x(o,a)&&(e.push(a.i/n),e.push(r.i/n),e.push(o.i/n),w(r),w(r.next),r=t=o),r=r.next}while(r!==t);return r}function l(t,e,n,r,a,s){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&g(u,c)){var l=b(u,c);return u=o(u,u.next),l=o(l,l.next),i(u,e,n,r,a,s),void i(l,e,n,r,a,s)}c=c.next}u=u.next}while(u!==t)}function p(t,e){return t.x-e.x}function d(t,e){if(e=function(t,e){var n,r=e,a=t.x,o=t.y,i=-1/0;do{if(o<=r.y&&o>=r.next.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=a&&s>i){if(i=s,s===a){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(a===i)return n.prev;var u,c=n,l=n.x,p=n.y,d=1/0;for(r=n.next;r!==c;)a>=r.x&&r.x>=l&&f(o<p?a:i,o,l,p,o<p?i:a,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(a-r.x))<d||u===d&&r.x>n.x)&&x(r,t)&&(n=r,d=u),r=r.next;return n}(t,e)){var n=b(e,t);o(n,n.next)}}function h(t,e,n,r,a){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)/a)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)/a)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function m(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function f(t,e,n,r,a,o,i,s){return(a-i)*(e-s)-(t-i)*(o-s)>=0&&(t-i)*(r-s)-(n-i)*(e-s)>=0&&(n-i)*(o-s)-(a-i)*(r-s)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&_(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&x(t,e)&&x(e,t)&&function(t,e){var n=t,r=!1,a=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&a<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function _(t,e,n,r){return!!(v(t,e)&&v(n,r)||v(t,r)&&v(n,e))||y(t,e,n)>0!=y(t,e,r)>0&&y(n,r,t)>0!=y(n,r,e)>0}function x(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function b(t,e){var n=new P(t.i,t.x,t.y),r=new P(e.i,e.x,e.y),a=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=a,a.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function C(t,e,n,r){var a=new P(t,e,n);return r?(a.next=r.next,a.prev=r,r.next.prev=a,r.next=a):(a.prev=a,a.next=a),a}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function P(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,n,r){for(var a=0,o=e,i=n-r;o<n;o+=r)a+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return a}e.exports=r,r.deviation=function(t,e,n,r){var a=e&&e.length,o=a?e[0]*n:t.length,i=Math.abs(T(t,0,o,n));if(a)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;i-=Math.abs(T(t,c,l,n))}var p=0;for(s=0;s<r.length;s+=3){var d=r[s]*n,h=r[s+1]*n,m=r[s+2]*n;p+=Math.abs((t[d]-t[m])*(t[h+1]-t[d+1])-(t[d]-t[h])*(t[m+1]-t[d+1]))}return 0===i&&0===p?0:Math.abs((p-i)/i)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,a=0;a<t.length;a++){for(var o=0;o<t[a].length;o++)for(var i=0;i<e;i++)n.vertices.push(t[a][o][i]);a>0&&(r+=t[a-1].length,n.holes.push(r))}return n}},{}],30:[function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./types"),o=t("./intrinsics"),i=t("stardust-core"),s=function(){function t(){this._lines=[],this._currentIndent="",this._blocks=new i.Dictionary}return t.prototype.addNamedBlock=function(t,e){this._blocks.has(t)?this._blocks.set(t,this._blocks.get(t)+"\n"+e):this._blocks.set(t,e)},t.prototype.addLine=function(t){this._lines.push(this._currentIndent+t)},t.prototype.indent=function(){this._currentIndent+="    "},t.prototype.unindent=function(){this._currentIndent=this._currentIndent.slice(0,this._currentIndent.length-4)},t.prototype.getCode=function(){var t=this;return this._lines.map((function(e){return"@"==e[0]&&t._blocks.has(e.substr(1))?t._blocks.get(e.substr(1)):e})).join("\n")},t}();n.LinesGenerator=s;var u=function(t){function e(){t.call(this)}return r(e,t),e.prototype.addAdditionalCode=function(t){this.addNamedBlock("additionalCode",t)},e.prototype.addDeclaration=function(t,e,n){void 0===n&&(n=null),null==n?this.addLine(a.convertTypeName(e)+" "+t+";"):this.addLine(n+" "+a.convertTypeName(e)+" "+t+";")},e.prototype.addArrayDeclaration=function(t,e,n,r){void 0===n&&(n=1),void 0===r&&(r=null),"null"==r?this.addLine(a.convertTypeName(e)+"["+n+"] "+t+";"):this.addLine(r+" "+a.convertTypeName(e)+"["+n+"] "+t+";")},e.prototype.addUniform=function(t,e){this.addLine("uniform "+a.convertTypeName(e)+" "+t+";"),"Vector2Array"!=e&&"FloatArray"!=e&&"Vector3Array"!=e&&"Vector4Array"!=e&&"ColorArray"!=e||this.addLine("uniform int "+t+"_length;"),"Vector2Image"!=e&&"FloatImage"!=e&&"Vector3Image"!=e&&"Vector4Image"!=e&&"Image"!=e||(this.addLine("uniform int "+t+"_width;"),this.addLine("uniform int "+t+"_height;"))},e.prototype.addAttribute=function(t,e){this.addLine("attribute "+a.convertTypeName(e)+" "+t+";")},e.prototype.addVarying=function(t,e){this.addLine("varying "+a.convertTypeName(e)+" "+t+";")},e.prototype.addIn=function(t,e){this.addLine("in "+a.convertTypeName(e)+" "+t+";")},e.prototype.addOut=function(t,e){this.addLine("out "+a.convertTypeName(e)+" "+t+";")},e.prototype.generateExpression=function(t){var e=this;switch(t.type){case"constant":var n=t;return a.convertConstant(n.valueType,n.value);case"variable":return t.variableName;case"function":var r=t,i=r.arguments.map((function(t){return e.generateExpression(t)})),s=o.generateIntrinsicFunction(r.functionName,i),u=s.code,c=s.additionalCode;return null!=c&&this.addAdditionalCode(c),u;case"field":var l=t;return this.generateExpression(l.value)+"."+l.fieldName}},e.prototype.addStatement=function(t){switch(t.type){case"assign":var e=t,n=this.generateExpression(e.expression);this.addLine(e.variableName+" = "+n+";");break;case"condition":var r=t;r.trueStatements.length>0&&r.falseStatements.length>0?(this.addLine("if("+this.generateExpression(r.condition)+") {"),this.indent(),this.addStatements(r.trueStatements),this.unindent(),this.addLine("} else {"),this.indent(),this.addStatements(r.falseStatements),this.unindent(),this.addLine("}")):r.trueStatements.length>0?(this.addLine("if("+this.generateExpression(r.condition)+") {"),this.indent(),this.addStatements(r.trueStatements),this.unindent(),this.addLine("}")):r.falseStatements.length>0&&(this.addLine("if(!"+this.generateExpression(r.condition)+") {"),this.indent(),this.addStatements(r.trueStatements),this.unindent(),this.addLine("}"));break;case"for":var a=t;this.addLine("for(int "+a.variableName+" = "+a.rangeMin+"; "+a.variableName+" <= "+a.rangeMax+"; "+a.variableName+"++) {"),this.indent(),this.addStatements(a.statements),this.unindent(),this.addLine("}");break;case"emit":var o=t;this.addEmitStatement(o)}},e.prototype.addStatements=function(t){var e=this;t.forEach((function(t){return e.addStatement(t)}))},e.prototype.addEmitStatement=function(t){this.addLine("// Emit Statement")},e}(s);n.ShaderGenerator=u;var c=function(){function t(t,e,n){var r=this;this._spec=t,this._shader=e,this._asUniform=n,this._names={};var a=function(t){for(var e in t)t.hasOwnProperty(e)&&(r._names[e]=!0)};a(t.input),a(t.output),a(t.variables),a(e.input),a(e.output)}return t.prototype.getUnusedName=function(t){for(var e=0;;){var n="s3"+t+e.toString();if(!0!==this._names[n])return this._names[n]=!0,n;e+=1}},t.prototype.fragmentPassthru=function(t){return this._spec.input.hasOwnProperty(t)&&!this._spec.output.hasOwnProperty(t)},t}();n.ProgramGenerator=c},{"./intrinsics":31,"./types":32,"stardust-core":27}],31:[function(t,e,n){"use strict";var r=t("stardust-core"),a=t("stardust-core"),o=new a.Dictionary,i=new a.Dictionary;function s(t,e,n,a){var i=r.getInternalName({name:t,argTypes:e,returnType:n});o.set(i,a)}function u(t,e,n,a,o){if(s(t,e,n,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return a+"("+t.join(", ")+")"})),o){var u=r.getInternalName({name:t,argTypes:e,returnType:n});i.set(u,o)}}function c(t,e,n,r){s("@"+t,e,n,r)}function l(t,e,n){s("cast:"+t+":"+e,[t],e,n)}for(var p=0,d=["float","int","Vector2","Vector3","Vector4","Color"];p<d.length;p++)c("+",[y=d[p],y],y,(function(t,e){return"("+t+") + ("+e+")"})),c("-",[y,y],y,(function(t,e){return"("+t+") - ("+e+")"})),c("*",[y,y],y,(function(t,e){return"("+t+") * ("+e+")"})),c("/",[y,y],y,(function(t,e){return"("+t+") / ("+e+")"})),"Color"!=y&&(c("+",[y],y,(function(t,e){return""+t})),c("-",[y],y,(function(t,e){return"-("+t+")"})));c("*",["float","Vector2"],"Vector2",(function(t,e){return"("+t+") * ("+e+")"})),c("*",["float","Vector3"],"Vector3",(function(t,e){return"("+t+") * ("+e+")"})),c("*",["float","Vector4"],"Vector4",(function(t,e){return"("+t+") * ("+e+")"})),c("*",["Vector2","float"],"Vector2",(function(t,e){return"("+t+") * ("+e+")"})),c("*",["Vector3","float"],"Vector3",(function(t,e){return"("+t+") * ("+e+")"})),c("*",["Vector4","float"],"Vector4",(function(t,e){return"("+t+") * ("+e+")"})),c("/",["Vector2","float"],"Vector2",(function(t,e){return"("+t+") / ("+e+")"})),c("/",["Vector3","float"],"Vector3",(function(t,e){return"("+t+") / ("+e+")"})),c("/",["Vector4","float"],"Vector4",(function(t,e){return"("+t+") / ("+e+")"})),c("%",["float","float"],"float",(function(t,e){return"mod("+t+", "+e+")"}));for(var h=0,m=["float","int","bool"];h<m.length;h++)c("==",[y=m[h],y],"bool",(function(t,e){return"("+t+") == ("+e+")"}));for(var f=0,g=["float","int"];f<g.length;f++){var y;c(">",[y=g[f],y],"bool",(function(t,e){return"("+t+") > ("+e+")"})),c("<",[y,y],"bool",(function(t,e){return"("+t+") < ("+e+")"})),c(">=",[y,y],"bool",(function(t,e){return"("+t+") >= ("+e+")"})),c("<=",[y,y],"bool",(function(t,e){return"("+t+") <= ("+e+")"}))}c("!",["bool"],"bool",(function(t){return"!("+t+")"})),c("&&",["bool","bool"],"bool",(function(t,e){return"("+t+") && ("+e+")"})),c("||",["bool","bool"],"bool",(function(t,e){return"("+t+") || ("+e+")"})),u("Vector2",["float","float"],"Vector2","vec2"),u("Vector3",["float","float","float"],"Vector3","vec3"),u("Vector4",["float","float","float","float"],"Vector4","vec4"),u("Color",["float","float","float","float"],"Color","vec4"),u("Quaternion",["float","float","float","float"],"Quaternion","vec4"),u("normalize",["Vector2"],"Vector2","normalize"),u("normalize",["Vector3"],"Vector3","normalize"),u("normalize",["Vector4"],"Vector4","normalize"),u("normalize",["Quaternion"],"Vector4","normalize"),u("dot",["Vector2","Vector2"],"float","dot"),u("dot",["Vector3","Vector3"],"float","dot"),u("dot",["Vector4","Vector4"],"float","dot"),u("length",["Vector2"],"float","length"),u("length",["Vector3"],"float","length"),u("length",["Vector4"],"float","length"),u("length",["Quaternion"],"float","length"),u("cross",["Vector3","Vector3"],"Vector3","cross"),u("quat_mul",["Quaternion","Quaternion"],"Quaternion","s3_quat_mul","\n    vec4 s3_quat_mul(vec4 q1, vec4 q2) {\n        return vec4(\n            q1.w * q2.xyz + q2.w * q1.xyz + cross(q1.xyz, q2.xyz),\n            q1.w * q2.w - dot(q1.xyz, q2.xyz)\n        );\n    }\n"),u("quat_rotate",["Quaternion","Vector3"],"Vector3","s3_quat_rotate","\n    vec3 s3_quat_rotate(vec4 q, vec3 v) {\n        float d = dot(q.xyz, v);\n        vec3 c = cross(q.xyz, v);\n        return q.w * q.w * v + (q.w + q.w) * c + d * q.xyz - cross(c, q.xyz);\n    }\n");var v="\n    float s3_lab2rgb_curve(float v) {\n        float p = pow(v, 3.0);\n        if(p > 0.008856) {\n            return p;\n        } else {\n            return (v - 16.0 / 116.0) / 7.787;\n        }\n    }\n    float s3_lab2rgb_curve2(float v) {\n        if(v > 0.0031308) {\n            return 1.055 * pow(v , (1.0 / 2.4)) - 0.055;\n        } else {\n            return 12.92 * v;\n        }\n    }\n    vec4 s3_lab2rgb(vec4 lab) {\n        float var_Y = (lab.x + 0.160) / 1.160;\n        float var_X = lab.y / 5.0 + var_Y;\n        float var_Z = var_Y - lab.z / 2.0;\n\n        var_X = s3_lab2rgb_curve(var_X) * 0.95047;\n        var_Y = s3_lab2rgb_curve(var_Y);\n        var_Z = s3_lab2rgb_curve(var_Z) * 1.08883;\n\n        float var_R = var_X *  3.2406 + var_Y * -1.5372 + var_Z * -0.4986;\n        float var_G = var_X * -0.9689 + var_Y *  1.8758 + var_Z *  0.0415;\n        float var_B = var_X *  0.0557 + var_Y * -0.2040 + var_Z *  1.0570;\n\n        var_R = s3_lab2rgb_curve2(var_R);\n        var_G = s3_lab2rgb_curve2(var_G);\n        var_B = s3_lab2rgb_curve2(var_B);\n\n        return vec4(var_R, var_G, var_B, lab.a);\n    }\n    vec4 s3_hcl2rgb(vec4 hcl) {\n        vec4 lab = vec4(hcl.z, hcl.y * cos(hcl.x), hcl.y * sin(hcl.x), hcl.a);\n        return s3_lab2rgb(lab);\n    }\n";u("lab2rgb",["Color"],"Color","s3_lab2rgb",v),u("hcl2rgb",["Color"],"Color","s3_hcl2rgb",v),u("abs",["float"],"float","abs"),u("sqrt",["float"],"float","sqrt"),u("exp",["float"],"float","exp"),u("log",["float"],"float","log"),u("sin",["float"],"float","sin"),u("cos",["float"],"float","cos"),u("tan",["float"],"float","tan"),u("asin",["float"],"float","asin"),u("acos",["float"],"float","acos"),u("atan",["float"],"float","atan"),u("atan2",["float","float"],"float","atan2"),u("abs",["int"],"int","abs"),u("min",["float","float"],"float","min"),u("max",["float","float"],"float","max"),u("ceil",["float"],"float","ceil"),u("floor",["float"],"float","floor"),u("mix",["float","float","float"],"float","mix"),u("mix",["Vector2","Vector2","float"],"Vector2","mix"),u("mix",["Vector3","Vector3","float"],"Vector3","mix"),u("mix",["Vector4","Vector4","float"],"Vector4","mix"),u("mix",["Color","Color","float"],"Color","mix"),s("clamp",["float"],"float",(function(t){return"clamp("+t+", 0, 1)"})),l("float","int",(function(t){return"int("+t+")"})),l("int","float",(function(t){return"float("+t+")"})),s("array",["FloatArray","float"],"float",(function(t,e){return"texture2D("+t+", vec2(("+e+" + 0.5) / float("+t+"_length), 0.5)).x"})),s("array",["Vector2Array","float"],"Vector2",(function(t,e){return"texture2D("+t+", vec2(("+e+" + 0.5) / float("+t+"_length), 0.5)).xy"})),s("array",["Vector3Array","float"],"Vector3",(function(t,e){return"texture2D("+t+", vec2(("+e+" + 0.5) / float("+t+"_length), 0.5)).xyz"})),s("array",["Vector4Array","float"],"Vector4",(function(t,e){return"texture2D("+t+", vec2(("+e+" + 0.5) / float("+t+"_length), 0.5)).xyzw"})),s("array",["ColorArray","float"],"Color",(function(t,e){return"texture2D("+t+", vec2(("+e+" + 0.5) / float("+t+"_length), 0.5)).rgba"})),s("image",["FloatImage","Vector2"],"float",(function(t,e){return"texture2D("+t+", ("+e+" + 0.5) / vec2("+t+"_width, "+t+"_height))).x"})),s("image",["Vector2Image","Vector2"],"Vector2",(function(t,e){return"texture2D("+t+", ("+e+" + 0.5) / vec2("+t+"_width, "+t+"_height))).xy"})),s("image",["Vector3Image","Vector2"],"Vector3",(function(t,e){return"texture2D("+t+", ("+e+" + 0.5) / vec2("+t+"_width, "+t+"_height))).xyz"})),s("image",["Vector4Image","Vector2"],"Vector4",(function(t,e){return"texture2D("+t+", ("+e+" + 0.5) / vec2("+t+"_width, "+t+"_height))).xyzw"})),s("image",["ColorImage","Vector2"],"Color",(function(t,e){return"texture2D("+t+", ("+e+" + 0.5) / vec2("+t+"_width, "+t+"_height))).rgba"})),n.generateIntrinsicFunction=function(t,e){if(o.has(t))return i.has(t)?{code:o.get(t).apply(void 0,e),additionalCode:i.get(t)}:{code:o.get(t).apply(void 0,e),additionalCode:null};throw new Error("intrinsic function "+t+" is not defined.")}},{"stardust-core":27}],32:[function(t,e,n){"use strict";var r={float:"float",int:"int",bool:"bool",Vector2:"vec2",Vector3:"vec3",Vector4:"vec4",Matrix3:"mat3",Matrix4:"mat4",Quaternion:"vec4",Color:"vec4",FloatArray:"sampler2D",Vector2Array:"sampler2D",Vector3Array:"sampler2D",Vector4Array:"sampler2D"};n.convertTypeName=function(t){return r[t]},n.convertConstant=function(t,e){return"float"==t?e.toFixed(5):"int"==t?e.toString():"bool"==t?0!=e?"true":"false":"Vector2"==t?"vec2("+e.join(", ")+")":"Vector3"==t?"vec3("+e.join(", ")+")":"Vector4"==t||"Quaternion"==t||"Color"==t?"vec4("+e.join(", ")+")":void 0}},{}],33:[function(t,e,n){"use strict";n.version="0.1.1";var r=t("./webgl/webgl");n.WebGLPlatform=r.WebGLPlatform,n.WebGLCanvasPlatform2D=r.WebGLCanvasPlatform2D,n.WebGLCanvasPlatform3D=r.WebGLCanvasPlatform3D,n.WebGLCanvasPlatformWebVR=r.WebGLCanvasPlatformWebVR;var a=t("stardust-core"),o=t("./webgl/webgl");a.registerPlatformConstructor("webgl-2d",(function(t,e,n){return void 0===e&&(e=600),void 0===n&&(n=400),new o.WebGLCanvasPlatform2D(t,e,n)})),a.registerPlatformConstructor("webgl-3d",(function(t,e,n){return void 0===e&&(e=600),void 0===n&&(n=400),new o.WebGLCanvasPlatform3D(t,e,n)})),a.registerPlatformConstructor("webgl-webvr",(function(t,e,n){return void 0===e&&(e=600),void 0===n&&(n=400),new o.WebGLCanvasPlatformWebVR(t,e,n)}))},{"./webgl/webgl":35,"stardust-core":27}],34:[function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("../glsl/glsl"),o=t("stardust-core");!function(t){t[t.NORMAL=0]="NORMAL",t[t.PICK=1]="PICK",t[t.FRAGMENT=2]="FRAGMENT"}(n.GenerateMode||(n.GenerateMode={}));var i=n.GenerateMode;!function(t){t[t.VIEW_2D=0]="VIEW_2D",t[t.VIEW_3D=1]="VIEW_3D",t[t.VIEW_WEBVR=2]="VIEW_WEBVR"}(n.ViewType||(n.ViewType={}));var s=n.ViewType,u=function(t){function e(e){t.call(this),this._parent=e}return r(e,t),e.prototype.addEmitStatement=function(t){for(var e in t.attributes)this.addLine(this._parent._voutMapping.get(e)+" = "+this.generateExpression(t.attributes[e])+";");this._parent._mode==i.PICK&&this.addLine("out_pick_index = vec4(s3_pick_index.rgb, s3_pick_index_alpha);");var n=this._parent._voutMapping.get("position");switch(this._parent._spec.output.position.type){case"Vector2":this.addLine("gl_Position = s3_render_vertex(vec3("+n+", 0.0));");break;case"Vector3":this.addLine("gl_Position = s3_render_vertex("+n+");");break;case"Vector4":this.addLine("gl_Position = s3_render_vertex("+n+".xyz);")}},e}(a.ShaderGenerator);n.GLSLVertexShaderGenerator=u;var c=function(t){function e(e){t.call(this),this._parent=e}return r(e,t),e.prototype.addEmitStatement=function(t){this.addLine("gl_FragColor = "+this.generateExpression(t.attributes.color)+";")},e}(a.ShaderGenerator);n.GLSLFragmentShaderGenerator=c;var l=function(t){function e(e,n,r,a,o){void 0===o&&(o=i.NORMAL),t.call(this,e,n,r),this._mode=o,this._viewType=a,this._vertex=new u(this),this._fragment=new c(this),this.compile()}return r(e,t),e.prototype.compile=function(){var t=this,e=this._spec,n=this._shader,r=this._asUniform;switch(this._voutMapping=new o.Dictionary,this._foutMapping=new o.Dictionary,this._vertex.addLine("precision highp float;"),this._fragment.addLine("precision highp float;"),this._mode==i.PICK&&(this._vertex.addAttribute("s3_pick_index","Vector4"),this._vertex.addUniform("s3_pick_index_alpha","float")),this._viewType){case s.VIEW_2D:this._vertex.addUniform("s3_view_params","Vector4"),this._vertex.addAdditionalCode("\n                    vec4 s3_render_vertex(vec3 p) {\n                        return vec4(p.xy * s3_view_params.xy + s3_view_params.zw, 0.0, 1.0);\n                    }\n                ");break;case s.VIEW_3D:this._vertex.addUniform("s3_view_params","Vector4"),this._vertex.addUniform("s3_view_position","Vector3"),this._vertex.addUniform("s3_view_rotation","Vector4"),this._vertex.addAdditionalCode("\n                    vec4 s3_render_vertex(vec3 p) {\n                        // Get position in view coordinates:\n                        //   v = quaternion_inverse_rotate(rotation, p - position)\n                        vec3 v = p - s3_view_position;\n                        float d = dot(s3_view_rotation.xyz, v);\n                        vec3 c = cross(s3_view_rotation.xyz, v);\n                        v = s3_view_rotation.w * s3_view_rotation.w * v - (s3_view_rotation.w + s3_view_rotation.w) * c + d * s3_view_rotation.xyz - cross(c, s3_view_rotation.xyz);\n                        // Compute projection.\n                        vec4 r;\n                        r.xy = v.xy * s3_view_params.xy;\n                        r.z = v.z * s3_view_params.z + s3_view_params.w;\n                        r.w = -v.z;\n                        return r;\n                    }\n                ");break;case s.VIEW_WEBVR:this._vertex.addUniform("s3_projection_matrix","Matrix4"),this._vertex.addUniform("s3_view_matrix","Matrix4"),this._vertex.addUniform("s3_view_position","Vector3"),this._vertex.addUniform("s3_view_rotation","Vector4"),this._vertex.addAdditionalCode("\n                    vec4 s3_render_vertex(vec3 p) {\n                        vec3 v = p - s3_view_position;\n                        float d = dot(s3_view_rotation.xyz, v);\n                        vec3 c = cross(s3_view_rotation.xyz, v);\n                        v = s3_view_rotation.w * s3_view_rotation.w * v - (s3_view_rotation.w + s3_view_rotation.w) * c + d * s3_view_rotation.xyz - cross(c, s3_view_rotation.xyz);\n                        return s3_projection_matrix * s3_view_matrix * vec4(v, 1);\n                    }\n                ")}for(var a in e.input)e.input.hasOwnProperty(a)&&(r(a)?this._vertex.addUniform(a,e.input[a].type):this._vertex.addAttribute(a,e.input[a].type));for(var u in this._vertex.addLine("@additionalCode"),e.output)if(e.output.hasOwnProperty(u)){var c=this.getUnusedName(u);this._voutMapping.set(u,c),this._vertex.addVarying(c,e.output[u].type)}var l=[];for(var p in n.input)if(n.input.hasOwnProperty(p))if(this.fragmentPassthru(p)){var d=this.getUnusedName(p);l.push([d,p]),this._vertex.addVarying(d,n.input[p].type),this._fragment.addVarying(d,n.input[p].type)}else d=this._voutMapping.get(p),this._fragment.addVarying(d,n.input[p].type);for(var h in this._mode==i.PICK&&this._vertex.addVarying("out_pick_index","Vector4"),this._vertex.addLine("void main() {"),this._vertex.indent(),e.variables)if(e.variables.hasOwnProperty(h)){var m=e.variables[h];this._vertex.addDeclaration(h,m)}if(this._vertex.addStatements(e.statements),this._vertex.unindent(),this._vertex.addLine("}"),this._vertexCode=this._vertex.getCode(),this._mode==i.PICK)this._fragmentCode="\n                precision highp float;\n                varying vec4 out_pick_index;\n                void main() {\n                    gl_FragColor = out_pick_index;\n                }\n            ";else{for(var f in n.output)n.output.hasOwnProperty(f)&&(c=this.getUnusedName(f),this._foutMapping.set(f,c),this._fragment.addDeclaration(c,n.output[f].type));for(var g in this._fragment.addLine("void main() {"),this._fragment.indent(),n.variables)n.variables.hasOwnProperty(g)&&(m=n.variables[g],this._fragment.addDeclaration(g,m));var y=function(e){n.input.hasOwnProperty(e)&&(v.fragmentPassthru(e)?l.forEach((function(n){var r=n[0];n[1]==e&&t._fragment.addLine(e+" = "+r+";")})):(v._fragment.addDeclaration(e,n.input[e].type),v._fragment.addLine(e+" = "+v._voutMapping.get(e)+";")))},v=this;for(var _ in n.input)y(_);this._fragment.addStatements(n.statements),this._fragment.unindent(),this._fragment.addLine("}"),this._fragmentCode=this._fragment.getCode()}},e.prototype.getVertexCode=function(){return this._vertexCode},e.prototype.getFragmentCode=function(){return this._fragmentCode},e}(a.ProgramGenerator);n.Generator=l},{"../glsl/glsl":30,"stardust-core":27}],35:[function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("stardust-core"),o=t("stardust-core"),i=t("stardust-core"),s=t("./generator"),u=t("stardust-core"),c=t("stardust-core"),l=t("./webglutils"),p=function(){function t(t,e,n,r,a,o){this._GL=t;var u=new s.Generator(e,n,r,a,o);this._program=l.compileProgram(this._GL,u.getVertexCode(),u.getFragmentCode()),this._uniformLocations=new i.Dictionary,this._attribLocations=new i.Dictionary,this._textures=new i.Dictionary,this._currentTextureUnit=0}return t.prototype.use=function(){this._GL.useProgram(this._program)},t.prototype.setUniform=function(t,e,n){var r=this.getUniformLocation(t);if(null!=r){var a=this._GL;if("float"==e.primitive){var o=n;switch(e.primitiveCount){case 1:a.uniform1f(r,n);break;case 2:a.uniform2f(r,o[0],o[1]);break;case 3:a.uniform3f(r,o[0],o[1],o[2]);break;case 4:a.uniform4f(r,o[0],o[1],o[2],o[3])}}if("int"==e.primitive)switch(o=n,e.primitiveCount){case 1:a.uniform1i(r,n);break;case 2:a.uniform2i(r,o[0],o[1]);break;case 3:a.uniform3i(r,o[0],o[1],o[2]);break;case 4:a.uniform4i(r,o[0],o[1],o[2],o[3])}}},t.prototype.setTexture=function(t,e){var n=this._GL;if(!this._textures.has(t)){var r=n.createTexture(),o=this._currentTextureUnit++;this._textures.set(t,{data:null,texture:r,unit:o}),n.bindTexture(n.TEXTURE_2D,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.bindTexture(n.TEXTURE_2D,null),this.use(),this.setUniform(t,a.types.int,o)}var i=this._textures.get(t),s=e.getTextureData();i.data!=s&&(i.data=s,n.bindTexture(n.TEXTURE_2D,i.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,s.width,s.height,0,n.RGBA,n.FLOAT,s.data),n.bindTexture(n.TEXTURE_2D,null),this.use(),1==s.dimensions&&this.setUniform(t+"_length",a.types.int,s.width),2==s.dimensions&&(this.setUniform(t+"_width",a.types.int,s.width),this.setUniform(t+"_height",a.types.int,s.height)))},t.prototype.bindTextures=function(){var t=this._GL;this._textures.forEach((function(e){t.activeTexture(t.TEXTURE0+e.unit),t.bindTexture(t.TEXTURE_2D,e.texture)}))},t.prototype.unbindTextures=function(){var t=this._GL;this._textures.forEach((function(e){t.activeTexture(t.TEXTURE0+e.unit),t.bindTexture(t.TEXTURE_2D,null)}))},t.prototype.getUniformLocation=function(t){if(this._uniformLocations.has(t))return this._uniformLocations.get(t);var e=this._GL.getUniformLocation(this._program,t);return this._uniformLocations.set(t,e),e},t.prototype.getAttribLocation=function(t){if(this._attribLocations.has(t))return this._attribLocations.get(t);var e=this._GL.getAttribLocation(this._program,t);return e<0&&(e=null),this._attribLocations.set(t,e),e},t}(),d=function(t){function e(){t.apply(this,arguments)}return r(e,t),e}(a.PlatformMarkData);n.WebGLPlatformMarkData=d;var h=function(t){function e(e,n,r,a,i,u,c){var l=this;t.call(this),this._platform=e,this._GL=n,this._mark=r,this._bindings=u,this._shiftBindings=c,this._spec=a,this._shader=i;var d=o.flattenEmits(a);this._specFlattened=d.specification,this._flattenedVertexIndexVariable=d.indexVariable,this._flattenedVertexCount=d.count,this._program=new p(n,this._specFlattened,this._shader,(function(t){return l.isUniform(t)}),this._platform.viewInfo.type,s.GenerateMode.NORMAL),this._programPick=new p(n,this._specFlattened,this._shader,(function(t){return l.isUniform(t)}),this._platform.viewInfo.type,s.GenerateMode.PICK),this.initializeUniforms()}return r(e,t),e.prototype.initializeUniforms=function(){for(var t in this._specFlattened.input)if(this.isUniform(t)){var e=this._bindings.get(t);e.bindingType==a.BindingType.VALUE&&this.updateUniform(t,e.specValue),e.bindingType==a.BindingType.TEXTURE&&this.updateTexture(t,e.textureValue)}},e.prototype.initializeBuffers=function(){var t=this,e=this._GL,n=new d;return n.buffers=new i.Dictionary,this._bindings.forEach((function(r,a){t.isUniform(a)||null!=t._program.getAttribLocation(a)&&n.buffers.set(a,e.createBuffer())})),n.buffers.set(this._flattenedVertexIndexVariable,e.createBuffer()),this._programPick&&n.buffers.set("s3_pick_index",e.createBuffer()),n.ranges=[],n},e.prototype.isUniform=function(t){if(t==this._flattenedVertexIndexVariable)return!1;if(null==this._bindings.get(t)){if(null==this._shiftBindings.get(t))throw new u.RuntimeError("attribute "+t+" is not specified.");return this._bindings.get(this._shiftBindings.get(t).name).bindingType!=a.BindingType.FUNCTION}return this._bindings.get(t).bindingType!=a.BindingType.FUNCTION},e.prototype.updateUniform=function(t,e){var n=this._bindings.get(t).valueType;this._program.use(),this._program.setUniform(t,n,e),this._programPick&&(this._programPick.use(),this._programPick.setUniform(t,n,e))},e.prototype.updateTexture=function(t,e){this._program.setTexture(t,e),this._programPick&&this._programPick.setTexture(t,e)},e.prototype.uploadData=function(t){var e=this.initializeBuffers();e.ranges=[];var n=this._spec.repeatBegin||0,r=this._spec.repeatEnd||0,a=this._GL,o=(this._bindings,this._flattenedVertexCount),i=0;t.forEach((function(t){var a=t.length;if(0!=a){var s=i,u=i+=a+n+r;e.ranges.push([s*o,u*o])}else e.ranges.push(null)})),this._bindings.forEach((function(s,u){var c=e.buffers.get(u);if(null!=c){var l=s.valueType,p=new Float32Array(l.primitiveCount*i*o),d=0,h=l.primitiveCount*o;t.forEach((function(t){if(0!=t.length){for(var e=0;e<n;e++)s.fillBinary([t[0]],o,p.subarray(d,d+h)),d+=h;for(s.fillBinary(t,o,p.subarray(d,d+t.length*h)),d+=t.length*h,e=0;e<r;e++)s.fillBinary([t[t.length-1]],o,p.subarray(d,d+h)),d+=h}})),a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,p,a.STATIC_DRAW)}}));for(var s=new Float32Array(i*o),u=0;u<i*o;u++)s[u]=u%o;if(a.bindBuffer(a.ARRAY_BUFFER,e.buffers.get(this._flattenedVertexIndexVariable)),a.bufferData(a.ARRAY_BUFFER,s,a.STATIC_DRAW),this._programPick){var c=new Float32Array(i*o*4);for(u=0;u<i*o;u++){var l=Math.floor(u/o);c[4*u+0]=(255&l)/255,c[4*u+1]=((65280&l)>>8)/255,c[4*u+2]=((16711680&l)>>16)/255,c[4*u+3]=((4278190080&l)>>24)/255}a.bindBuffer(a.ARRAY_BUFFER,e.buffers.get("s3_pick_index")),a.bufferData(a.ARRAY_BUFFER,c,a.STATIC_DRAW)}return e},e.prototype.renderBase=function(t,e,n){var r=this;if(t.ranges.length>0){var a=this._GL,o=this._specFlattened,i=this._bindings,u=this._program;e==s.GenerateMode.PICK&&(u=this._programPick),u.use();var c=0,l=0;for(var p in this._shiftBindings.forEach((function(t,e){t.offset>l&&(l=t.offset),t.offset<c&&(c=t.offset)})),o.input)if(null!=(m=u.getAttribLocation(p)))if(this._shiftBindings.has(p)){var d=this._shiftBindings.get(p);a.bindBuffer(a.ARRAY_BUFFER,t.buffers.get(d.name)),a.enableVertexAttribArray(m);var h=i.get(d.name).valueType;a.vertexAttribPointer(m,h.primitiveCount,"float"==h.primitive?a.FLOAT:a.INT,!1,0,h.size*(d.offset-c)*this._flattenedVertexCount)}else a.bindBuffer(a.ARRAY_BUFFER,t.buffers.get(p)),a.enableVertexAttribArray(m),p==this._flattenedVertexIndexVariable?a.vertexAttribPointer(m,1,a.FLOAT,!1,0,4*-c*this._flattenedVertexCount):(h=i.get(p).valueType,a.vertexAttribPointer(m,h.primitiveCount,"float"==h.primitive?a.FLOAT:a.INT,!1,0,h.size*-c*this._flattenedVertexCount));if(e==s.GenerateMode.PICK){var m=u.getAttribLocation("s3_pick_index");a.bindBuffer(a.ARRAY_BUFFER,t.buffers.get("s3_pick_index")),a.enableVertexAttribArray(m),a.vertexAttribPointer(m,4,a.FLOAT,!1,0,0)}var f=this._platform.viewInfo,g=this._platform.pose;switch(f.type){case s.ViewType.VIEW_2D:a.uniform4f(u.getUniformLocation("s3_view_params"),2/f.width,-2/f.height,-1,1);break;case s.ViewType.VIEW_3D:a.uniform4f(u.getUniformLocation("s3_view_params"),1/Math.tan(f.fovY/2)/f.aspectRatio,1/Math.tan(f.fovY/2),(f.near+f.far)/(f.near-f.far),2*f.near*f.far/(f.near-f.far)),g?(a.uniform4f(u.getUniformLocation("s3_view_rotation"),g.rotation.x,g.rotation.y,g.rotation.z,g.rotation.w),a.uniform3f(u.getUniformLocation("s3_view_position"),g.position.x,g.position.y,g.position.z)):(a.uniform4f(u.getUniformLocation("s3_view_rotation"),0,0,0,1),a.uniform3f(u.getUniformLocation("s3_view_position"),0,0,0));break;case s.ViewType.VIEW_WEBVR:a.uniformMatrix4fv(u.getUniformLocation("s3_view_matrix"),!1,f.viewMatrix),a.uniformMatrix4fv(u.getUniformLocation("s3_projection_matrix"),!1,f.projectionMatrix),g?(a.uniform4f(u.getUniformLocation("s3_view_rotation"),g.rotation.x,g.rotation.y,g.rotation.z,g.rotation.w),a.uniform3f(u.getUniformLocation("s3_view_position"),g.position.x,g.position.y,g.position.z)):(a.uniform4f(u.getUniformLocation("s3_view_rotation"),0,0,0,1),a.uniform3f(u.getUniformLocation("s3_view_position"),0,0,0))}for(var y in e==s.GenerateMode.PICK&&a.uniform1f(u.getUniformLocation("s3_pick_index_alpha"),this._pickIndex/255),u.bindTextures(),t.ranges.forEach((function(t,e){n&&n(e),null!=t&&(u.use(),u.bindTextures(),a.drawArrays(a.TRIANGLES,t[0],t[1]-t[0]-(l-c)*r._flattenedVertexCount))})),u.unbindTextures(),o.input)null!=(m=u.getAttribLocation(y))&&a.disableVertexAttribArray(m);e==s.GenerateMode.PICK&&(m=u.getAttribLocation("s3_pick_index"),a.disableVertexAttribArray(m))}},e.prototype.setPickIndex=function(t){this._pickIndex=t},e.prototype.render=function(t,e){this._platform.renderMode==s.GenerateMode.PICK&&this.setPickIndex(this._platform.assignPickIndex(this._mark)),this.renderBase(t,this._platform.renderMode,e)},e}(a.PlatformMark);n.WebGLPlatformMark=h;var m=function(t){function e(e){t.call(this),this._GL=e,this.set2DView(500,500),this.setPose(new c.Pose),this._renderMode=s.GenerateMode.NORMAL,this._pickFramebuffer=null}return r(e,t),Object.defineProperty(e.prototype,"viewInfo",{get:function(){return this._viewInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pose",{get:function(){return this._pose},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderMode",{get:function(){return this._renderMode},enumerable:!0,configurable:!0}),e.prototype.getPickFramebuffer=function(t,e){if(null==this._pickFramebuffer||t!=this._pickFramebufferWidth||e!=this._pickFramebufferHeight){var n=this._GL;this._pickFramebuffer=n.createFramebuffer(),this._pickFramebufferWidth=t,this._pickFramebufferHeight=e,n.bindFramebuffer(n.FRAMEBUFFER,this._pickFramebuffer),this._pickFramebufferTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this._pickFramebufferTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t,e,0,n.RGBA,n.UNSIGNED_BYTE,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this._pickFramebufferTexture,0),n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null)}return this._pickFramebuffer},e.prototype.beginPicking=function(t,e){this._renderMode=s.GenerateMode.PICK;var n=this._GL,r=this.getPickFramebuffer(t,e);n.bindFramebuffer(n.FRAMEBUFFER,r),n.clearColor(1,1,1,1),n.clear(n.COLOR_BUFFER_BIT),n.disable(n.BLEND),this._pickMarks=[]},e.prototype.assignPickIndex=function(t){var e=this._pickMarks.indexOf(t);if(e>=0)return e;var n=this._pickMarks.length;return this._pickMarks.push(t),n},e.prototype.endPicking=function(){var t=this._GL;t.bindFramebuffer(t.FRAMEBUFFER,null),t.enable(t.BLEND),this._renderMode=s.GenerateMode.NORMAL},e.prototype.getPickingPixel=function(t,e){if(null==this._pickMarks||t<0||e<0||t>=this._pickFramebufferWidth||e>=this._pickFramebufferHeight)return null;var n=this._GL,r=this._pickFramebuffer;n.bindFramebuffer(n.FRAMEBUFFER,r);var a=new Uint8Array(4);n.readPixels(t,this._pickFramebufferHeight-1-e,1,1,n.RGBA,n.UNSIGNED_BYTE,a),n.bindFramebuffer(n.FRAMEBUFFER,null);var o=a[0]+(a[1]<<8)+(a[2]<<16);return o>=16777215?null:[this._pickMarks[a[3]],o]},e.prototype.set2DView=function(t,e){this._viewInfo={type:s.ViewType.VIEW_2D,width:t,height:e}},e.prototype.set3DView=function(t,e,n,r){void 0===n&&(n=.1),void 0===r&&(r=1e3),this._viewInfo={type:s.ViewType.VIEW_3D,fovY:t,aspectRatio:e,near:n,far:r}},e.prototype.setWebVRView=function(t,e){this._viewInfo={type:s.ViewType.VIEW_WEBVR,viewMatrix:t,projectionMatrix:e}},e.prototype.setPose=function(t){this._pose=t},e.prototype.compile=function(t,e,n,r,a){return new h(this,this._GL,t,e,n,r,a)},e}(a.Platform);n.WebGLPlatform=m;var f=function(t){function e(e,n,r){void 0===n&&(n=600),void 0===r&&(r=400);var a=e.getContext("webgl")||e.getContext("experimental-webgl");try{a.getExtension("OES_texture_float"),a.getExtension("OES_texture_float_linear")}catch(t){}t.call(this,a),this._canvas=e,a.clearColor(1,1,1,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.disable(a.CULL_FACE),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA),this._pixelRatio=2,this.resize(n,r)}return r(e,t),Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return this._pixelRatio},set:function(t){this._pixelRatio=t,this.resize(this._width,this._height)},enumerable:!0,configurable:!0}),e.prototype.resize=function(t,e){this._width=t,this._height=e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px",this._canvas.width=t*this._pixelRatio,this._canvas.height=e*this._pixelRatio,this.set2DView(t,e),this.setPose(new c.Pose),this._GL.viewport(0,0,this._canvas.width,this._canvas.height)},e.prototype.clear=function(t){t&&this._GL.clearColor(t[0],t[1],t[2],null!=t[3]?t[3]:1),this._GL.clear(this._GL.COLOR_BUFFER_BIT|this._GL.DEPTH_BUFFER_BIT)},e}(m);n.WebGLCanvasPlatform2D=f;var g=function(t){function e(e,n,r){void 0===n&&(n=600),void 0===r&&(r=400);var a=e.getContext("webgl")||e.getContext("experimental-webgl");t.call(this,a),this._canvas=e,a.clearColor(1,1,1,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.enable(a.DEPTH_TEST),a.enable(a.BLEND),a.disable(a.CULL_FACE),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA),this._pixelRatio=2,t.prototype.set3DView.call(this,Math.PI/4,n/r,.1,1e3),this.resize(n,r)}return r(e,t),Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return this._pixelRatio},set:function(t){this._pixelRatio=t,this.resize(this._width,this._height)},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,n){this._width=e,this._height=n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px",this._canvas.width=e*this._pixelRatio,this._canvas.height=n*this._pixelRatio,this._GL.viewport(0,0,this._canvas.width,this._canvas.height),t.prototype.set3DView.call(this,this._viewInfo.fovY,this._width/this._height,this._viewInfo.near,this._viewInfo.far)},e.prototype.set3DView=function(e,n,r){void 0===n&&(n=.1),void 0===r&&(r=1e3),t.prototype.set3DView.call(this,e,this._width/this._height,n,r)},e.prototype.setMVPMatrix=function(t){throw new u.RuntimeError("not implemented")},e.prototype.clear=function(t){t&&this._GL.clearColor(t[0],t[1],t[2],null!=t[3]?t[3]:1),this._GL.clear(this._GL.COLOR_BUFFER_BIT|this._GL.DEPTH_BUFFER_BIT)},e}(m);n.WebGLCanvasPlatform3D=g;var y=function(t){function e(e,n,r){void 0===n&&(n=600),void 0===r&&(r=400);var a=e.getContext("webgl")||e.getContext("experimental-webgl");t.call(this,a),this._canvas=e,a.clearColor(1,1,1,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.enable(a.DEPTH_TEST),a.enable(a.BLEND),a.disable(a.CULL_FACE),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA),this._pixelRatio=2,this.resize(n,r),this.setWebVRView([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return r(e,t),Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return this._pixelRatio},set:function(t){this._pixelRatio=t,this.resize(this._width,this._height)},enumerable:!0,configurable:!0}),e.prototype.resize=function(t,e){this._width=t,this._height=e,this._canvas.width=t*this._pixelRatio,this._canvas.height=e*this._pixelRatio},e.prototype.set3DView=function(e,n,r){void 0===n&&(n=.1),void 0===r&&(r=1e3),t.prototype.set3DView.call(this,e,this._width/this._height,n,r)},e.prototype.setWebVRView=function(e,n){t.prototype.setWebVRView.call(this,e,n)},e.prototype.clear=function(t){t&&this._GL.clearColor(t[0],t[1],t[2],null!=t[3]?t[3]:1),this._GL.clear(this._GL.COLOR_BUFFER_BIT|this._GL.DEPTH_BUFFER_BIT)},e}(m);n.WebGLCanvasPlatformWebVR=y},{"./generator":34,"./webglutils":36,"stardust-core":27}],36:[function(t,e,n){"use strict";var r=t("stardust-core");n.compileProgram=function(t,e,n){var a=t.createShader(t.VERTEX_SHADER);t.shaderSource(a,e),t.compileShader(a);var o=t.getShaderParameter(a,t.COMPILE_STATUS);if(!o)throw console.log("Vertex shader code is:",e),new r.RuntimeError("could not compile vertex shader: "+t.getShaderInfoLog(a));var i=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(i,n),t.compileShader(i),!(o=t.getShaderParameter(i,t.COMPILE_STATUS)))throw console.log("Fragment shader code is:",n),new r.RuntimeError("could not compile fragment shader: "+t.getShaderInfoLog(i));var s=t.createProgram();if(t.attachShader(s,a),t.attachShader(s,i),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw new r.RuntimeError("could not link shader: "+t.getProgramInfoLog(s));return s}},{"stardust-core":27}]},{},[1])(1)}])}));